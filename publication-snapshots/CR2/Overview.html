<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ReSpec 25.3.1"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><style>/* --- EXAMPLES --- */
span.example-title {
    text-transform: none;
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example span.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
.issue-label {
    text-transform: initial;
}

.warning > p:first-child { margin-top: 0 }
.warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
span.warning { padding: .1em .5em .15em; }

.issue.closed span.issue-number {
    text-decoration: line-through;
}

.warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 1.3em;
    float: left;
    padding-right: .3em;
    margin-top: -0.3em;
}

li.task-list-item {
    list-style: none;
}

input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
}

.issue a.respec-gh-label {
  padding: 5px;
  margin: 0 2px 0 2px;
  font-size: 10px;
  text-transform: none;
  text-decoration: none;
  font-weight: bold;
  border-radius: 4px;
  position: relative;
  bottom: 2px;
  border: none;
  display: inline-block;
}

.issue a.respec-label-dark {
  color: #fff;
  background-color: #000;
}

.issue a.respec-label-light {
  color: #000;
  background-color: #fff;
}
</style><style>/* --- WEB IDL --- */

pre.idl {
  padding: 1em;
  position: relative;
}

@media print {
  pre.idl {
    white-space: pre-wrap;
  }
}

.idlHeader {
  display: block;
  width: 150px;
  background: #90b8de;
  color: #fff;
  font-family: sans-serif;
  font-weight: bold;
  margin: -1em 0 1em -1em;
  height: 28px;
  line-height: 28px;
}

.idlHeader a.self-link {
   color: #fff;
   margin-left: .3cm;
   text-decoration: none;
   border-bottom: none;
}

.idlID {
  font-weight: bold;
  color: #005a9c;
}

.idlType {
  color: #005a9c;
}

.idlName {
  color: #ff4500;
}

.idlName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
}

a.idlEnumItem {
  color: #000;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
}

.idlSuperclass {
  font-style: italic;
  color: #005a9c;
}


/*.idlParam*/

.idlParamName,
.idlDefaultValue {
  font-style: italic;
}

.extAttr {
  color: #666;
}


/*.idlSectionComment*/

.idlSectionComment {
  color: gray;
}

.idlIncludes a {
  font-weight: bold;
}

.respec-button-copy-paste:focus {
  text-decoration: none;
  border-color: #51a7e8;
  outline: none;
  box-shadow: 0 0 5px rgba(81, 167, 232, 0.5);
}

.respec-button-copy-paste:focus:hover,
.respec-button-copy-paste.selected:focus {
  border-color: #51a7e8;
}

.respec-button-copy-paste:hover,
.respec-button-copy-paste:active,
.respec-button-copy-paste.zeroclipboard-is-hover,
.respec-button-copy-paste.zeroclipboard-is-active {
  text-decoration: none;
  background-color: #ddd;
  background-image: linear-gradient(#eee, #ddd);
  border-color: #ccc;
}

.respec-button-copy-paste:active,
.respec-button-copy-paste.selected,
.respec-button-copy-paste.zeroclipboard-is-active {
  background-color: #dcdcdc;
  background-image: none;
  border-color: #b5b5b5;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15)
}

.respec-button-copy-paste.selected:hover {
  background-color: #cfcfcf;
}

.respec-button-copy-paste:disabled,
.respec-button-copy-paste:disabled:hover,
.respec-button-copy-paste.disabled,
.respec-button-copy-paste.disabled:hover {
  color: rgba(102, 102, 102, 0.5);
  cursor: default;
  background-color: rgba(229, 229, 229, 0.5);
  background-image: none;
  border-color: rgba(197, 197, 197, 0.5);
  box-shadow: none;
}

@media print {
  .respec-button-copy-paste {
    visibility: hidden;
  }
}
</style><style>/* dfn popup panel that list all local references to a dfn */
dfn {
  cursor: pointer;
}

.dfn-panel {
  position: absolute;
  left: var(--left); /* set via JS */
  top: var(--top); /* set via JS */
  z-index: 35;
  height: auto;
  width: max-content;
  max-width: 300px;
  max-height: 500px;
  overflow: auto;
  padding: 0.5em 0.75em;
  font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
  background: #dddddd;
  color: black;
  border: outset 0.2em;
}

.dfn-panel * {
  margin: 0;
}

.dfn-panel > b {
  display: block;
}

.dfn-panel ul a[href] {
  color: black;
}

.dfn-panel a:not(:hover) {
  text-decoration: none !important;
  border-bottom: none !important;
}

.dfn-panel a[href]:hover {
  border-bottom-width: 1px;
}

.dfn-panel > b + b {
  margin-top: 0.25em;
}

.dfn-panel ul {
  padding: 0;
}

.dfn-panel li {
  list-style: inside;
}

.dfn-panel.docked {
  display: inline-block;
  position: fixed;
  left: 0.5em;
  top: unset;
  bottom: 2em;
  margin: 0 auto;
  /* 0.75em from padding (x2), 0.5em from left position, 0.2em border (x2) */
  max-width: calc(100vw - 0.75em * 2 - 0.5em - 0.2em * 2);
  max-height: 30vh;
}
</style>
<title>JSON-LD 1.1 Processing Algorithms and API</title>

<style id="respec-mainstyle">/*****************************************************************
 * ReSpec specific CSS
 *****************************************************************/
@keyframes pop {
  0% {
    transform: scale(1, 1);
  }
  25% {
    transform: scale(1.25, 1.25);
    opacity: 0.75;
  }
  100% {
    transform: scale(1, 1);
  }
}

/* Override code highlighter background */
.hljs {
  background: transparent !important;
}

/* --- INLINES --- */
h1 abbr,
h2 abbr,
h3 abbr,
h4 abbr,
h5 abbr,
h6 abbr,
a abbr {
  border: none;
}

dfn {
  font-weight: bold;
}

a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
}

a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
}

a.bibref {
  text-decoration: none;
}

.respec-offending-element:target {
  animation: pop 0.25s ease-in-out 0s 1;
}

.respec-offending-element,
a[href].respec-offending-element {
  text-decoration: red wavy underline;
}
@supports not (text-decoration: red wavy underline) {
  .respec-offending-element:not(pre) {
    display: inline-block;
  }
  .respec-offending-element {
    /* Red squiggly line */
    background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=)
      bottom repeat-x;
  }
}

#references :target {
  background: #eaf3ff;
  animation: pop 0.4s ease-in-out 0s 1;
}

cite .bibref {
  font-style: normal;
}

code {
  color: #c83500;
}

th code {
  color: inherit;
}

a[href].orcid {
    padding-left: 4px;
    padding-right: 4px;
}

a[href].orcid > svg {
    margin-bottom: -2px;
}

/* --- TOC --- */

.toc a,
.tof a {
  text-decoration: none;
}

a .secno,
a .figno {
  color: #000;
}

ul.tof,
ol.tof {
  list-style: none outside none;
}

.caption {
  margin-top: 0.5em;
  font-style: italic;
}

/* --- TABLE --- */

table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
}

.simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th a {
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
}

.simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
  background: #f0f6ff;
}

/* --- DL --- */

.section dd > p:first-child {
  margin-top: 0;
}

.section dd > p:last-child {
  margin-bottom: 0;
}

.section dd {
  margin-bottom: 1em;
}

.section dl.attrs dd,
.section dl.eldef dd {
  margin-bottom: 0;
}

#issue-summary > ul,
.respec-dfn-list {
  column-count: 2;
}

#issue-summary li,
.respec-dfn-list li {
  list-style: none;
}

details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
}

details.respec-tests-details > * {
  padding-right: 2em;
}

details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
}

details.respec-tests-details[open] > summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
}

details.respec-tests-details > ul {
  width: 100%;
  margin-top: -0.3em;
}

details.respec-tests-details > li {
  padding-left: 1em;
}

a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
}

h2,
h3,
h4,
h5,
h6 {
  position: relative;
}

aside.example .marker > a.self-link {
  color: inherit;
}

h2 > a.self-link,
h3 > a.self-link,
h4 > a.self-link,
h5 > a.self-link,
h6 > a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: 0.5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity 0.2s;
  width: 2em;
}

h2 > a.self-link::before,
h3 > a.self-link::before,
h4 > a.self-link::before,
h5 > a.self-link::before,
h6 > a.self-link::before {
  content: "§";
  display: block;
}

@media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2 > a.self-link,
  h3 > a.self-link,
  h4 > a.self-link,
  h5 > a.self-link,
  h6 > a.self-link {
    left: auto;
    top: auto;
  }
}

@media print {
  .removeOnSave {
    display: none;
  }
}
</style>



<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Add example button selection logic
    for (const button of document.querySelectorAll(".ds-selector-tabs .selectors button")) {
      button.onclick = () => {
        const ex = button.closest(".ds-selector-tabs");
        ex.querySelector("button.selected").classList.remove("selected");
        ex.querySelector(".selected").classList.remove("selected");
        button.classList.add('selected');
        ex.querySelector("." + button.dataset.selects).classList.add("selected");
      }
    }

    // Toggle show/hide changes
    for (const elem of document.querySelectorAll(".show-changes")) {
      elem.onclick = () => {
        if (elem.classList.contains("selected")) {
          // Remove highlight class from elements having "changed" class
          elem.classList.remove("selected");
          for (const changed of document.querySelectorAll(".changed")) {
            changed.classList.remove("highlight");
          }
        } else {
          // Add highlight class to elements having "changed" class
          elem.classList.add("selected");
          for (const changed of document.querySelectorAll(".changed")) {
            changed.classList.add("highlight");
          }
        }
      }
    }
  });
</script>
<style>
  .hl-bold {font-weight: bold; color: #0a3;}
  .comment {color: #999;}
  .error a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }
  .example > pre.context:before {
    content: "Context";
    float: right;
    font: x-large Arial, sans-serif;
    color: gray;
    border: solid thin black;
    padding: 0.2em;
  }
  .example > pre.frame:before {
    content: "Frame";
    float: right;
    font: x-large Arial, sans-serif;
    color: gray;
    border: solid thin black;
    padding: 0.2em;
  }
  .example > pre.input:before {
    content: "Input";
    float: right;
    font: x-large Arial, sans-serif;
    color: gray;
    border: solid thin black;
    padding: 0.2em;
  }
  .example > pre.result:before {
    content: "Result";
    float: right;
    font: x-large Arial, sans-serif;
    color: gray;
    border: solid thin black;
    padding: 0.2em;
  }
  .example > pre.turtle:before {
    content: "Turtle";
    float: right;
    font: x-large Arial, sans-serif;
    color: gray;
    border: solid thin black;
    padding: 0.2em;
  }
  .algorithm ol {
    counter-reset: numsection;
    list-style-type: none;
  }
  .algorithm ol>li {
    margin: 0.5em 0;
  }
  .algorithm ol>li:before {
    font-weight: bold;
    counter-increment: numsection;
    content: counters(numsection, ".") ") ";
  }
  .highlight.changed, .show-changes {
    background-color: lime;
  }
  .show-changes.selected:before {
    content: "de-highlight";
  }
  .show-changes:before {
    content: "highlight";
  }
  /* example tab selection */
  .ds-selector-tabs {
    padding-bottom: 2em;
  }
  .ds-selector-tabs .selectors {
    padding: 0;
    border-bottom: 1px solid #ccc;
    height: 28px;
  }
  .ds-selector-tabs .selectors button {
    display: inline-block;
    min-width: 54px;
    text-align: center;
    font-size: 11px;
    font-weight: bold;
    height: 27px;
    padding: 0 8px;
    line-height: 27px;
    transition: all,0.218s;
    border-top-right-radius: 2px;
    border-top-left-radius: 2px;
    color: #666;
    border: 1px solid transparent;
  }
  .ds-selector-tabs .selectors button:first-child {
    margin-left: 2px;
  }
  .ds-selector-tabs .selectors button.selected {
    color: #202020 !important;
    border: 1px solid #ccc;
    border-bottom: 1px solid #fff !important;
  }
  .ds-selector-tabs .selectors button:hover {
    background-color: transparent;
    color: #202020;
    cursor: pointer;
  }
  .ds-selector-tabs pre:not(.preserve), .ds-selector-tabs table:not(.preserve) {
    display: none;
  }
  .ds-selector-tabs pre.selected, .ds-selector-tabs table.selected {
    display: block;
  }
  a.playground {
    display: inline-block;
    width: 150px;
    border: 1px solid transparent;
    border-top-right-radius: 2px;
    border-top-left-radius: 2px;
    background-color: rgb(192, 192, 192);
    text-decoration: none;
    font-size: 13px;
    margin-bottom: 10px;
  }
  a[href].playground {
    padding: 4px 0 3px 8px;
    border-bottom: none;
    text-decoration: none;
    color: #666;
  }
</style>
<meta name="description" content="This specification defines a set of algorithms for programmatic transformations
    of JSON-LD documents. Restructuring data according to the defined transformations
    often dramatically simplifies its usage. Furthermore, this document proposes
    an Application Programming Interface (API) for developers implementing the
    specified algorithms."><link rel="canonical" href="https://www.w3.org/TR/json-ld11-api/"><script type="application/ld+json">{
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/json-ld11-api/",
  "type": [
    "TechArticle",
    "w3p:CR"
  ],
  "name": "JSON-LD 1.1 Processing Algorithms and API",
  "inLanguage": "en",
  "license": "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document",
  "datePublished": "2020-03-05",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/json-ld-api/issues/",
  "alternativeHeadline": "",
  "isBasedOn": "https://www.w3.org/TR/2019/CR-json-ld11-api-20191212/",
  "description": "This specification defines a set of algorithms for programmatic transformations\n    of JSON-LD documents. Restructuring data according to the defined transformations\n    often dramatically simplifies its usage. Furthermore, this document proposes\n    an Application Programming Interface (API) for developers implementing the\n    specified algorithms.",
  "editor": [
    {
      "type": "Person",
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/"
    },
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Pierre-Antoine Champin",
      "url": "http://champin.net/",
      "worksFor": {
        "name": "LIRIS - Université de Lyon",
        "url": "https://liris.cnrs.fr/"
      }
    }
  ],
  "contributor": [
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/"
    },
    {
      "type": "Person",
      "name": "Markus Lanthaler",
      "url": "http://www.markus-lanthaler.com/",
      "worksFor": {
        "name": "Graz University of Technology",
        "url": "http://www.tugraz.at/"
      }
    },
    {
      "type": "Person",
      "name": "Manu Sporny",
      "url": "http://manu.sporny.org/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Niklas Lindström",
      "url": "http://neverspace.net/"
    }
  ],
  "citation": [
    {
      "id": "https://tc39.github.io/ecma262/",
      "type": "TechArticle",
      "name": "ECMAScript Language Specification",
      "url": "https://tc39.github.io/ecma262/",
      "publisher": {
        "name": "Ecma International"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc8259",
      "type": "TechArticle",
      "name": "The JavaScript Object Notation (JSON) Data Interchange Format",
      "url": "https://tools.ietf.org/html/rfc8259",
      "creator": [
        {
          "name": "T. Bray, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://infra.spec.whatwg.org/",
      "type": "TechArticle",
      "name": "Infra Standard",
      "url": "https://infra.spec.whatwg.org/",
      "creator": [
        {
          "name": "Anne van Kesteren"
        },
        {
          "name": "Domenic Denicola"
        }
      ],
      "publisher": {
        "name": "WHATWG"
      }
    },
    {
      "id": "https://heycam.github.io/webidl/",
      "type": "TechArticle",
      "name": "Web IDL",
      "url": "https://heycam.github.io/webidl/",
      "creator": [
        {
          "name": "Boris Zbarsky"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc3987",
      "type": "TechArticle",
      "name": "Internationalized Resource Identifiers (IRIs)",
      "url": "https://tools.ietf.org/html/rfc3987",
      "creator": [
        {
          "name": "M. Duerst"
        },
        {
          "name": "M. Suignard"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/rdf11-concepts/",
      "type": "TechArticle",
      "name": "RDF 1.1 Concepts and Abstract Syntax",
      "url": "https://www.w3.org/TR/rdf11-concepts/",
      "creator": [
        {
          "name": "Richard Cyganiak"
        },
        {
          "name": "David Wood"
        },
        {
          "name": "Markus Lanthaler"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/rdf-schema/",
      "type": "TechArticle",
      "name": "RDF Schema 1.1",
      "url": "https://www.w3.org/TR/rdf-schema/",
      "creator": [
        {
          "name": "Dan Brickley"
        },
        {
          "name": "Ramanathan Guha"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/DesignIssues/LinkedData.html",
      "type": "TechArticle",
      "name": "Linked Data Design Issues",
      "url": "https://www.w3.org/DesignIssues/LinkedData.html",
      "creator": [
        {
          "name": "Tim Berners-Lee"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/bcp47",
      "type": "TechArticle",
      "name": "Tags for Identifying Languages",
      "url": "https://tools.ietf.org/html/bcp47",
      "creator": [
        {
          "name": "A. Phillips"
        },
        {
          "name": "M. Davis"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/2014/REC-json-ld-20140116/",
      "type": "TechArticle",
      "name": "JSON-LD 1.0",
      "url": "https://www.w3.org/TR/2014/REC-json-ld-20140116/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Marcus Langhaler"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc5234",
      "type": "TechArticle",
      "name": "Augmented BNF for Syntax Specifications: ABNF",
      "url": "https://tools.ietf.org/html/rfc5234",
      "creator": [
        {
          "name": "D. Crocker, Ed."
        },
        {
          "name": "P. Overell"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc3986",
      "type": "TechArticle",
      "name": "Uniform Resource Identifier (URI): Generic Syntax",
      "url": "https://tools.ietf.org/html/rfc3986",
      "creator": [
        {
          "name": "T. Berners-Lee"
        },
        {
          "name": "R. Fielding"
        },
        {
          "name": "L. Masinter"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/turtle/",
      "type": "TechArticle",
      "name": "RDF 1.1 Turtle",
      "url": "https://www.w3.org/TR/turtle/",
      "creator": [
        {
          "name": "Eric Prud'hommeaux"
        },
        {
          "name": "Gavin Carothers"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/xmlschema11-2/",
      "type": "TechArticle",
      "name": "W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes",
      "url": "https://www.w3.org/TR/xmlschema11-2/",
      "creator": [
        {
          "name": "David Peterson"
        },
        {
          "name": "Sandy Gao"
        },
        {
          "name": "Ashok Malhotra"
        },
        {
          "name": "Michael Sperberg-McQueen"
        },
        {
          "name": "Henry Thompson"
        },
        {
          "name": "Paul V. Biron"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/rdf11-mt/",
      "type": "TechArticle",
      "name": "RDF 1.1 Semantics",
      "url": "https://www.w3.org/TR/rdf11-mt/",
      "creator": [
        {
          "name": "Patrick Hayes"
        },
        {
          "name": "Peter Patel-Schneider"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "http://standards.ieee.org/findstds/standard/754-2008.html",
      "type": "TechArticle",
      "name": "IEEE 754-2008 Standard for Floating-Point Arithmetic",
      "url": "http://standards.ieee.org/findstds/standard/754-2008.html",
      "publisher": {
        "name": "Institute of Electrical and Electronics Engineers"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1",
      "url": "https://www.w3.org/TR/json-ld11/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Pierre-Antoine Champin"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/2001/tag/doc/promises-guide",
      "type": "TechArticle",
      "name": "Writing Promise-Using Specifications",
      "url": "https://www.w3.org/2001/tag/doc/promises-guide",
      "creator": [
        {
          "name": "Domenic Denicola"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc6839",
      "type": "TechArticle",
      "name": "Additional Media Type Structured Syntax Suffixes",
      "url": "https://tools.ietf.org/html/rfc6839",
      "creator": [
        {
          "name": "T. Hansen"
        },
        {
          "name": "A. Melnikov"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc8288",
      "type": "TechArticle",
      "name": "Web Linking",
      "url": "https://tools.ietf.org/html/rfc8288",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ]
    },
    {
      "id": "https://html.spec.whatwg.org/multipage/",
      "type": "TechArticle",
      "name": "HTML Standard",
      "url": "https://html.spec.whatwg.org/multipage/",
      "creator": [
        {
          "name": "Anne van Kesteren"
        },
        {
          "name": "Domenic Denicola"
        },
        {
          "name": "Ian Hickson"
        },
        {
          "name": "Philip Jägenstedt"
        },
        {
          "name": "Simon Pieters"
        }
      ],
      "publisher": {
        "name": "WHATWG"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://tools.ietf.org/html/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://tools.ietf.org/html/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11-framing/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1 Framing",
      "url": "https://www.w3.org/TR/json-ld11-framing/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/rfc2045",
      "type": "TechArticle",
      "name": "Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies",
      "url": "https://tools.ietf.org/html/rfc2045",
      "creator": [
        {
          "name": "N. Freed"
        },
        {
          "name": "N. Borenstein"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://dom.spec.whatwg.org/",
      "type": "TechArticle",
      "name": "DOM Standard",
      "url": "https://dom.spec.whatwg.org/",
      "creator": [
        {
          "name": "Anne van Kesteren"
        }
      ],
      "publisher": {
        "name": "WHATWG"
      }
    },
    {
      "id": "https://www.w3.org/TR/2014/REC-json-ld-api-20140116/",
      "type": "TechArticle",
      "name": "JSON-LD 1.0 Processing Algorithms And API",
      "url": "https://www.w3.org/TR/2014/REC-json-ld-api-20140116/",
      "creator": [
        {
          "name": "Marcus Langhaler"
        },
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Manu Sporny"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17",
      "type": "TechArticle",
      "name": "JSON Canonicalization Scheme (JCS)",
      "url": "https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17",
      "creator": [
        {
          "name": "A. Rundgren"
        },
        {
          "name": "B. Jordan"
        },
        {
          "name": "S. Erdtman"
        }
      ],
      "publisher": {
        "name": "Network Working Group"
      }
    },
    {
      "id": "https://www.w3.org/TR/cooluris/",
      "type": "TechArticle",
      "name": "Cool URIs for the Semantic Web",
      "url": "https://www.w3.org/TR/cooluris/",
      "creator": [
        {
          "name": "Leo Sauermann"
        },
        {
          "name": "Richard Cyganiak"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    }
  ]
}</script><style>/*
Atom One Light by Daniel Gamage
Original One Light Syntax theme from https://github.com/atom/one-light-syntax
base:    #fafafa
mono-1:  #383a42
mono-2:  #686b77
mono-3:  #a0a1a7
hue-1:   #0184bb
hue-2:   #4078f2
hue-3:   #a626a4
hue-4:   #50a14f
hue-5:   #e45649
hue-5-2: #c91243
hue-6:   #986801
hue-6-2: #c18401
*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #383a42;
  background: #fafafa;
}

.hljs-comment,
.hljs-quote {
  color: #717277;
  font-style: italic;
}

.hljs-doctag,
.hljs-keyword,
.hljs-formula {
  color: #a626a4;
}

.hljs-section,
.hljs-name,
.hljs-selector-tag,
.hljs-deletion,
.hljs-subst {
  color: #e45649;
}

.hljs-literal {
  color: #0184bb;
}

.hljs-string,
.hljs-regexp,
.hljs-addition,
.hljs-attribute,
.hljs-meta-string {
  color: #42803C;
}

.hljs-built_in,
.hljs-class .hljs-title {
  color: #c18401;
}

.hljs-attr,
.hljs-variable,
.hljs-template-variable,
.hljs-type,
.hljs-selector-class,
.hljs-selector-attr,
.hljs-selector-pseudo,
.hljs-number {
  color: #986801;
}

.hljs-symbol,
.hljs-bullet,
.hljs-link,
.hljs-meta,
.hljs-selector-id,
.hljs-title {
  color: #4078f2;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

.hljs-link {
  text-decoration: underline;
}
</style><style>var {
  position: relative;
  cursor: pointer;
}

var[data-type]::before,
var[data-type]::after {
  position: absolute;
  left: 50%;
  top: -6px;
  opacity: 0;
  transition: opacity 0.4s;
  pointer-events: none;
}

/* the triangle or arrow or caret or whatever */
var[data-type]::before {
  content: "";
  transform: translateX(-50%);
  border-width: 4px 6px 0 6px;
  border-style: solid;
  border-color: transparent;
  border-top-color: #000;
}

/* actual text */
var[data-type]::after {
  content: attr(data-type);
  transform: translateX(-50%) translateY(-100%);
  background: #000;
  text-align: center;
  /* additional styling */
  font-family: "Dank Mono", "Fira Code", monospace;
  font-style: normal;
  padding: 6px;
  border-radius: 3px;
  color: #daca88;
  text-indent: 0;
  font-weight: normal;
}

var[data-type]:hover::after,
var[data-type]:hover::before {
  opacity: 1;
}
</style><script id="initialUserConfig" type="application/json">{
  "localBiblio": {
    "JSON-LD10": {
      "title": "JSON-LD 1.0",
      "href": "https://www.w3.org/TR/2014/REC-json-ld-20140116/",
      "publisher": "W3C",
      "date": "16 January 2014",
      "status": "W3C Recommendation",
      "authors": [
        "Manu Sporny",
        "Gregg Kellogg",
        "Marcus Langhaler"
      ],
      "id": "json-ld10"
    },
    "JSON-LD10-API": {
      "title": "JSON-LD 1.0 Processing Algorithms And API",
      "href": "https://www.w3.org/TR/2014/REC-json-ld-api-20140116/",
      "publisher": "W3C",
      "date": "16 January 2014",
      "status": "W3C Recommendation",
      "authors": [
        "Marcus Langhaler",
        "Gregg Kellogg",
        "Manu Sporny"
      ],
      "id": "json-ld10-api"
    },
    "JSON-LD10-FRAMING": {
      "title": "JSON-LD Framing 1.0",
      "href": "https://json-ld.org/spec/ED/json-ld-framing/20120830/",
      "publisher": "W3C",
      "date": "30 August 2012",
      "status": "Unofficial Draft",
      "authors": [
        "Manu Sporny",
        "Gregg Kellogg",
        "David Longley",
        "Marcus Langhaler"
      ]
    },
    "IEEE-754-2008": {
      "title": "IEEE 754-2008 Standard for Floating-Point Arithmetic",
      "href": "http://standards.ieee.org/findstds/standard/754-2008.html",
      "publisher": "Institute of Electrical and Electronics Engineers",
      "date": "2008",
      "id": "ieee-754-2008"
    },
    "JSON.API": {
      "title": "JSON API",
      "href": "https://jsonapi.org/format/",
      "authors": [
        "Steve Klabnik",
        "Yehuda Katz",
        "Dan Gebhardt",
        "Tyler Kellen",
        "Ethan Resnick"
      ],
      "status": "unofficial",
      "date": "29 May 2015"
    },
    "JCS": {
      "title": "JSON Canonicalization Scheme (JCS)",
      "href": "https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17",
      "authors": [
        "A. Rundgren",
        "B. Jordan",
        "S. Erdtman"
      ],
      "publisher": "Network Working Group",
      "status": "Internet-Draft",
      "date": "20 January 2020",
      "id": "jcs"
    },
    "RFC7231": {
      "title": "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content",
      "href": "https://tools.ietf.org/html/rfc7231",
      "authors": [
        "R. Fielding, Ed.",
        "J. Reschke, Ed"
      ],
      "pubisher": "IETF",
      "status": "Proposed Standard",
      "date": "June 2014"
    },
    "RFC8288": {
      "title": "Web Linking",
      "href": "https://tools.ietf.org/html/rfc8288",
      "authors": [
        "M. Nottingham"
      ],
      "pubisher": "IETF",
      "status": "Proposed Standard",
      "date": "October 2017",
      "id": "rfc8288"
    }
  },
  "specStatus": "CR",
  "copyrightStart": "2010",
  "shortName": "json-ld11-api",
  "prevVersion": "https://www.w3.org/TR/2019/CR-json-ld11-api-20191212/",
  "previousPublishDate": "2019-12-12",
  "previousMaturity": "CR",
  "prevRecURI": "https://www.w3.org/TR/2014/REC-json-ld-api-20140116/",
  "edDraftURI": "https://w3c.github.io/json-ld-api/",
  "testSuiteURI": "https://w3c.github.io/json-ld-api/tests/",
  "implementationReportURI": "https://w3c.github.io/json-ld-api/reports/",
  "crEnd": "2020-03-30",
  "github": {
    "repoURL": "https://github.com/w3c/json-ld-api",
    "branch": "master"
  },
  "includePermalinks": true,
  "doJsonLd": true,
  "highlightVars": true,
  "pluralize": true,
  "xref": [
    "json-ld11",
    "json-ld11-api",
    "json-ld11-framing"
  ],
  "editors": [
    {
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/",
      "w3cid": "44770",
      "note": "v1.0 and v1.1"
    },
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "w3cid": "48025",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "note": "v1.1"
    },
    {
      "name": "Pierre-Antoine Champin",
      "url": "http://champin.net/",
      "company": "LIRIS - Université de Lyon",
      "companyURL": "https://liris.cnrs.fr/",
      "w3cid": "42931",
      "note": "v1.1"
    }
  ],
  "formerEditors": [
    {
      "name": "Markus Lanthaler",
      "url": "http://www.markus-lanthaler.com/",
      "company": "Graz University of Technology",
      "companyURL": "http://www.tugraz.at/",
      "note": "v1.0"
    },
    {
      "name": "Manu Sporny",
      "url": "http://manu.sporny.org/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "note": "v1.0"
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "note": "v1.0 and v1.1"
    },
    {
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/",
      "w3cid": "44770",
      "note": "v1.0 and v1.1"
    },
    {
      "name": "Markus Lanthaler",
      "url": "http://www.markus-lanthaler.com/",
      "company": "Graz University of Technology",
      "companyURL": "http://www.tugraz.at/",
      "note": "v1.0"
    },
    {
      "name": "Manu Sporny",
      "url": "http://manu.sporny.org/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "note": "v1.0"
    },
    {
      "name": "Niklas Lindström",
      "url": "http://neverspace.net/",
      "note": "v1.0"
    }
  ],
  "wg": "JSON-LD Working Group",
  "wgURI": "https://www.w3.org/2018/json-ld-wg/",
  "wgPublicList": "public-json-ld-wg",
  "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/107714/status",
  "processVersion": 2018,
  "maxTocLevel": 2,
  "publishDate": "2020-03-05",
  "publishISODate": "2020-03-05T00:00:00.000Z",
  "generatedSubtitle": "Candidate Recommendation 05 March 2020"
}</script><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-CR"></head>

<body class="h-entry" data-cite="WebIDL json-ld11 json-ld11-api json-ld11-framing"><div class="head">
      <a class="logo" href="https://www.w3.org/"><img alt="W3C" width="72" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a> <h1 id="title" class="title">JSON-LD 1.1 Processing Algorithms and API</h1>
      
      <h2>
        W3C Candidate Recommendation
        <time class="dt-published" datetime="2020-03-05">05 March 2020</time>
      </h2>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2020/CR-json-ld11-api-20200305/">https://www.w3.org/TR/2020/CR-json-ld11-api-20200305/</a>
              </dd><dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/json-ld11-api/">https://www.w3.org/TR/json-ld11-api/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/json-ld-api/">https://w3c.github.io/json-ld-api/</a></dd>
        <dt>Test suite:</dt><dd><a href="https://w3c.github.io/json-ld-api/tests/">https://w3c.github.io/json-ld-api/tests/</a></dd>
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/json-ld-api/reports/">https://w3c.github.io/json-ld-api/reports/</a>
              </dd>
        
        <dt>Previous version:</dt><dd><a href="https://www.w3.org/TR/2019/CR-json-ld11-api-20191212/">https://www.w3.org/TR/2019/CR-json-ld11-api-20191212/</a></dd>
        <dt>Latest Recommendation:</dt><dd><a href="https://www.w3.org/TR/2014/REC-json-ld-api-20140116/">https://www.w3.org/TR/2014/REC-json-ld-api-20140116/</a></dd>
        <dt>Editors:</dt>
        <dd class="p-author h-card vcard" data-editor-id="44770"><a class="u-url url p-name fn" href="https://greggkellogg.net/">Gregg Kellogg</a> (v1.0 and v1.1)</dd><dd class="p-author h-card vcard" data-editor-id="48025"><a class="u-url url p-name fn" href="https://digitalbazaar.com/author/dlongley/">Dave Longley</a>
            (<a class="p-org org h-org h-card" href="https://digitalbazaar.com/">Digital Bazaar</a>)
           (v1.1)</dd><dd class="p-author h-card vcard" data-editor-id="42931"><a class="u-url url p-name fn" href="http://champin.net/">Pierre-Antoine Champin</a>
            (<a class="p-org org h-org h-card" href="https://liris.cnrs.fr/">LIRIS - Université de Lyon</a>)
           (v1.1)</dd>
        <dt>
                Former editors:
              </dt><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://www.markus-lanthaler.com/">Markus Lanthaler</a>
            (<a class="p-org org h-org h-card" href="http://www.tugraz.at/">Graz University of Technology</a>)
           (v1.0)</dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://manu.sporny.org/">Manu Sporny</a>
            (<a class="p-org org h-org h-card" href="https://digitalbazaar.com/">Digital Bazaar</a>)
           (v1.0)</dd>
        <dt>
                Authors:
              </dt><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://digitalbazaar.com/">Dave Longley</a>
            (<a class="p-org org h-org h-card" href="https://digitalbazaar.com/">Digital Bazaar</a>)
           (v1.0 and v1.1)</dd><dd class="p-author h-card vcard" data-editor-id="44770"><a class="u-url url p-name fn" href="https://greggkellogg.net/">Gregg Kellogg</a> (v1.0 and v1.1)</dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://www.markus-lanthaler.com/">Markus Lanthaler</a>
            (<a class="p-org org h-org h-card" href="http://www.tugraz.at/">Graz University of Technology</a>)
           (v1.0)</dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://manu.sporny.org/">Manu Sporny</a>
            (<a class="p-org org h-org h-card" href="https://digitalbazaar.com/">Digital Bazaar</a>)
           (v1.0)</dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://neverspace.net/">Niklas Lindström</a> (v1.0)</dd>
        <dt>Participate:</dt><dd>
      <a href="https://github.com/w3c/json-ld-api/">GitHub w3c/json-ld-api</a>
    </dd><dd>
      <a href="https://github.com/w3c/json-ld-api/issues/">File a bug</a>
    </dd><dd>
      <a href="https://github.com/w3c/json-ld-api/commits/master">Commit history</a>
    </dd><dd>
      <a href="https://github.com/w3c/json-ld-api/pulls/">Pull requests</a>
    </dd>
      </dl>
      
      
      
      <p class="copyright">
      <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
      ©
      2010-2020
      
      <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
      <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
      <a href="https://ev.buaa.edu.cn/">Beihang</a>). 
      W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
      <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">permissive document license</a> rules
      apply.
    </p>
      <hr title="Separator for header">
    </div>
<section id="abstract" class="introductory"><h2>Abstract</h2>
  <p>This specification defines a set of algorithms for programmatic transformations
    of JSON-LD documents. Restructuring data according to the defined transformations
    often dramatically simplifies its usage. Furthermore, this document proposes
    an Application Programming Interface (API) for developers implementing the
    specified algorithms.</p>

  <p>This specification describes a superset of the features defined in
    <cite><a href="https://www.w3.org/TR/2014/REC-json-ld-api-20140116/">JSON-LD 1.0 Processing Algorithms And API</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld10-api" title="JSON-LD 1.0 Processing Algorithms And API">JSON-LD10-API</a></cite>]
    and, except where noted,
    the algorithms described in this specification are fully compatible
    with documents created using <cite><a href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">JSON-LD 1.0</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld10" title="JSON-LD 1.0">JSON-LD10</a></cite>].</p>
</section>

<section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em></p>
  <p>This document has been developed by the
    <a href="https://www.w3.org/2018/json-ld-wg/">JSON-LD Working Group</a> and was derived from the <a href="https://www.w3.org/community/json-ld/">JSON-LD Community Group's</a> <a href="https://www.w3.org/2018/jsonld-cg-reports/json-ld-api/">Final Report</a>.</p>

  <p>There is a
    <a href="https://json-ld.org/playground/">live JSON-LD playground</a> that is capable
    of demonstrating the features described in this document.</p>

  <p>
      This document was published by the <a href="https://www.w3.org/2018/json-ld-wg/">JSON-LD Working Group</a> as a
      Candidate Recommendation.
      This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
    </p><p>
      <a href="https://github.com/w3c/json-ld-api/issues/">GitHub Issues</a> are preferred for
            discussion of this specification.
          
      Alternatively, you can send comments to our mailing list.
            Please send them to
            <a href="mailto:public-json-ld-wg@w3.org">public-json-ld-wg@w3.org</a>
            (<a href="https://lists.w3.org/Archives/Public/public-json-ld-wg/">archives</a>).
          
    </p><p>
                              
                  <abbr title="World Wide Web Consortium">W3C</abbr> publishes a Candidate Recommendation to indicate that the document is believed to be
                  stable and to encourage implementation by the developer community. This Candidate
                  Recommendation is expected to advance to Proposed Recommendation no earlier than
                  30 March 2020.
                
                              
                              
                            </p><p>
      Please see the Working Group's
      <a href="https://w3c.github.io/json-ld-api/reports/">implementation report</a>.
    </p><p>
      Publication as a Candidate Recommendation does not imply endorsement by the
      <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may be updated, replaced or
      obsoleted by other documents at any time. It is inappropriate to cite this
      document as other than work in progress.
    </p><p>
      
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
       
      
                  <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                  <a rel="disclosure" href="https://www.w3.org/2004/01/pp-impl/107714/status">public list of any patent disclosures</a>
            made in connection with the deliverables of
            the group; that page also includes
            instructions for disclosing a patent. An individual who has actual
            knowledge of a patent which the individual believes contains
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
            must disclose the information in accordance with
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
      
    </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2019/Process-20190301/">1 March 2019 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p><section>
    <h3 id="set-of-documents">Set of Documents<a class="self-link" aria-label="§" href="#set-of-documents"></a></h3>
    <p>This document is one of three JSON-LD 1.1 Recommendations produced by the
      <a href="https://www.w3.org/2018/json-ld-wg/">JSON-LD Working Group</a>:</p>

    <ul>
      <li><cite><a href="https://www.w3.org/TR/json-ld11/">JSON-LD 1.1</a></cite></li>
      <li><a href="">JSON-LD 1.1 Processing Algorithms and API</a></li>
      <li><cite><a href="https://www.w3.org/TR/json-ld11-framing/">JSON-LD 1.1 Framing</a></cite></li>
    </ul>
  </section>
</section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#how-to-read-this-document"><bdi class="secno">1.1 </bdi>How to Read this Document</a></li><li class="tocline"><a class="tocxref" href="#contributing"><bdi class="secno">1.2 </bdi>Contributing</a></li><li class="tocline"><a class="tocxref" href="#typographical-conventions"><bdi class="secno">1.3 </bdi>Typographical conventions</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.4 </bdi>Terminology</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#example-conventions"><bdi class="secno">1.5 </bdi>Example Conventions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#features"><bdi class="secno">2. </bdi>Features</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#expansion"><bdi class="secno">2.1 </bdi>Expansion</a></li><li class="tocline"><a class="tocxref" href="#compaction"><bdi class="secno">2.2 </bdi>Compaction</a></li><li class="tocline"><a class="tocxref" href="#flattening"><bdi class="secno">2.3 </bdi>Flattening</a></li><li class="tocline"><a class="tocxref" href="#rdf-serialization-deserialization"><bdi class="secno">2.4 </bdi>RDF Serialization/Deserialization</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">3. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#context-processing-algorithms"><bdi class="secno">4. </bdi>Context Processing Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#context-processing-algorithm"><bdi class="secno">4.1 </bdi>Context Processing Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#create-term-definition"><bdi class="secno">4.2 </bdi>Create Term Definition</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#inverse-context-creation"><bdi class="secno">4.3 </bdi>Inverse Context Creation</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#term-selection"><bdi class="secno">4.4 </bdi>Term Selection</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#expansion-algorithms"><bdi class="secno">5. </bdi>Expansion Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#expansion-algorithm"><bdi class="secno">5.1 </bdi>Expansion Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#iri-expansion"><bdi class="secno">5.2 </bdi><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#value-expansion"><bdi class="secno">5.3 </bdi>Value Expansion</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#compaction-algorithms"><bdi class="secno">6. </bdi>Compaction Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#compaction-algorithm"><bdi class="secno">6.1 </bdi>Compaction Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#iri-compaction"><bdi class="secno">6.2 </bdi><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#value-compaction"><bdi class="secno">6.3 </bdi>Value Compaction</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#flattening-algorithms"><bdi class="secno">7. </bdi>Flattening Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#flattening-algorithm"><bdi class="secno">7.1 </bdi>Flattening Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#node-map-generation"><bdi class="secno">7.2 </bdi>Node Map Generation</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#merge-node-maps"><bdi class="secno">7.3 </bdi>Merge Node Maps</a></li><li class="tocline"><a class="tocxref" href="#generate-blank-node-identifier"><bdi class="secno">7.4 </bdi>Generate Blank Node Identifier</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#rdf-serialization-deserialization-algorithms"><bdi class="secno">8. </bdi>RDF Serialization/Deserialization Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#deserialize-json-ld-to-rdf-algorithm"><bdi class="secno">8.1 </bdi>Deserialize JSON-LD to RDF Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#object-to-rdf-conversion"><bdi class="secno">8.2 </bdi>Object to RDF Conversion</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#list-to-rdf-conversion"><bdi class="secno">8.3 </bdi>List to RDF Conversion</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#serialize-rdf-as-json-ld-algorithm"><bdi class="secno">8.4 </bdi>Serialize RDF as JSON-LD Algorithm</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#rdf-to-object-conversion"><bdi class="secno">8.5 </bdi>RDF to Object Conversion</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#data-round-tripping"><bdi class="secno">8.6 </bdi>Data Round Tripping</a></li></ol></li><li class="tocline"><a class="tocxref" href="#the-application-programming-interface"><bdi class="secno">9. </bdi>The Application Programming Interface</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#the-jsonldprocessor-interface"><bdi class="secno">9.1 </bdi>The <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="JsonLdProcessor" data-dfn-for=""><code>JsonLdProcessor</code></span> Interface</a></li><li class="tocline"><a class="tocxref" href="#rdf-dataset-interfaces"><bdi class="secno">9.2 </bdi>RDF Dataset Interfaces</a></li><li class="tocline"><a class="tocxref" href="#the-jsonldoptions-type"><bdi class="secno">9.3 </bdi>The JsonLdOptions Type</a></li><li class="tocline"><a class="tocxref" href="#remote-document-and-context-retrieval"><bdi class="secno">9.4 </bdi>Remote Document and Context Retrieval</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#html-content-algorithms"><bdi class="secno">9.5 </bdi>HTML Content Algorithms</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#error-handling"><bdi class="secno">9.6 </bdi>Error Handling</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security"><bdi class="secno">10. </bdi>Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#privacy"><bdi class="secno">11. </bdi>Privacy Considerations</a></li><li class="tocline"><a class="tocxref" href="#internationalization"><bdi class="secno">12. </bdi>Internationalization Considerations</a></li><li class="tocline"><a class="tocxref" href="#idl-index"><bdi class="secno">A. </bdi>IDL Index</a></li><li class="tocline"><a class="tocxref" href="#open-issues"><bdi class="secno">B. </bdi>Open Issues</a></li><li class="tocline"><a class="tocxref" href="#changes-since-1-0-recommendation-of-16-january-2014"><bdi class="secno">C. </bdi>Changes since 1.0 Recommendation of 16 January 2014</a></li><li class="tocline"><a class="tocxref" href="#changes-from-cg"><bdi class="secno">D. </bdi>Changes since JSON-LD Community Group Final Report</a></li><li class="tocline"><a class="tocxref" href="#changes-from-cr"><bdi class="secno">E. </bdi>Changes since Candidate Release of 12 December 2019</a></li><li class="tocline"><a class="tocxref" href="#ack"><bdi class="secno">F. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">G. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">G.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">G.2 </bdi>Informative references</a></li></ol></li></ol></nav>


<section class="informative" id="introduction">
  <h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction<a class="self-link" aria-label="§" href="#introduction"></a></h2><p><em>This section is non-normative.</em></p>

  <p>This document is a detailed specification of the JSON-LD processing algorithms.
    The document is primarily intended for the following audiences:</p>

  <ul>
    <li>Software developers who want to implement the algorithms to transform
      JSON-LD documents.</li>
    <li>Web authors and developers who want a very detailed view of how
      a <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processor</a> operates.</li>
    <li>Developers who want an overview of the proposed JSON-LD API.</li>
  </ul>

  <p>To understand the basics in this specification you must first be familiar with
    <cite><a data-no-xref="" href="https://tools.ietf.org/html/rfc8259">JSON</a></cite>, which is detailed in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]. You must also understand the
    JSON-LD syntax defined in the <cite><a data-no-xref="" href="https://www.w3.org/TR/json-ld11/">JSON-LD 1.1 Syntax specification</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>], which is the base syntax used by all
    of the algorithms in this document. To understand the API and how it is
    intended to operate in a programming environment, it is useful to have working
    knowledge of the JavaScript programming language [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecmascript" title="ECMAScript Language Specification">ECMASCRIPT</a></cite>] and
    WebIDL [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL">WEBIDL</a></cite>]. To understand how JSON-LD maps to RDF, it is helpful to be
    familiar with the basic RDF concepts [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</p>

  <section class="informative" id="how-to-read-this-document">
    <h3 id="x1-1-how-to-read-this-document"><bdi class="secno">1.1 </bdi>How to Read this Document<a class="self-link" aria-label="§" href="#how-to-read-this-document"></a></h3><p><em>This section is non-normative.</em></p>

    <p>This document is a detailed specification for a serialization of Linked
      Data in JSON. The document is primarily intended for the following audiences:</p>

    <ul>
      <li>Software developers who want to implement processors and APIs for
        JSON-LD</li>
    </ul>

    <p>A companion document, the JSON-LD 1.1 specification
      [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>], specifies the grammar of JSON-LD documents.</p>

    <p>To understand the basics in this specification you must first be familiar with
      <cite><a data-no-xref="" href="https://tools.ietf.org/html/rfc8259">JSON</a></cite>, which is detailed in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>].</p>

    <p>This document can highlight changes since the <cite><a href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">JSON-LD 1.0</a></cite> version.
      Select to <button class="show-changes"></button> changes.</p>
  </section>

  <section class="informative" id="contributing">
    <h3 id="x1-2-contributing"><bdi class="secno">1.2 </bdi>Contributing<a class="self-link" aria-label="§" href="#contributing"></a></h3><p><em>This section is non-normative.</em></p>

    <p>There are a number of ways that one may participate in the development of
      this specification:</p>

    <ul>
      <li>Technical discussion typically occurs on the public mailing list:
        <a href="https://lists.w3.org/Archives/Public/public-json-ld-wg/">public-json-ld-wg@w3.org</a></li>

      <li>The working group uses <a href="http://irc.w3.org/?channels=json-ld">#json-ld</a>
        IRC channel is available for real-time discussion on <a href="http://irc.w3.org">irc.w3.org</a>.</li>

      <li>The <a href="https://webchat.freenode.net/?channels=json-ld">#json-ld</a>
        IRC channel is also available for real-time discussion on irc.freenode.net.</li>
    </ul>

  </section>

  <section class="informative" id="typographical-conventions">
    <h3 id="x1-3-typographical-conventions"><bdi class="secno">1.3 </bdi>Typographical conventions<a class="self-link" aria-label="§" href="#typographical-conventions"></a></h3><p><em>This section is non-normative.</em></p>
    <div><p>The following typographic conventions are used in this specification:</p>

<dl class="typography">
  <dt><code>markup</code></dt><dd>
    Markup (elements, attributes, properties),
    machine processable values (string, characters, media types),
    property name,
    or a file name is in red-orange monospace font.</dd>
  <dt><var>variable</var></dt><dd>
    A variable in pseudo-code or in an algorithm description is in italics.</dd>
  <dt><dfn data-no-xref="" data-dfn-type="dfn" id="dfn-definition">definition</dfn></dt><dd>
    A definition of a term, to be used elsewhere in this or other specifications,
    is in bold and italics.</dd>
  <dt><a data-lt="definition" href="#dfn-definition" class="internalDFN" data-link-type="dfn">definition reference</a></dt><dd>
    A reference to a definition <em>in this document</em>
    is underlined and is also an active link to the definition itself. </dd>
  <dt><a data-lt="definition" href="#dfn-definition" class="internalDFN" data-link-type="dfn"><code>markup definition reference</code></a></dt><dd>
    A references to a definition <em>in this document</em>,
    when the reference itself is also a markup, is underlined,
    red-orange monospace font, and is also an active link to the definition itself.</dd>
  <dt><a class="externalDFN">external definition reference</a></dt><dd>
    A reference to a definition <em>in another document</em>
    is underlined, in italics, and is also an active link to the definition itself.</dd>
  <dt><a class="externalDFN"><code> markup external definition reference</code></a></dt><dd>
    A reference to a definition <em>in another document</em>,
    when the reference itself is also a markup,
    is underlined, in italics red-orange monospace font,
    and is also an active link to the definition itself.</dd>
  <dt><a href="">hyperlink</a></dt><dd>
    A hyperlink is underlined and in blue.</dd>
  <dt>[<a href="">reference</a>]</dt><dd>
    A document reference (normative or informative) is enclosed in square brackets
    and links to the references section.</dd>
  <dt class="changed">Changes from Recommendation</dt><dd>
    Sections or phrases changed from the previous Recommendation
    may be <span class="changed">highlighted</span> using a control
    in <a href="#how-to-read-this-document" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">1.1 </bdi>How to Read this Document</a>.</dd>
</dl>

<div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">Notes are in light green boxes with a green left border and with a "Note" header in green.
  Notes are always informative.</p></div>

<div class="example" id="example-1">
          <div class="marker">
      <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
    </div> <pre class="nohighlight">Examples are in light khaki boxes, with khaki left border,
and with a numbered "Example" header in khaki.
Examples are always informative. The content of the example is in monospace font and may be syntax colored.

Examples may have tabbed navigation buttons
to show the results of transforming an example into other representations.</pre>
        </div>
</div>
  </section>

  <section class="normative" id="terminology">
    <h3 id="x1-4-terminology"><bdi class="secno">1.4 </bdi>Terminology<a class="self-link" aria-label="§" href="#terminology"></a></h3>

    <p>This document uses the following terms as defined in external specifications
      and defines terms specific to JSON-LD.</p>

    <div data-oninclude="restrictReferences"><section><h4 id="terms-imported-from-other-specifications">Terms imported from Other Specifications<a class="self-link" aria-label="§" href="#terms-imported-from-other-specifications"></a></h4>
<p>Terms imported from <cite><a href="https://tc39.github.io/ecma262/">ECMAScript Language Specification</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecmascript" title="ECMAScript Language Specification">ECMASCRIPT</a></cite>], <cite><a href="https://tools.ietf.org/html/rfc8259">The JavaScript Object Notation (JSON) Data Interchange Format</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>], <cite><a href="https://infra.spec.whatwg.org/">Infra Standard</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">INFRA</a></cite>], and <cite><a href="https://heycam.github.io/webidl/">Web IDL</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL">WEBIDL</a></cite>]</p>
<dl class="termlist" data-sort="" id="terms"><dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="arrays" id="dfn-array" data-no-export=""><a href="https://infra.spec.whatwg.org/#list">array</a></dfn></dt><dd>
    In the JSON serialization,
    an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> structure is represented as square brackets surrounding zero or more values.
    Values are separated by commas.
    In the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>,
    a <a data-ld="array" data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a> (also called an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>) is an <em>ordered</em> collection of zero or more values.
    While JSON-LD uses the same array representation as JSON,
    the collection is <em>unordered</em> by default.
    While order is preserved in regular JSON arrays,
    it is not in regular JSON-LD arrays unless specifically defined
    (see the <a href="https://www.w3.org/TR/json-ld11/#sets-and-lists">Sets and Lists</a> section of JSON-LD 1.1.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="booleans" id="dfn-boolean" data-no-export=""><a href="https://infra.spec.whatwg.org/#boolean">boolean</a></dfn></dt><dd>
    The values <code>true</code> and <code>false</code> that are used
    to express one of two possible states.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="json objects" id="dfn-json-object" data-no-export=""><a href="https://tools.ietf.org/html/rfc8259#section-4">JSON object</a></dfn></dt><dd>
    In the JSON serialization,
    an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> structure
    is represented as a pair of curly brackets surrounding zero or more name/value pairs (or members).
    A name is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>.
    A single colon comes after each name,
    separating the name from the value.
    A single comma separates a value from a following name.
    In JSON-LD the names in an object must be unique.
    <p>In the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON object</a> is described as a
      <dfn class="preserve" data-dfn-type="dfn" data-plurals="maps" id="dfn-map" data-no-export=""><a href="https://infra.spec.whatwg.org/#ordered-map">map</a></dfn> (see [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">INFRA</a></cite>]),
      composed of <dfn data-lt="map entry|entry|entries" data-ld-nodefault="" class="preserve" data-dfn-type="dfn" data-plurals="map entries" id="dfn-map-entry" data-no-export=""><a href="https://infra.spec.whatwg.org/#map-entry">entries</a></dfn> with key/value pairs.</p>
    <p>In the <a href="#the-application-programming-interface">Application Programming Interface</a>,
      a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> is described using a [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL">WEBIDL</a></cite>] <a href="https://heycam.github.io/webidl/#idl-record">record</a>.</p></dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-null" data-no-export=""><a href="https://infra.spec.whatwg.org/#nulls">null</a></dfn></dt><dd>
    The use of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a> value within JSON-LD
    is used to ignore or reset values.
    A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> in the <code>@context</code> where the value,
    or the <code>@id</code> of the value, is <code>null</code>,
    explicitly decouples a term's association with an <abbr title="Internationalized Resource Identifier">IRI</abbr>.
    A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> in the body of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a>
    whose value is <code>null</code>
    has the same meaning as if the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> was not defined.
    If <code>@value</code>, <code>@list</code>, or <code>@set</code> is set to <code>null</code> in expanded form,
    then the entire <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON object</a> is ignored.</dd>
  <dt><dfn data-lt="number|JSON number" class="preserve" data-dfn-type="dfn" data-plurals="numbers|json numbers" id="dfn-number" data-no-export=""><a href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a></dfn></dt><dd>
    In the JSON serialization, a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>
    is similar to that used in most programming languages,
    except that the octal and hexadecimal formats are not used and that leading zeros are not allowed.
    In the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>,
    a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> is equivalent to either a <dfn class="preserve" data-dfn-type="dfn" id="dfn-long" data-no-export=""><a href="https://heycam.github.io/webidl/#idl-long">long</a></dfn>
    or <dfn class="preserve" data-dfn-type="dfn" id="dfn-double" data-no-export=""><a href="https://heycam.github.io/webidl/#idl-double">double</a></dfn>,
    depending on if the number has a non-zero fractional part (see [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL">WEBIDL</a></cite>]).</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-scalar" data-no-export=""><a href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a></dfn></dt><dd>
    A scalar is either a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>, <code>true</code>, or <code>false</code>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="strings" id="dfn-string" data-no-export=""><a href="https://infra.spec.whatwg.org/#javascript-string">string</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>
    is a sequence of zero or more Unicode (UTF-8) characters,
    wrapped in double quotes, using backslash escapes (if necessary).
    A character is represented as a single character string.</dd></dl>

<p>Terms imported from <cite><a href="https://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3987" title="Internationalized Resource Identifiers (IRIs)">RFC3987</a></cite>]</p>
<dl class="termlist" data-sort=""><dt><dfn data-lt="Internationalized Resource Identifier|IRI" class="preserve" data-dfn-type="dfn" data-plurals="iris" id="dfn-internationalized-resource-identifier" data-no-export=""><a href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a></dfn></dt><dd>
    The absolute form of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> containing a <em>scheme</em> along with a <em>path</em>
    and optional <em>query</em> and <em>fragment</em> segments.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-iri-reference" data-no-export=""><a href="https://tools.ietf.org/html/rfc3987#section-1.3"><abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a></dfn></dt><dd>
    Denotes the common usage of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">Internationalized Resource Identifier</a>.
    An <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-1.3"><abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> may be absolute or
    <a data-lt="relative IRI reference" data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative</a>.
    However, the "<abbr title="Internationalized Resource Identifier">IRI</abbr>" that results from such a reference only includes absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>;
    any <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> references</a> are resolved to their absolute form.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="relative iri references" id="dfn-relative-iri-reference" data-no-export=""><a href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a></dfn></dt><dd>
    A relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-1.3"><abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> that is relative to some other <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
    typically the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of the document.
    Note that <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a>,
    values of <code>@type</code>,
    and values of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> defined to be <em>vocabulary relative</em>
    are resolved relative to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>,
    not the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</dd></dl>

<p>Terms imported from <cite><a href="https://www.w3.org/TR/rdf11-concepts/">RDF 1.1 Concepts and Abstract Syntax</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>], <cite><a href="https://www.w3.org/TR/rdf-schema/">RDF Schema 1.1</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-schema" title="RDF Schema 1.1">RDF-SCHEMA</a></cite>], and <cite><a href="https://www.w3.org/DesignIssues/LinkedData.html">Linked Data Design Issues</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-linked-data" title="Linked Data Design Issues">LINKED-DATA</a></cite>]</p>
<dl class="termlist" data-sort=""><dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-base-iri" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> established in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>,
    or is based on the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a> location.
    The <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> is used to turn <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> references</a> into <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="blank nodes" id="dfn-blank-node" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> that is neither an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
    nor a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>.
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> does not contain
    a de-referenceable identifier because it is either ephemeral in nature
    or does not contain information that needs to be linked to from outside of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a>.
    In JSON-LD,
    a blank node is assigned an identifier starting with the prefix <code>_:</code>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="blank node identifiers" id="dfn-blank-node-identifier" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
    is a string that can be used as an identifier for a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> within the scope of a JSON-LD document.
    Blank node identifiers begin with <code>_:</code>.</dd>
  <dt><dfn data-lt="RDF dataset|dataset" class="preserve" data-dfn-type="dfn" id="dfn-rdf-dataset" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">dataset</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">dataset</a>
    representing a collection of <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graphs</a>
    including exactly one <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> and zero or more <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graphs</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-datatype-iri" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> identifying a datatype that determines how the lexical form maps to a
    <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal-value">literal value</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-default-graph" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">dataset</a> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> having no <a data-lt="graph name" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">name</a>, which may be empty.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="graph names" id="dfn-graph-name" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> identifying a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-language-tagged-string" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>
    consists of a string and a non-empty language tag
    as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>].
    The <dfn id="dfn-language-tag" data-dfn-type="dfn" data-plurals="language tags" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a></dfn> must be well-formed
    according to <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9 Classes of Conformance</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>].
    <span class="changed note">Processors may normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lowercase.</span>
  </dd>
  <dt><dfn data-no-xref="" class="preserve" data-dfn-type="dfn" id="dfn-linked-data" data-no-export=""><cite><a href="https://www.w3.org/DesignIssues/LinkedData.html">Linked Data</a></cite></dfn></dt><dd>
    A set of documents, each containing a representation of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">dataset</a>.</dd>
  <dt><dfn data-lt="collection|RDF collection|list" class="preserve" data-dfn-type="dfn" data-plurals="lists" id="dfn-collection" data-no-export=""><a href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a> is an ordered sequence of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank nodes</a>, and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literals</a>.</dd>
  <dt><dfn data-lt="RDF literal|literal" class="preserve" data-dfn-type="dfn" data-plurals="literals|rdf literals" id="dfn-rdf-literal" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a></dfn></dt><dd>
    An <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> expressed as a value such as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> or <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>.
    Implicitly or explicitly includes a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> and, if the datatype is <code>rdf:langString</code>, an optional <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="named graphs" id="dfn-named-graph" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a>
    is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a> that is identified by an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="nodes" id="dfn-node" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>, either the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> of at least one <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.
    Note that a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> can play both roles (<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a>) in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a>, even in the same <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-object" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a></dfn></dt><dd>
    An <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a>
    with at least one incoming edge.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="properties" id="dfn-property" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a></dfn></dt><dd>
    The name of a directed-arc in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a>.
    Every <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a> is directional
    and is labeled with an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.
    Whenever possible, a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a> should be labeled with an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
    <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
      and may be removed in a future version of JSON-LD.</div></div>
    Also, see <dfn class="preserve" data-dfn-type="dfn" data-plurals="predicates" id="dfn-predicate" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a></dfn> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
  <dt><dfn data-lt="linked data graph|graph|RDF graph" class="preserve" data-dfn-type="dfn" data-plurals="rdf graphs|graphs" id="dfn-linked-data-graph" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a></dfn></dt><dd>
    A labeled directed <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a>,
    i.e., a set of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a> connected by directed-arcs.
    Also called <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a>.
  </dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-resource" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-resource">resource</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-resource">resource</a> denoted by an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a> representing something in the world (the "universe of discourse").</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="subjects" id="dfn-subject" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">linked data graph</a>
    with at least one outgoing edge,
    related to an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> node through a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a>.</dd><dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="triples" id="dfn-triple" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a></dfn></dt><dd>
    A component of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> including a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>, and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a>, which represents
    a node-arc-node segment of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>.</dd>
  </dl>
</section>

<section><h4 id="json-ld-specific-term-definitions">JSON-LD Specific Term Definitions<a class="self-link" aria-label="§" href="#json-ld-specific-term-definitions"></a></h4>
<dl class="termlist" data-sort=""><dt><dfn id="dfn-active-context" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> that is used to resolve <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a>
    while the processing algorithm is running.</dd>
  <dt><dfn data-lt="base direction|default base direction" data-lt-nodefault="" id="dfn-base-direction" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> is the direction used when a string does not have a direction associated with it directly.
    It can be set in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> using the <code>@direction</code> key
    whose value must be one of the strings <code>"ltr"</code>, <code>"rtl"</code>, or <code>null</code>.
    See the <a href="https://www.w3.org/TR/json-ld11/#context-definitions">Context Definitions</a> section of JSON-LD 1.1 for a normative description.
    </dd>
  
  <dt><dfn id="dfn-compact-iri" data-dfn-type="dfn" data-plurals="compact iris" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a></dfn></dt><dd>
    A compact <abbr title="Internationalized Resource Identifier">IRI</abbr> has the form of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a>:<em>suffix</em>
    and is used as a way of expressing an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> without needing to define separate <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> definitions
    for each <abbr title="Internationalized Resource Identifier">IRI</abbr> contained within a common vocabulary identified by <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a>.</dd>
  <dt><dfn id="dfn-context" data-dfn-type="dfn" data-plurals="contexts" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a></dfn></dt><dd>
    A set of rules for interpreting a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a>
    as described in the <a href="https://www.w3.org/TR/json-ld11/#the-context">The Context</a> section of JSON-LD 1.1,
    and normatively specified in the <a href="https://www.w3.org/TR/json-ld11/#context-definitions">Context Definitions</a> section of JSON-LD 1.1.
  </dd>
  <dt><dfn id="dfn-default-language" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> is the language used when a string does not have a language associated with it directly.
    It can be set in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> using the <code>@language</code> key
    whose value must be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing a [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] language code or <code>null</code>.
    See the <a href="https://www.w3.org/TR/json-ld11/#context-definitions">Context Definitions</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-default-object" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-default-object">default object</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-object">default object</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that has a <code>@default</code> key.</dd>
  <dt><dfn id="dfn-expanded-term-definition" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a></dfn></dt><dd>
    An expanded term definition is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
    where the value is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
    containing one or more <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> keys to define the associated <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
    if this is a reverse property,
    the type associated with string values, and a container mapping.
    See the <a href="https://www.w3.org/TR/json-ld11/#expanded-term-definition">Expanded Term Definition</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn data-lt="frame|JSON-LD frame" id="dfn-frame" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11-framing/#dfn-frame">frame</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a>,
    which describes the form for transforming another <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a>
    using matching and embedding rules.
    A frame document allows additional keywords and certain <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>
    to describe the matching and transforming process.</dd>
  
  <dt class="changed"><dfn id="dfn-graph-object" data-dfn-type="dfn" data-plurals="graph objects" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a></dfn></dt><dd class="changed">
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a> represents a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a>
    as the value of a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> within a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.
    When expanded, a graph object must have an <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
    and may also have <code>@id</code>, and <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
    A <dfn class="preserve" data-dfn-type="dfn" id="dfn-simple-graph-object" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-simple-graph-object">simple graph object</a></dfn>
    is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a> which does not have an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.
    Note that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a> may have a <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
    but are not considered <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph objects</a> if they include any other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
    A top-level object consisting of <code>@graph</code> is also not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>.
    Note that a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> may also represent a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a> it it includes other properties.
    See the <a href="https://www.w3.org/TR/json-ld11/#graph-objects">Graph Objects</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt class="changed"><dfn id="dfn-id-map" data-dfn-type="dfn" data-plurals="id maps" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a></dfn></dt><dd class="changed">
    An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> value of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
    defined with <code>@container</code> set to <code>@id</code>.
    The values of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a> must be <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>,
    and its keys are interpreted as <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> representing
    the <code>@id</code> of the associated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.
    If a value in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a> contains a key expanding to <code>@id</code>,
    its value must be equivalent to the referencing key in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#id-maps">Id Maps</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  
  <dt class="changed"><dfn id="dfn-included-block" data-dfn-type="dfn" data-plurals="included blocks" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-included-block">included block</a></dfn></dt><dd class="changed">
    An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-included-block">included block</a> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> where the key is either <code>@included</code> or an alias of <code>@included</code>
    and the value is one or more <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#included-blocks">Included Blocks</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-index-map" data-dfn-type="dfn" data-plurals="index maps" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-index-map">index map</a></dfn></dt><dd>
    An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-index-map">index map</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> value of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
    defined with <code>@container</code> set to <code>@index</code>,
    whose values must be any of the following types:
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
    <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>,
    <code>true</code>,
    <code>false</code>,
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a>,
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>,
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>,
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>,
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-set-object">set object</a>, or
    an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of zero or more of the above possibilities.
    See the <a href="https://www.w3.org/TR/json-ld11/#index-maps">Index Maps</a> section in JSON-LD 1.1 for a formal description.
  </dd>
  <dt><dfn id="dfn-json-literal" data-dfn-type="dfn" data-plurals="json literals" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a> where the associated <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> is <code>rdf:JSON</code>.
    In the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> representation, the value of <code>@type</code> is <code>@json</code>.
    JSON literals represent values which are valid JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>].
    See the <a href="https://www.w3.org/TR/json-ld11/#the-rdf-json-datatype">The <code>rdf:JSON</code> Datatype</a> section in JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-json-ld-document" data-dfn-type="dfn" data-plurals="json-ld documents" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a> is a serialization of
    an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#json-ld-grammar">JSON-LD Grammar</a> section in JSON-LD 1.1 for a formal description.
  </dd>
  <dt class="changed"><dfn data-lt="internal representation|JSON-LD internal representation" id="dfn-internal-representation" data-dfn-type="dfn">JSON-LD internal representation</dfn></dt><dd class="changed">
    The JSON-LD internal representation
    is the result of transforming a JSON syntactic structure
    into the core data structures suitable for direct processing:
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>, <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">booleans</a>, and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a>.</dd>
  <dt><dfn data-lt="json-ld processor|Processors|JSON-LD Processor" id="dfn-json-ld-processor" data-dfn-type="dfn" data-plurals="json-ld processors">JSON-LD Processor</dfn></dt><dd>
    A <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processor</a> is a system which can perform the algorithms defined in JSON-LD 1.1 Processing Algorithms and API.
    See the <a href="#conformance">Conformance</a> section in JSON-LD 1.1 API for a formal description.
  </dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" data-plurals="json-ld values" id="dfn-json-ld-value" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD value</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD value</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
    a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>,
    <code>true</code> or <code>false</code>,
    a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-typed-value">typed value</a>,
    or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>.
    It represents an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a>.
  </dd>
  <dt><dfn id="dfn-keyword" data-dfn-type="dfn" data-plurals="keywords" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> that is specific to JSON-LD,
    described in the <a href="https://www.w3.org/TR/json-ld11/#syntax-tokens-and-keywords">Syntax Tokens and Keywords</a> section of JSON-LD 1.1,
    and normatively specified in the <a href="https://www.w3.org/TR/json-ld11/#keywords">Keywords</a> section of JSON-LD 1.1,
  </dd>
  <dt><dfn id="dfn-language-map" data-dfn-type="dfn" data-plurals="language maps" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-language-map">language map</a></dfn></dt><dd>
    An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-language-map">language map</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> value of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
    defined with <code>@container</code> set to <code>@language</code>,
    whose keys must be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a> representing [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] language codes
    and the values must be any of the following types:
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a>,
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, or
    an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of zero or more of the above possibilities.
    See the <a href="https://www.w3.org/TR/json-ld11/#language-maps">Language Maps</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-list-object" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that has a <code>@list</code> key.
    It may also have an <code>@index</code> key, but no other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#lists-and-sets">Lists and Sets</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-local-context" data-dfn-type="dfn" data-plurals="local contexts" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> that is specified with a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
    specified via the <code>@context</code> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>.</dd>
  
  <dt><dfn id="dfn-node-object" data-dfn-type="dfn" data-plurals="node objects" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> represents zero or more <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a>
    serialized by the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a>.
    A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>
    if it exists outside of the JSON-LD <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> and:
    <ul>
      <li>it does not contain the <code>@value</code>, <code>@list</code>, or <code>@set</code> keywords, or</li>
      <li>it is not the top-most <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> in the JSON-LD document
        consisting of no other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> than <code>@graph</code> and <code>@context</code>.</li>
    </ul>
    The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> whose keys are not keywords are also called <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#node-objects">Node Objects</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  
  <dt><dfn id="dfn-prefix" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> is the first component of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
    which comes from a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that maps to a string that,
    when prepended to the suffix of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
    results in an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</dd>
  <dt><dfn id="dfn-processing-mode" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a></dfn></dt><dd>
    The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> defines how a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a> is processed.
    By default, all documents are assumed to be conformant with this specification.
    By defining a different version using the <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>,
    publishers can ensure that processors conformant with <cite><a data-no-xref="" href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">JSON-LD 1.0</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld10" title="JSON-LD 1.0">JSON-LD10</a></cite>]
    will not accidentally process JSON-LD 1.1 documents, possibly creating a different output.
    The API provides an option for setting the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> to <code>json-ld-1.0</code>,
    which will prevent JSON-LD 1.1 features from being activated,
    or error if <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is explicitly set to <code>1.1</code>.
    This specification extends <cite><a data-no-xref="" href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">JSON-LD 1.0</a></cite>
    via the <code>json-ld-1.1</code> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-scoped-context" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-scoped-context">scoped context</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-scoped-context">scoped context</a> is part of an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a> using the
    <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>. It has the same form as an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-embedded-context">embedded context</a>.
    When the term is used as a type, it defines a <dfn class="preserve" data-dfn-type="dfn" data-plurals="type-scoped contexts" id="dfn-type-scoped-context" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-type-scoped-context">type-scoped context</a></dfn>,
    when used as a property it defines a <dfn class="preserve" data-dfn-type="dfn" id="dfn-property-scoped-context" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-property-scoped-context">property-scoped context</a></dfn>.
  </dd>
  <dt><dfn id="dfn-set-object" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-set-object">set object</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-set-object">set object</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that has an <code>@set</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.
    It may also have an <code>@index</code> key, but no other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#lists-and-sets">Lists and Sets</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-term" data-dfn-type="dfn" data-plurals="terms" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> is a short word defined in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>
    that may be expanded to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
    See the <a href="https://www.w3.org/TR/json-ld11/#terms">Terms</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn id="dfn-term-definition" data-dfn-type="dfn" data-plurals="term definitions" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a></dfn></dt><dd>
    A term definition is an entry in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>,
    where the key defines a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
    which may be used within a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
    as a key, type, or elsewhere that a string is interpreted as a vocabulary item.
    Its value is either a string (<dfn data-lt="simple term definition|simple term" data-lt-nodefault="" id="dfn-simple-term-definition" data-dfn-type="dfn" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-simple-term-definition">simple term definition</a></dfn>),
    expanding to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
    or a map (<a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a>).
  </dd>
  <dt class="changed"><dfn id="dfn-type-map" data-dfn-type="dfn" data-plurals="type maps" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-type-map">type map</a></dfn></dt><dd class="changed">
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-map">type map</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> value of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
    defined with <code>@container</code> set to <code>@type</code>,
    whose keys are interpreted as <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>
    representing the <code>@type</code> of the associated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>;
    the value must be a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>, or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of node objects.
    If the value contains a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> expanding to <code>@type</code>,
    its values are merged with the map value when expanding.
    See the <a href="https://www.w3.org/TR/json-ld11/#type-maps">Type Maps</a> section of JSON-LD 1.1 for a normative description.
  </dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-typed-value" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-typed-value">typed value</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-typed-value">typed value</a> consists of a value,
    which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
    and a type,
    which is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</dd>
  <dt><dfn id="dfn-value-object" data-dfn-type="dfn" data-plurals="value objects" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a></dfn></dt><dd>
    A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that has an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</dd>
  <dt><dfn class="preserve" data-dfn-type="dfn" id="dfn-vocabulary-mapping" data-no-export=""><a href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a></dfn></dt><dd>
    The vocabulary mapping is set in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> using the <code>@vocab</code> key
    whose value must be an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, or <code>null</code>.
    See the <a href="https://www.w3.org/TR/json-ld11/#value-objects">Value Objects</a> section of JSON-LD 1.1 for a normative description.
  </dd></dl>
</section>
</div>

  <section id="algorithm-terms">
    <h4 id="x1-4-1-algorithm-terms"><bdi class="secno">1.4.1 </bdi>Algorithm Terms<a class="self-link" aria-label="§" href="#algorithm-terms"></a></h4>

    <p>The Following terms are used within specific algorithms.</p>

    <div data-oninclude="restrictReferences"><dl class="termlist" data-sort="" id="terms-0"><dt><dfn id="dfn-active-graph" data-dfn-type="dfn">active graph</dfn></dt><dd>
    The name of the currently active graph that the processor should use when processing.</dd>
  
  <dt><dfn id="dfn-active-property" data-dfn-type="dfn">active property</dfn></dt><dd>
    The currently active <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> that the processor should use when processing.
    The <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> is represented in the original lexical form,
    which is used for finding coercion mappings in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>.</dd>
  
  <dt class="changed"><dfn id="dfn-add-value" data-dfn-type="dfn">add value</dfn></dt>
  <dd class="algorithm changed">
    Used as a macro within various algorithms as a way to add a <var>value</var>
    to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> (<var>object</var>) using a specified <var>key</var>.
    The invocation may include an <var>as array</var> flag defaulting to <code>false</code>.
    <ol>
      <li>If <var>as array</var> is <code>true</code>,
        and <var>value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
        set it to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing <var>value</var>.</li>
      <li>If <var>key</var> is not an entry in <var>object</var>,
        add <var>value</var> as the value of <var>key</var> in <var>object</var>.</li>
      <li>Otherwise
        <ol>
          <li>If the value of <var>key</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>object</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
            set it to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing the original value.</li>
          <li>If <var>value</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, concatenate <var>value</var>
            to that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
          <li>Otherwise, append <var>value</var> to that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
        </ol>
    </li></ol>
  </dd>
  
  
  <dt class="changed"><dfn id="dfn-iri-compacting" data-dfn-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</dfn></dt>
  <dd class="algorithm changed">
    Used as a macro within various algorithms as to reduce the language used to describe
    the process of compacting a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> <var>var</var> representing an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
    using an <var>active context</var> either specified directly, or coming from the scope of
    the algorithm step using this term and <var>inverse context</var> also taken
    from the scope of the algorithm step using this term.
    An optional <var>value</var> is used, if explicitly provided.
    Unless specified,
    the <var>vocab</var> flag defaults to <code>true</code>,
    and the <var>reverse</var> flag defaults to <code>false</code>.
    <ol>
      <li>Return the result of using the <a href="#iri-compaction"><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction algorithm</a>,
        passing <var>active context</var>, <var>inverse context</var>,
        <var>var</var>,
        <var>value</var> (if supplied),
        <var>vocab</var>,
        and <var>result</var>.</li>
    </ol>
  </dd>
  <dt class="changed"><dfn id="dfn-iri-expanding" data-dfn-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</dfn></dt>
  <dd class="algorithm changed">
    Used as a macro within various algorithms as to reduce the language used to describe
    the process of expanding a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> <var>value</var> representing an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
    using an <var>active context</var> either specified directly, or coming from the scope of
    the algorithm step using this term.
    Optional <var>defined</var> and <var>local context</var> arguments are used, if explicitly provided.
    Unless specified,
    the <var>document relative</var> flag defaults to <code>false</code>,
    and the <var>vocab</var> flag defaults to <code>true</code>.
    <ol>
      <li>Return the result of using the <a href="#iri-expansion"><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion algorithm</a>,
        passing <var>active context</var>,
        <var>value</var>,
        <var>local context</var> (if supplied),
        <var>defined</var> (if supplied),
        <var>document relative</var>,
        and <var>vocab</var>.</li>
    </ol>
  </dd>
  
  
  
  
  
  
  
  
  </dl>
</div>
  </section>

  </section>

  <section class="informative" id="example-conventions">
    <h3 id="x1-5-example-conventions"><bdi class="secno">1.5 </bdi>Example Conventions<a class="self-link" aria-label="§" href="#example-conventions"></a></h3><p><em>This section is non-normative.</em></p>
    <p>Note that in the examples used in this document, output
      is of necessity shown in serialized form as JSON. While the algorithms
      describe operations on the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">JSON-LD internal representation</a>, when
      they as displayed as examples, the JSON serialization is used. In particular,
      the internal representation use of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are represented using
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a>.</p>

    <div class="example" id="example-2-sample-json-ld-document">
          <div class="marker">
      <a class="self-link" href="#example-2-sample-json-ld-document">Example<bdi> 2</bdi></a><span class="example-title">: Sample JSON-LD document</span>
    </div> <pre class="nohighlight input">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "knows": "http://xmlns.com/foaf/0.1/knows"
  },
  "@id": "http://me.markus-lanthaler.com/",
  "name": "Markus Lanthaler",
  "knows": [
    {
      "name": "Dave Longley"
    }
  ]
}</pre>
        </div>
    <p>In the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>, the example above would be of a
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing <code>@context</code>, <code>@id</code>, <code>name</code>, and <code>knows</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>,
      with either <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>, or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a> of
      maps or strings values. In the JSON serialization, <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a> are used
      for maps, while arrays and strings are serialized using a
      convention common to many programming languages.</p>
  </section>

</section> 


<section class="informative" id="features">
  <h2 id="x2-features"><bdi class="secno">2. </bdi>Features<a class="self-link" aria-label="§" href="#features"></a></h2><p><em>This section is non-normative.</em></p>

  <p>The JSON-LD 1.1 Syntax specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] defines a syntax to
    express Linked Data in JSON. Because there is more than one way to
    express Linked Data using this syntax, it is often useful to be able to
    transform JSON-LD documents so that they may be more easily consumed by
    specific applications.</p>

  <p class="changed">To allow these algorithms to be adapted for syntaxes
    other than JSON, the algorithms operate on the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">JSON-LD internal representation</a>,
    which uses the generic
    concepts of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>,
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>, <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">booleans</a>, and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a> to describe
    the data represented by a JSON document. Algorithms act on this
    <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> with API entry points responsible for
    transforming between the concrete and internal representations.</p>

  <p>JSON-LD uses <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">contexts</a> to allow Linked Data
    to be expressed in a way that is specifically tailored to a particular
    person or application. By providing a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>,
    JSON data can be expressed in a way that is a natural fit for a particular
    person or application whilst also indicating how the data should be
    understood at a global scale. In order for people or applications to
    share data that was created using a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> that is different
    from their own, a JSON-LD processor must be able to transform a document
    from one <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> to another. Instead of requiring JSON-LD
    processors to write specific code for every imaginable
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> switching scenario, it is much easier to specify a
    single algorithm that can remove any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>. Similarly,
    another algorithm can be specified to subsequently apply any
    <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>. These two algorithms represent the most basic
    transformations of JSON-LD documents. They are referred to as
    <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expansion</a> and <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>, respectively.</p>

  <p class="changed">JSON-LD 1.1 introduces new features that are
    compatible with <cite><a href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">JSON-LD 1.0</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld10" title="JSON-LD 1.0">JSON-LD10</a></cite>],
    but if processed by a JSON-LD 1.0 processor may produce different results.
    Processors default to <code>json-ld-1.1</code>, unless the
    <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-processingmode" class="internalDFN" data-link-type="idl"><code>processingMode</code></a> API option
    is explicitly set to <code>json-ld-1.0</code>.
    Publishers are encouraged to use the <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> within a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>
    set to <code>1.1</code> to ensure that JSON-LD 1.0 processors will not misinterpret JSON-LD 1.1 features.</p>

  <p>There are four major types of transformation that are discussed in this
    document: expansion, compaction, flattening, and RDF serialization/deserialization.</p>

  <section class="informative" id="expansion">
    <h3 id="x2-1-expansion"><bdi class="secno">2.1 </bdi>Expansion<a class="self-link" aria-label="§" href="#expansion"></a></h3><p><em>This section is non-normative.</em></p>

    <p>The algorithm that removes <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is
      called <dfn data-lt="expanded|expanding|expansion" data-dfn-type="dfn" id="dfn-expanded">expansion</dfn>. Before performing any other
      transformations on a JSON-LD document, it is easiest to
      remove any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> from it and to make data structures
      more regular.</p>

    <p>To get an idea of how context and data structuring affects the same data,
      here is an example of JSON-LD that uses only <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a>
      and is fairly compact:</p>

    <aside class="example ds-selector-tabs" id="example-3-json-ld-document-using-only-terms"><div class="marker">
      <a class="self-link" href="#example-3-json-ld-document-using-only-terms">Example<bdi> 3</bdi></a><span class="example-title">: JSON-LD document using only terms</span>
    </div>
      <div class="selectors">
        <button class="selected input" data-selects="compacted">Compacted (Input)</button>
        <button data-selects="expanded">Expanded (Result)</button>
        <button data-selects="statements">Statements</button>
        <button data-selects="turtle">Turtle</button>
        <a class="playground" target="_blank" aria-label="playground link" href="https://json-ld.org/playground/#startTab=tab-expand&amp;json-ld=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22name%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%2C%0A%20%20%20%20%22homepage%22%3A%20%7B%0A%20%20%20%20%20%20%22%40id%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fhomepage%22%2C%0A%20%20%20%20%20%20%22%40type%22%3A%20%22%40id%22%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%22name%22%3A%20%22Markus%20Lanthaler%22%2C%0A%20%20%22homepage%22%3A%20%22http%3A%2F%2Fwww.markus-lanthaler.com%2F%22%0A%7D">Open in playground</a>
      </div>
      <pre class="compacted selected" aria-busy="false"><code class="hljs">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "homepage": {
      "@id": "http://xmlns.com/foaf/0.1/homepage",
      "@type": "@id"
    }
  },
  "@id": "http://me.markus-lanthaler.com/",
  "name": "Markus Lanthaler",
  "homepage": "http://www.markus-lanthaler.com/"
}</code></pre>
      <pre class="expanded result" data-result-for="JSON-LD document using only terms-compacted" aria-busy="false"><code class="hljs">[{
  "@id": "http://me.markus-lanthaler.com/",
  "http://xmlns.com/foaf/0.1/name": [
    {"@value": "Markus Lanthaler"}
  ],
  "http://xmlns.com/foaf/0.1/homepage": [
    {"@id": "http://www.markus-lanthaler.com/"}
  ]
}]</code></pre>
      <table class="statements" data-result-for="JSON-LD document using only terms-expanded">
        <thead><tr><th>Subject</th><th>Property</th><th>Value</th></tr></thead>
        <tbody>
          <tr><td>http://me.markus-lanthaler.com/</td><td>foaf:name</td><td>Markus Lanthaler</td></tr>
          <tr><td>http://me.markus-lanthaler.com/</td><td>http://xmlns.com/foaf/0.1/homepage</td><td>http://www.markus-lanthaler.com/</td></tr>
        </tbody>
      </table>
      <pre class="turtle" data-content-type="text/turtle" data-result-for="JSON-LD document using only terms-expanded" data-to-rdf="" aria-busy="false"><code class="hljs">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .

&lt;http://me.markus-lanthaler.com/&gt; foaf:name "Markus Lanthaler";
  foaf:homepage &lt;http://www.markus-lanthaler.com/&gt; .</code></pre>
    </aside>

    <p>The next input example uses one <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> to express a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a>
    and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> to encapsulate a value, but
    leaves the rest of the information untouched.</p>

    <aside class="example ds-selector-tabs" id="example-4-sample-json-ld-document-using-an-iri-instead-of-a-term-to-express-a-property"><div class="marker">
      <a class="self-link" href="#example-4-sample-json-ld-document-using-an-iri-instead-of-a-term-to-express-a-property">Example<bdi> 4</bdi></a><span class="example-title">: Sample JSON-LD document using an IRI instead of a term to express a property</span>
    </div>
      <div class="selectors">
        <button class="selected input" data-selects="compacted">Compacted (Input)</button>
        <button data-selects="expanded">Expanded (Result)</button>
        <button data-selects="statements">Statements</button>
        <button data-selects="turtle">Turtle</button>
        <a class="playground" target="_blank" aria-label="playground link" href="https://json-ld.org/playground/#startTab=tab-expand&amp;json-ld=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22website%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fhomepage%22%0A%20%20%7D%2C%0A%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%3A%20%22Markus%20Lanthaler%22%2C%0A%20%20%22website%22%3A%20%7B%20%22%40id%22%3A%20%22http%3A%2F%2Fwww.markus-lanthaler.com%2F%22%20%7D%0A%7D">Open in playground</a>
      </div>
      <pre class="compacted input selected nohighlight">{
  "@context": {
    <span class="hl-bold">"website": "http://xmlns.com/foaf/0.1/homepage"</span>
  },
  "@id": "http://me.markus-lanthaler.com/",
  "<span class="hl-bold">http://xmlns.com/foaf/0.1/name</span>": "Markus Lanthaler",
  <span class="hl-bold">"website"</span>: <span class="hl-bold">{ "@id":</span> "http://www.markus-lanthaler.com/" <span class="hl-bold">}</span>
}</pre>
      <pre class="expanded result" data-result-for="Sample JSON-LD document using an IRI instead of a term to express a property-compacted" aria-busy="false"><code class="hljs">[{
  "@id": "http://me.markus-lanthaler.com/",
  "http://xmlns.com/foaf/0.1/name": [
    {"@value": "Markus Lanthaler"}
  ],
  "http://xmlns.com/foaf/0.1/homepage": [
    {"@id": "http://www.markus-lanthaler.com/"}
  ]
}]</code></pre>
      <table class="statements" data-result-for="Sample JSON-LD document using an IRI instead of a term to express a property-expanded">
        <thead><tr><th>Subject</th><th>Property</th><th>Value</th></tr></thead>
        <tbody>
          <tr><td>http://me.markus-lanthaler.com/</td><td>foaf:name</td><td>Markus Lanthaler</td></tr>
          <tr><td>http://me.markus-lanthaler.com/</td><td>http://xmlns.com/foaf/0.1/homepage</td><td>http://www.markus-lanthaler.com/</td></tr>
        </tbody>
      </table>
      <pre class="turtle" data-content-type="text/turtle" data-result-for="Sample JSON-LD document using an IRI instead of a term to express a property-expanded" data-to-rdf="" aria-busy="false"><code class="hljs">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .

&lt;http://me.markus-lanthaler.com/&gt; foaf:name "Markus Lanthaler";
  foaf:homepage &lt;http://www.markus-lanthaler.com/&gt; .</code></pre>
    </aside>

    <p>Note that both inputs are valid JSON-LD and both represent the same
      information. The difference is in their <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> information
      and in the data structures used. A JSON-LD processor can remove
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> and ensure that the data is more regular by employing
      <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expansion</a>.</p>

    <p><a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">Expansion</a> has two important goals: removing any contextual
      information from the document, and ensuring all values are represented
      in a regular form. These goals are accomplished by expanding all <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> keys
      to <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> and by expressing all
      values in <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a> in
      <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a>. <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">Expanded form</a> is the most verbose
      and regular way of expressing of values in JSON-LD; all contextual
      information from the document is instead stored locally with each value.
      Running the <a href="#expansion-algorithm">Expansion algorithm</a>
      (<a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-expand" class="internalDFN" data-link-type="idl"><code>expand()</code></a>)
      operation) against the above examples results in the following output:</p>

    <div class="example" id="example-5-expanded-json-ld-document-using-an-iri">
          <div class="marker">
      <a class="self-link" href="#example-5-expanded-json-ld-document-using-an-iri">Example<bdi> 5</bdi></a><span class="example-title">: Expanded JSON-LD document using an IRI</span>
    </div> <pre class="result nohighlight" data-result-for="Sample JSON-LD document using an IRI instead of a term to express a property-compacted">[
  {
    "@id": "http://me.markus-lanthaler.com/",
    "<span class="hl-bold">http://xmlns.com/foaf/0.1/name</span>": [
      { "@value": "Markus Lanthaler" }
    ],
    "<span class="hl-bold">http://xmlns.com/foaf/0.1/homepage</span>": [
      { "@id": "http://www.markus-lanthaler.com/" }
    ]
  }
]</pre>
        </div>

    <p class="changed">The example above is the JSON-LD serialization of the output of the
      <a href="#expansion-algorithm">expansion algorithm</a>,
      where the algorithm's use of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are replaced with <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a>.</p>

    <p>Note that in the output above all <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> definitions have
      been removed, all <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> and
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a> have been expanded to absolute
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>, and all
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD values</a> are expressed in
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a> in <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a>. While the
      output is more verbose and difficult for a human to read, it establishes a
      baseline that makes JSON-LD processing easier because of its very regular
      structure.</p>
  </section> 

  <section class="informative" id="compaction">
    <h3 id="x2-2-compaction"><bdi class="secno">2.2 </bdi>Compaction<a class="self-link" aria-label="§" href="#compaction"></a></h3><p><em>This section is non-normative.</em></p>

    <p>While <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expansion</a> removes <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> from a given
      input, <dfn data-lt="compact|compacting|compacted|compacts|compaction" data-dfn-type="dfn" id="dfn-compact">compaction</dfn>'s primary function is to
      perform the opposite operation: to express a given input according to
      a particular <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>. <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">Compaction</a> applies a
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> that specifically tailors the way information is
      expressed for a particular person or application. This simplifies applications
      that consume JSON or JSON-LD by expressing the data in application-specific
      terms, and it makes the data easier to read by humans.</p>

    <p><a href="#dfn-compact" class="internalDFN" data-link-type="dfn">Compaction</a> uses a developer-supplied <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> to
      shorten <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> to <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> or
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a> and
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD values</a> expressed in
      <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a> to simple values such as <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>
      or <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a>.</p>

    <p>For example, assume the following expanded JSON-LD input document:</p>

    <div class="example" id="sample-document">
          <div class="marker">
      <a class="self-link" href="#sample-document">Example<bdi> 6</bdi></a><span class="example-title">: Expanded sample document</span>
    </div> <pre class="expanded input nohighlight">[
  {
    "@id": "http://me.markus-lanthaler.com/",
    "http://xmlns.com/foaf/0.1/name": [
      { "@value": "Markus Lanthaler" }
    ],
    "http://xmlns.com/foaf/0.1/homepage": [
      { "@id": "http://www.markus-lanthaler.com/" }
    ]
  }
]</pre>
        </div>

    <p>Additionally, assume the following developer-supplied JSON-LD
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>:</p>

    <div class="example" id="sample-document-context">
          <div class="marker">
      <a class="self-link" href="#sample-document-context">Example<bdi> 7</bdi></a><span class="example-title">: JSON-LD context</span>
    </div> <pre class="context nohighlight" data-context-for="Expanded sample document">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "homepage": {
      "@id": "http://xmlns.com/foaf/0.1/homepage",
      "@type": "@id"
    }
  }
}</pre>
        </div>

    <p>Running the <a href="#compaction-algorithm">Compaction Algorithm</a>
      (<a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-compact" class="internalDFN" data-link-type="idl"><code>compact()</code></a>)
      operation) given the context supplied above against the JSON-LD input
      document provided above would result in the following output:</p>

    <aside class="example ds-selector-tabs" id="example-8-compacted-sample-document"><div class="marker">
      <a class="self-link" href="#example-8-compacted-sample-document">Example<bdi> 8</bdi></a><span class="example-title">: Compacted sample document</span>
    </div>
      <div class="selectors">
        <a class="playground" data-result-for="#sample-document" data-context="#sample-document-context" data-compact="" target="_blank" aria-label="playground link" href="https://json-ld.org/playground/#startTab=tab-compacted&amp;json-ld=%5B%0A%20%20%7B%0A%20%20%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%20%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%3A%20%5B%0A%20%20%20%20%20%20%7B%20%22%40value%22%3A%20%22Markus%20Lanthaler%22%20%7D%0A%20%20%20%20%5D%2C%0A%20%20%20%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fhomepage%22%3A%20%5B%0A%20%20%20%20%20%20%7B%20%22%40id%22%3A%20%22http%3A%2F%2Fwww.markus-lanthaler.com%2F%22%20%7D%0A%20%20%20%20%5D%0A%20%20%7D%0A%5D&amp;context=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22name%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%2C%0A%20%20%20%20%22homepage%22%3A%20%7B%0A%20%20%20%20%20%20%22%40id%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fhomepage%22%2C%0A%20%20%20%20%20%20%22%40type%22%3A%20%22%40id%22%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D">Open in playground</a>
      </div>
      <pre class="result compacted selected nohighlight" data-result-for="Expanded sample document" data-context="JSON-LD context" data-compact="" title="Compacted sample document">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "homepage": {
      "@id": "http://xmlns.com/foaf/0.1/homepage",
      "@type": "@id"
    }
  },
  "@id": "http://me.markus-lanthaler.com/",
  "name": "Markus Lanthaler",
  "homepage": "http://www.markus-lanthaler.com/"
}</pre>
    </aside>

    <p class="changed">The example above is the JSON-LD serialization of the output of the
      <a href="#compaction-algorithm">compaction algorithm</a>,
      where the algorithm's use of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are replaced with <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a>.</p>

    <p>Note that all <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> have been compacted to
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> as specified in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>,
      which has been injected into the output. While compacted output is
      useful to humans, it is also used to generate structures that are easy to
      program against. Compaction enables developers to map any expanded document
      into an application-specific compacted document. While the context provided
      above mapped <code>http://xmlns.com/foaf/0.1/name</code> to <code>name</code>, it
      could also have been mapped to any other term provided by the developer.</p>
  </section> 

  <section class="informative" id="flattening">
    <h3 id="x2-3-flattening"><bdi class="secno">2.3 </bdi>Flattening<a class="self-link" aria-label="§" href="#flattening"></a></h3><p><em>This section is non-normative.</em></p>

    <p>While expansion ensures that a document is in a uniform structure,
      <dfn data-lt="flattened|flattening" data-dfn-type="dfn" id="dfn-flattened">flattening</dfn> goes a step further to ensure that the shape of the data
      is deterministic. In expanded documents, the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a single
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> may be spread across a number of different
      <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>. By flattening a
      document, all <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> are collected in a single
      <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> and all <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank nodes</a>
      are labeled with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>. This may drastically
      simplify the code required to process JSON-LD data in certain applications.</p>

    <p>For example, assume the following JSON-LD input document:</p>

    <div class="example" id="json-ld-document-in-compact-form">
          <div class="marker">
      <a class="self-link" href="#json-ld-document-in-compact-form">Example<bdi> 9</bdi></a><span class="example-title">: JSON-LD document in compact form</span>
    </div> <pre class="compacted input nohighlight">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "knows": "http://xmlns.com/foaf/0.1/knows"
  },
  "@id": "http://me.markus-lanthaler.com/",
  "name": "Markus Lanthaler",
  "knows": [
    {"name": "Dave Longley"}
  ]
}</pre>
        </div>

    <p>Running the <a href="#flattening-algorithm">Flattening Algorithm</a>
      (<a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-flatten" class="internalDFN" data-link-type="idl"><code>flatten()</code></a>)
      operation) with a context set to <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a> to prevent compaction
      returns the following document:</p>

    <aside class="example ds-selector-tabs" id="example-10-flattened-sample-document"><div class="marker">
      <a class="self-link" href="#example-10-flattened-sample-document">Example<bdi> 10</bdi></a><span class="example-title">: Flattened sample document</span>
    </div>
      <div class="selectors">
        <a class="playground" data-result-for="#json-ld-document-in-compact-form" data-flatten="" target="_blank" aria-label="playground link" href="https://json-ld.org/playground/#startTab=tab-flattened&amp;json-ld=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22name%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%2C%0A%20%20%20%20%22knows%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fknows%22%0A%20%20%7D%2C%0A%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%22name%22%3A%20%22Markus%20Lanthaler%22%2C%0A%20%20%22knows%22%3A%20%5B%0A%20%20%20%20%7B%22name%22%3A%20%22Dave%20Longley%22%7D%0A%20%20%5D%0A%7D&amp;context=%7B%7D">Open in playground</a>
      </div>
      <pre class="original result selected nohighlight" data-result-for="JSON-LD document in compact form" data-flatten="">[{
  "@id": "http://me.markus-lanthaler.com/",
  "http://xmlns.com/foaf/0.1/name": [
    { "@value": "Markus Lanthaler" }
  ],
  "http://xmlns.com/foaf/0.1/knows": [
    { "@id": "_:b0" }
  ]
}, {
  "@id": "_:b0",
  "http://xmlns.com/foaf/0.1/name": [
    { "@value": "Dave Longley" }
  ]
}]</pre>
    </aside>

    <p class="changed">The example above is the JSON-LD serialization of the output of the
      <a href="#flattening-algorithm">flattening algorithm</a>,
      where the algorithm's use of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are replaced with <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a>.</p>

    <p>Note how in the output above all <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> are collected in a
      single <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> and how the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> representing
      "Dave Longley" has been assigned the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
      <code>_:b0</code>.</p>

    <p>To make it easier for humans to read or for certain applications to
      process it, a flattened document can be compacted by passing a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>. Using
      the same context as the input document, the flattened and compacted document
      looks as follows:</p>

    <aside class="example ds-selector-tabs" id="example-11-flattened-and-compacted-sample-document"><div class="marker">
      <a class="self-link" href="#example-11-flattened-and-compacted-sample-document">Example<bdi> 11</bdi></a><span class="example-title">: Flattened and compacted sample document</span>
    </div>
      <div class="selectors">
        <a class="playground" data-result-for="#json-ld-document-in-compact-form" data-context="#json-ld-document-in-compact-form" data-flatten="" target="_blank" aria-label="playground link" href="https://json-ld.org/playground/#startTab=tab-flattened&amp;json-ld=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22name%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%2C%0A%20%20%20%20%22knows%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fknows%22%0A%20%20%7D%2C%0A%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%22name%22%3A%20%22Markus%20Lanthaler%22%2C%0A%20%20%22knows%22%3A%20%5B%0A%20%20%20%20%7B%22name%22%3A%20%22Dave%20Longley%22%7D%0A%20%20%5D%0A%7D&amp;context=%7B%0A%20%20%22%40context%22%3A%20%7B%0A%20%20%20%20%22name%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fname%22%2C%0A%20%20%20%20%22knows%22%3A%20%22http%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fknows%22%0A%20%20%7D%2C%0A%20%20%22%40id%22%3A%20%22http%3A%2F%2Fme.markus-lanthaler.com%2F%22%2C%0A%20%20%22name%22%3A%20%22Markus%20Lanthaler%22%2C%0A%20%20%22knows%22%3A%20%5B%0A%20%20%20%20%7B%22name%22%3A%20%22Dave%20Longley%22%7D%0A%20%20%5D%0A%7D">Open in playground</a>
      </div>
      <pre class="result selected nohighlight" data-result-for="JSON-LD document in compact form" data-context="JSON-LD document in compact form" data-flatten="" title="Flattened and compacted sample document">{
  "@context": {
    "name": "http://xmlns.com/foaf/0.1/name",
    "knows": "http://xmlns.com/foaf/0.1/knows"
  },
  "@graph": [{
    "@id": "http://me.markus-lanthaler.com/",
    "name": "Markus Lanthaler",
    "knows": { "@id": "_:b0" }
  }, {
    "@id": "_:b0",
    "name": "Dave Longley"
  }]
}</pre>
    </aside>

    <p>Please note that the result of flattening and <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a> a document
      is always a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
      <span class="changed">(represented as a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON object</a> when serialized)</span>,
      which contains an <code>@graph</code>
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> that represents the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a>.</p>
  </section> 

  <section class="informative" id="rdf-serialization-deserialization">
    <h3 id="x2-4-rdf-serialization-deserialization"><bdi class="secno">2.4 </bdi>RDF Serialization/Deserialization<a class="self-link" aria-label="§" href="#rdf-serialization-deserialization"></a></h3><p><em>This section is non-normative.</em></p>

    <p>JSON-LD can be used to serialize RDF data as described in
      [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>]. This ensures that data can be round-tripped to and from
      any RDF syntax without any loss in fidelity.</p>

    <p>For example, assume the following RDF input serialized in Turtle [<cite><a class="bibref" data-link-type="biblio" href="#bib-turtle" title="RDF 1.1 Turtle">TURTLE</a></cite>]:</p>

    <div class="example" id="example-12-sample-turtle-document">
          <div class="marker">
      <a class="self-link" href="#example-12-sample-turtle-document">Example<bdi> 12</bdi></a><span class="example-title">: Sample Turtle document</span>
    </div> <pre class="nohighlight" data-content-type="text/turtle" data-from-rdf="">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .

&lt;http://me.markus-lanthaler.com/&gt;
  foaf:name "Markus Lanthaler" ;
  foaf:homepage &lt;http://www.markus-lanthaler.com/&gt; .</pre>
        </div>

    <p>Using the <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>
      a developer could transform this document into expanded JSON-LD:</p>

    <div class="example" id="example-13-sample-turtle-document-converted-to-json-ld">
          <div class="marker">
      <a class="self-link" href="#example-13-sample-turtle-document-converted-to-json-ld">Example<bdi> 13</bdi></a><span class="example-title">: Sample Turtle document converted to JSON-LD</span>
    </div> <pre class="nohighlight" data-result-for="Sample Turtle document" data-from-rdf="">[
  {
    "@id": "http://me.markus-lanthaler.com/",
    "http://xmlns.com/foaf/0.1/name": [
      { "@value": "Markus Lanthaler" }
    ],
    "http://xmlns.com/foaf/0.1/homepage": [
      { "@id": "http://www.markus-lanthaler.com/" }
    ]
  }
]</pre>
        </div>

    <p class="changed">The example above is the JSON-LD serialization of the output of the
      <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>,
      where the algorithm's use of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are replaced with <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON objects</a>.</p>

    <p>Note that the output above could easily be compacted using the technique outlined
      in the previous section. It is also possible to deserialize the JSON-LD document back
      to RDF using the <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>.</p>
  </section> 
</section> 


<section id="conformance"><h2 id="x3-conformance"><bdi class="secno">3. </bdi>Conformance<a class="self-link" aria-label="§" href="#conformance"></a></h2><p>
      As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.
    </p><p>
          The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, and <em class="rfc2119">SHOULD</em> in this document
          are to be interpreted as described in
          <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
          when, and only when, they appear in all capitals, as shown here.
        </p>
  <p>There are two classes of products that can claim conformance to this
    specification: <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processors</a>,
    and <a href="#dfn-rdf-serializers-deserializers" class="internalDFN" data-link-type="dfn">RDF Serializers/Deserializers</a>.</p>

  <p>A conforming <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processor</a> is a system which can perform the
    <a href="#expansion-algorithm">Expansion</a>, <a href="#compaction-algorithm">Compaction</a>,
    and <a href="#flattening-algorithm">Flattening</a> operations
    <span class="changed">in a manner consistent with
      the algorithms defined in this specification</span>.</p>

  <p><a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processors</a> <em class="rfc2119" title="MUST NOT">MUST NOT</em>
    attempt to correct malformed <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a>;
    however, they <em class="rfc2119" title="SHOULD">SHOULD</em> issue validation warnings.
    IRIs are not modified other than conversion between
    <a data-lt="relative IRI reference" data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative</a> and absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>.</p>

  <p>A conforming <dfn data-lt="RDF Serializers/Deserializers|RDF Serializer/Deserializer" data-dfn-type="dfn" id="dfn-rdf-serializers-deserializers">RDF Serializer/Deserializer</dfn> is a system that can
    <a href="#deserialize-json-ld-to-rdf-algorithm">deserialize JSON-LD to RDF</a> and
    <a href="#serialize-rdf-as-json-ld-algorithm">serialize RDF as JSON-LD</a> as
    defined in this specification.</p>

  <p class="changed">Unless specified using
    <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-processingmode" class="internalDFN" data-link-type="idl"><code>processingMode</code></a> API option,
    the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is set using the <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
    in a local <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> and
    affects the behavior of algorithms including <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expansion</a> and <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>.
    Once set, it is an error to attempt to change to a different processing mode,
    and processors <em class="rfc2119" title="MUST">MUST</em> generate,
    a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-processing-mode-conflict" class="internalDFN" data-link-type="idl"><code>processing mode conflict</code></a>
    error and abort further processing.</p>

  <p>The algorithms in this specification are generally written with more concern for clarity
    than efficiency. Thus, <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">JSON-LD Processors</a> may
    implement the algorithms given in this specification in any way desired,
    so long as the end result is indistinguishable from the result that would
    be obtained by the specification's algorithms.</p>

  <p>In algorithm steps that describe operations on <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a>, those steps
    also apply to <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword aliases</a>.</p>

  <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>Note</span></div><p class="">Implementers can partially check their level of conformance to
    this specification by successfully passing the test cases of the
    <a href="https://w3c.github.io/json-ld-api/tests/">JSON-LD test suite</a>.
    Note, however, that passing all the tests in the test
    suite does not imply complete conformance to this specification. It only implies
    that the implementation conforms to aspects tested by the test suite.</p></div>

  <p>This specification makes use of the following namespace prefixes:</p>
  <table class="simple">
    <thead><tr>
      <th>Prefix</th>
      <th><abbr title="Internationalized Resource Identifier">IRI</abbr></th>
    </tr></thead>
    <tbody>
      <tr>
        <td>rdf</td>
        <td>http://www.w3.org/1999/02/22-rdf-syntax-ns#</td>
      </tr>
      <tr>
        <td>xsd</td>
        <td>http://www.w3.org/2001/XMLSchema#</td>
      </tr>
    </tbody>
  </table>
</section> 

<section id="context-processing-algorithms"><h2 id="x4-context-processing-algorithms"><bdi class="secno">4. </bdi>Context Processing Algorithms<a class="self-link" aria-label="§" href="#context-processing-algorithms"></a></h2>

  <p>The following sections describe algorithms for processing a JSON-LD context.</p>

  <section id="context-processing-algorithm"><h3 id="x4-1-context-processing-algorithm"><bdi class="secno">4.1 </bdi>Context Processing Algorithm<a class="self-link" aria-label="§" href="#context-processing-algorithm"></a></h3>

    <p>When processing a JSON-LD data structure, each processing rule is applied
      using information provided by the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>. This
      section describes how to produce an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>.</p>

    <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> consists of:</p>
    <ul>
      <li>the active <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a> which specify how
        keys and values have to be interpreted (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>),</li>
      <li>the current <dfn data-lt="context-base-iri" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-context-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>),</li>
      <li class="changed">the <dfn data-dfn-type="dfn" id="dfn-original-base-url">original base URL</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>),</li>
      <li>an optional <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>),</li>
      <li>an optional <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>),</li>
      <li class="changed">an optional <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>  (<code>"ltr"</code> or <code>"rtl"</code>),</li>
      <li class="changed">and an optional <dfn data-dfn-type="dfn" id="dfn-previous-context">previous context</dfn> (<a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>),
        used when a non-propagated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is defined.</li>
    </ul>

    <p>Each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> consists of:</p>
    <ul>
      <li>an <dfn data-dfn-type="dfn" data-plurals="iri mappings" id="dfn-iri-mapping"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>),</li>
      <li class="changed">a <dfn data-dfn-type="dfn" id="dfn-prefix-flag">prefix flag</dfn> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a>),</li>
      <li class="changed">a <dfn data-dfn-type="dfn" id="dfn-protected">protected</dfn> flag (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a>),</li>
      <li>a <dfn data-dfn-type="dfn" id="dfn-reverse-property">reverse property</dfn> flag (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a>),</li>
      <li class="changed">an optional <dfn data-dfn-type="dfn" id="dfn-base-url">base URL</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>),</li>
      <li class="changed">an optional <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> (<a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>),</li>
      <li>an optional <dfn data-dfn-type="dfn" id="dfn-container-mapping">container mapping</dfn> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>),
      </li><li class="changed">an optional <dfn data-dfn-type="dfn" id="dfn-direction-mapping">direction mapping</dfn> (<code>"ltr"</code> or <code>"rtl"</code>),</li>
      <li class="changed">an optional <dfn data-dfn-type="dfn" id="dfn-index-mapping">index mapping</dfn> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>),</li>
      <li>an optional <dfn data-dfn-type="dfn" data-plurals="language mappings" id="dfn-language-mapping">language mapping</dfn> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>),</li>
      <li class="changed">an optional <dfn data-dfn-type="dfn" id="dfn-nest-value">nest value</dfn> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>),</li>
      <li>and an optional <dfn data-dfn-type="dfn" data-plurals="type mappings" id="dfn-type-mapping">type mapping</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>).</li>
    </ul>

    <p>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> can not only be used to map a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
      to an <abbr title="Internationalized Resource Identifier">IRI</abbr>, but also to map a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> to a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>,
      in which case it is referred to as a <dfn data-dfn-type="dfn" data-plurals="keyword aliases" id="dfn-keyword-alias">keyword alias</dfn>.</p>

    <p>When processing, <var>active context</var> is initialized
      without any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>,
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>, <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>, or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>.
      If a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> is encountered during processing, a new
      <var>active context</var> is created by cloning the existing
      <var>active context</var>. Then the information from the
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> is merged into the new <var>active context</var>.
      Given that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local contexts</a> may contain
      references to remote contexts, this includes their retrieval.</p>

    <section class="informative" id="overview">
      <h4 id="x4-1-1-overview"><bdi class="secno">4.1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview"></a></h4><p><em>This section is non-normative.</em></p>

      <p>First we prepare a new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> <var>result</var> by cloning
        the current <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>. Then we normalize the form of the original
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">Local contexts</a> may be in the form of a
        <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing
        a combination of the two. Finally we process each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> contained
        in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> as follows.</p>

      <p>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, it represents a reference to
        a remote context. We dereference the remote context and replace <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>
        with the value of the <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of the top-level object in the
        retrieved JSON-LD document.
        If there's no such <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, an
        <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-remote-context" class="internalDFN" data-link-type="idl"><code>invalid remote context</code></a>
        has been detected. Otherwise, we process <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> by recursively using
        this algorithm ensuring that there is no cyclical reference.</p>

      <p>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
        it is a <a href="https://www.w3.org/TR/json-ld11/#dfn-context-definition">context definition</a>.
        We first update
        the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
        <span class="changed">the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a></span>,
        the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>,
        <span class="changed">context propagation</span>,
        <span class="changed">the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a></span>,
        and the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>
        by processing six specific keywords:
        <code>@base</code>,
        <code class="changed">@direction</code>,
        <code>@language</code>,
        <code class="changed">@propagate</code>,
        <code class="changed">@version</code>,
        and <code>@vocab</code>.
        These are handled before any other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> because
        they affect how the other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> are processed.
        <span class="changed">If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> contains <code>@import</code>, it is retrieved and is reverse-merged
          into the containing context, allowing JSON-LD 1.0 contexts to be upgraded to JSON-LD 1.1.</span>
        Please note that <code>@base</code> is ignored when processing remote contexts.</p>

      <p class="changed">If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is not to be propagated,
        a reference to the <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a> is retained so that
        it may be rolled back when a new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> is entered.
        By default, all contexts are propagated, other than <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-scoped-context">type-scoped contexts</a>.</p>

      <p class="changed">
        When an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> is initialized, the value
        of the <a href="#dfn-original-base-url" class="internalDFN" data-link-type="dfn">original base URL</a>
        is initialized from the original <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a>
        of the document containing the initial <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>, if available,
        otherwise from the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> API option.
        This is necessary when resetting the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>
        by setting it to <code>null</code>
        to retain the original default <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</p>

      <p>Then, for every other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>, we update
        the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>result</var>. Since
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>
        may themselves contain <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> or
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a>, we may need to recurse.
        When doing so, we must ensure that there is no cyclical dependency,
        which is an error. After we have processed any
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> dependencies,
        we update the current <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>,
        which may be a <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword alias</a>.</p>

      <p>Finally, we return <var>result</var> as the new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>.</p>
    </section>

    <section class="algorithm" id="algorithm">
      <h4 id="x4-1-2-algorithm"><bdi class="secno">4.1.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm"></a></h4>

      <p>This algorithm specifies how a new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> is updated
        with a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>. The algorithm takes three required
        <span class="changed">and three optional</span>
        input variables.
        The required inputs are
        an <var>active context</var>,
        a <var>local context</var>,
        <span class="changed">and a <var>base URL</var> used when resolving relative context URLs</span>.
        The optional inputs are
        an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>remote contexts</var>,
        defaulting to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, which is used to detect cyclical context inclusions,
        <span class="changed">
          <var>override protected</var>, defaulting to <code>false</code>,
          which is used to allow changes to protected terms,
          and <var>propagate</var>, defaulting to <code>true</code>
          to mark <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a> associated with non-propagated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">contexts</a>.</span>.
      </p>

      <ol>
        <li>Initialize <var>result</var> to the result of cloning
          <var>active context</var>.</li>
        <li class="changed">If <var>local context</var> is an object containing the member <code>@propagate</code>,
          its value <em class="rfc2119" title="MUST">MUST</em> be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a> <code>true</code> or <code>false</code>,
          set <var>propagate</var> to that value.
          <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>Note</span></div><div class="">Error handling is performed in <a href="#step-propagate-entry">step 5.11</a>.</div></div></li>
        <li class="changed">If <var>propagate</var> is <code>false</code>, and <var>result</var>
          does not have a <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a>, set <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a>
          in <var>result</var> to <var>active context</var>.</li>
        <li>If <var>local context</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
          set <var>local context</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only
          <var>local context</var>.</li>
        <li>
          For each item <var>context</var> in <var>local context</var>:
          <ol>
            <li>If <var>context</var> is <code>null</code>:
              <ol>
                <li class="changed">If <var>override protected</var> is <code>false</code> and <var>active context</var>
                  contains any <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-context-nullification" class="internalDFN" data-link-type="idl"><code>invalid context nullification</code></a>
                  has been detected and processing is aborted.</li>
                <li>Initialize <var>result</var> as a
                  newly-initialized <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>,
                  <span class="changed">
                    setting both <a data-lt="context-base-iri" href="#dfn-context-base-iri" class="internalDFN" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> and <a href="#dfn-original-base-url" class="internalDFN" data-link-type="dfn">original base URL</a> to the value of
                    <a href="#dfn-original-base-url" class="internalDFN" data-link-type="dfn">original base URL</a> in <var>active context</var></span>,
                    and, if <var>propagate</var> is <code>false</code>,
                    <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a> in <var>result</var>
                    to the previous value of <var>result</var>.</li>
                <li>Continue with the next <var>context</var>.</li>
              </ol>
            </li>
            <li id="alg-context-string">If <var>context</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
              <ol>
                <li>Initialize <var>context</var> to the result of resolving <var>context</var> against
                  <var>base URL</var>. If <var>base URL</var> is not a valid <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
                  then <var>context</var> <em class="rfc2119" title="MUST">MUST</em> be a valid <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, otherwise
                  a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a> error
                  has been detected and processing is aborted.
                  <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span></div><div class="">
                    <var>base URL</var> is often not the same as <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a>
                    or the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of the <var>active context</var>.
                  </div></div>
                </li>
                <li>If the number of entries in the <var>remote contexts</var> array
                  exceeds a processor defined limit, a
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-context-overflow" class="internalDFN" data-link-type="idl"><code>context overflow</code></a>
                  error has been detected and processing is aborted;
                  otherwise, add <var>context</var> to <var>remote contexts</var>.</li>
                <li class="changed">If <var>context</var> was previously dereferenced,
                  then the processor <em class="rfc2119" title="MUST NOT">MUST NOT</em> do a further dereference, and
                  <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is set to the
                  previously established <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>:
                  set <var>context document</var> to the previously dereferenced document,
                  and set <var>loaded context</var> to the value of the <code>@context</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from the document in <var>context document</var>.
                  <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>Note</span></div><div class="">Only the <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> need be retained.</div></div>
                </li>
                <li class="changed">Otherwise, set <var>context document</var>
                  to the <a data-xref-type="_IDL_" href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code><code>RemoteDocument</code></code></a> obtained
                  by dereferencing <var>context</var> using
                  the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, passing <var>context</var>
                  for <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
                  and <code>http://www.w3.org/ns/json-ld#context</code> for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-profile" class="internalDFN" data-link-type="idl"><code>profile</code></a>
                  and for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-requestprofile" class="internalDFN" data-link-type="idl"><code>requestProfile</code></a>.
                  <ol>
                    <li id="alg-context-deref-error">If <var>context</var> cannot be dereferenced,
                      <span class="changed">
                        or the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a> from <var>context document</var>
                        cannot be transformed into the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>
                      </span>,
                      a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-remote-context-failed" class="internalDFN" data-link-type="idl"><code>loading remote context failed</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>If the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a> has no
                      top-level <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with an <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-remote-context" class="internalDFN" data-link-type="idl"><code>invalid remote context</code></a>
                      has been detected and processing is aborted.</li>
                    <li>Set <var>loaded context</var> to the value of that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                  </ol>
                </li>
                <li>Set <var>result</var> to the result of recursively calling this algorithm,
                  passing <var>result</var> for <var>active context</var>,
                  <var>loaded context</var> for <var>local context</var>,
                  <span class="changed">
                    the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a> of <var>context document</var> for <var>base URL</var>,
                  </span>
                  and <span class="changed">a copy of</span> <var>remote contexts</var>.
                  <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="5"><span>Note</span></div><div class="">If <var>context</var> was previously dereferenced,
                    <a href="#dfn-json-ld-processor" class="internalDFN" data-link-type="dfn">processors</a> <em class="rfc2119" title="MUST">MUST</em> make provisions for retaining the <var>base URL</var>
                    of that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> for this step to enable the resolution of any
                    relative context URLs that may be encountered during processing.</div></div>
                </li>
                <li>Continue with the next <var>context</var>.</li>
              </ol>
            </li>
            <li>If <var>context</var> is not a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-local-context" class="internalDFN" data-link-type="idl"><code>invalid local context</code></a>
              error has been detected and processing is aborted.</li>
            <li>Otherwise, <var>context</var> is a <a href="https://www.w3.org/TR/json-ld11/#dfn-context-definition">context definition</a>.</li>
            <li class="changed">If <var>context</var> has an <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>If the associated value is not <code>1.1</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@version-value" class="internalDFN" data-link-type="idl"><code>invalid @version value</code></a>
                  has been detected, and processing is aborted.
                <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="5"><span>Note</span></div><div class="">The use of <code>1.1</code> for the value of <code>@version</code> is intended to
                  cause a JSON-LD 1.0 processor to stop processing.
                  Although it is clearly meant to be related to JSON-LD 1.1, it does not
                  otherwise adhere to the requirements for <a href="https://semver.org/">Semantic Versioning</a>.
                  Implementations may require
                  <a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic#Minimizing_the_effect_of_accuracy_problems">special consideration</a>
                  when comparing the values of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a> with a non-zero fractional part.</div></div>
                </li>
                <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a>
                  is set to <code>json-ld-1.0</code>,
                  a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-processing-mode-conflict" class="internalDFN" data-link-type="idl"><code>processing mode conflict</code></a>
                  error has been detected and processing is aborted.</li>
              </ol>
            </li>
            <li class="changed">If <var>context</var> has an <code>@import</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-context-entry" class="internalDFN" data-link-type="idl"><code>invalid context entry</code></a>
                  error has been detected and processing is aborted.</li>
                <li>Otherwise, if the value of <code>@import</code> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@import-value" class="internalDFN" data-link-type="idl"><code>invalid @import value</code></a>
                  error has been detected and processing is aborted.</li>
                <li>Initialize <var>import</var> to the result of resolving the value of <code>@import</code> against
                  <var>base URL</var>.</li>
                <li>Dereference <var>import</var> using
                  the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, passing <var>import</var>
                  for <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
                  and <code>http://www.w3.org/ns/json-ld#context</code> for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-profile" class="internalDFN" data-link-type="idl"><code>profile</code></a>
                  and for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-requestprofile" class="internalDFN" data-link-type="idl"><code>requestProfile</code></a>.</li>
                <li>If <var>import</var> cannot be dereferenced,
                  <span>or cannot be transformed into the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a></span>,
                  a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-remote-context-failed" class="internalDFN" data-link-type="idl"><code>loading remote context failed</code></a>
                  error has been detected and processing is aborted.</li>
                <li>If the dereferenced document has no
                  top-level <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with an <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  or if the value of <code>@context</code> is not a <a href="https://www.w3.org/TR/json-ld11/#dfn-context-definition">context definition</a>
                  (i.e., it is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>),
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-remote-context" class="internalDFN" data-link-type="idl"><code>invalid remote context</code></a>
                  has been detected and processing is aborted; otherwise,
                  set <var>import context</var> to the value of that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                <li>If <var>import context</var> has a <code>@import</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-context-entry" class="internalDFN" data-link-type="idl"><code>invalid context entry</code></a>
                  error has been detected and processing is aborted.</li>
                <li>Set <var>context</var> to the result of merging <var>context</var>
                  into <var>import context</var>, replacing common entries
                  with those from <var>context</var>.</li>
              </ol>
            </li>
            <li>If <var>context</var> has an <code>@base</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> and <var>remote contexts</var> is empty, i.e., the currently
              being processed context is not a remote context:
              <ol>
                <li>Initialize <var>value</var> to the value associated with the
                  <code>@base</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                <li>If <var>value</var> is <code>null</code>, remove the
                  <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of <var>result</var>.</li>
                <li>Otherwise, if <var>value</var> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
                  the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of <var>result</var> is set to <var>value</var>.</li>
                <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> and
                  the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of <var>result</var> is not <code>null</code>,
                  set the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of <var>result</var> to the result of
                  resolving <var>value</var> against the current <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
                  of <var>result</var>.</li>
                <li>Otherwise, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-base-iri" class="internalDFN" data-link-type="idl"><code>invalid base <abbr title="Internationalized Resource Identifier">IRI</abbr></code></a>
                  error has been detected and processing is aborted.</li>
              </ol>
            </li>
            <li>If <var>context</var> has an <code>@vocab</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>Initialize <var>value</var> to the value associated with the
                  <code>@vocab</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                <li>If <var>value</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#nulls">null</a>, remove
                  any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a> from <var>result</var>.</li>
                <li>Otherwise, if <var>value</var> is
                  an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>
                  or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>
                  of <var>result</var> is set to
                  <span class="changed">the result of
                    <a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a> <var>value</var>
                    using <code>true</code> for <var>document relative</var>
                  </span>.
                  If it is not an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-vocab-mapping" class="internalDFN" data-link-type="idl"><code>invalid vocab mapping</code></a>
                  error has been detected and processing is aborted.
                  <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="5"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to value for <code>@vocab</code> is obsolete,
                    and may be removed in a future version of JSON-LD.</div></div></li>
              </ol>
            </li>
            <li>If <var>context</var> has an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>Initialize <var>value</var> to the value associated with the
                  <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                <li>If <var>value</var> is <code>null</code>, remove
                  any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> from <var>result</var>.</li>
                <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, the
                  <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> of <var>result</var> is set to
                  <var>value</var>.
                  If it is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-default-language" class="internalDFN" data-link-type="idl"><code>invalid default language</code></a>
                  error has been detected and processing is aborted.
                  <span class="changed">If <var>value</var> is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> according to
                    <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>],
                    processors <em class="rfc2119" title="SHOULD">SHOULD</em> issue a warning.</span>
                  <div class="note" role="note" id="issue-container-generatedID-8"><div role="heading" class="note-title marker" id="h-note-8" aria-level="5"><span>Note</span></div><div class="changed">Processors <em class="rfc2119" title="MAY">MAY</em> normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lower case.</div></div>
                </li>
              </ol>
            </li>
            <li class="changed">If <var>context</var> has an <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-context-entry" class="internalDFN" data-link-type="idl"><code>invalid context entry</code></a>
                  error has been detected and processing is aborted.</li>
                <li>Initialize <var>value</var> to the value associated with the
                  <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                <li>If <var>value</var> is <code>null</code>, remove
                  any <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> from <var>result</var>.</li>
                <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, the
                  <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> of <var>result</var> is set to
                  <var>value</var>. If it is not <code>null</code>, <code>"ltr"</code>, or <code>"rtl"</code>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-base-direction" class="internalDFN" data-link-type="idl"><code>invalid base direction</code></a>
                  error has been detected and processing is aborted.</li>
              </ol>
            </li>
            <li id="step-propagate-entry" class="changed">If <var>context</var> has an <code>@propagate</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-context-entry" class="internalDFN" data-link-type="idl"><code>invalid context entry</code></a>
                  error has been detected and processing is aborted.</li>
                <li>Otherwise, if the value of <code>@propagate</code> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a> <code>true</code> or <code>false</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@propagate-value" class="internalDFN" data-link-type="idl"><code>invalid @propagate value</code></a>
                  error has been detected and processing is aborted.
                  <div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-9" aria-level="5"><span>Note</span></div><div class="">The <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a> is actually set earlier in this algorithm;
                    the previous two steps exist for error checking only.</div></div>
                  </li>
              </ol>
            </li>
            <li>Create a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>defined</var> to keep
              track of whether or not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> has already been defined
              or is currently being defined during recursion.</li>
            <li>For each <var>key</var>-<var>value</var> pair in <var>context</var> where
              <var>key</var> is not
              <code>@base</code>,
              <code class="changed">@direction</code>,
              <code class="changed">@import</code>,
              <code>@language</code>,
              <code class="changed">@propagate</code>,
              <code class="changed">@protected</code>,
              <code>@version</code>, or
              <code>@vocab</code>,
              invoke the
              <a href="#create-term-definition">Create Term Definition algorithm</a>,
              passing <var>result</var> for <var>active context</var>,
              <var>context</var> for <var>local context</var>, <var>key</var>,
              <var>defined</var>,
              <span class="changed">
                <var>base URL</var>,
                and the value of the <code>@protected</code>
                entry from <var>context</var>, if any, for <var>protected</var>
              </span>.
            </li>
          </ol>
        </li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="create-term-definition"><h3 id="x4-2-create-term-definition"><bdi class="secno">4.2 </bdi>Create Term Definition<a class="self-link" aria-label="§" href="#create-term-definition"></a></h3>

    <p>This algorithm is called from the
      <a href="#context-processing-algorithm">Context Processing algorithm</a>
      to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>
      for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> being processed in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>.</p>

    <section class="informative" id="overview-0">
      <h4 id="x4-2-1-overview"><bdi class="secno">4.2.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-0"></a></h4><p><em>This section is non-normative.</em></p>

      <p><a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">Term definitions</a> are created by
        parsing the information in the given <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> for the
        given <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>. If the given <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> is a
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, it may omit an <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> by
        depending on its <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> having its own
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>. If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> is
        an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>, then its <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
        must first be created, through recursion, before continuing. Because a
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> can depend on other
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>, a mechanism must
        be used to detect cyclical dependencies. The solution employed here
        uses a map, <var>defined</var>, that keeps track of whether or not a
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> has been defined or is currently in the process of
        being defined. This map is checked before any recursion is attempted.</p>

      <p>After all dependencies for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> have been defined, the rest of
        the information in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> for the given
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> is taken into account, creating the appropriate
        <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>, <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>, and
        <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>,
        <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
        <span class="changed">or <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a></span>
        for the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-0">
      <h4 id="x4-2-2-algorithm"><bdi class="secno">4.2.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-0"></a></h4>

      <p>The algorithm has four required <span class="changed">and three optional</span> inputs.
        The required inputs are
        an <var>active context</var>,
        a <var>local context</var>,
        a <var>term</var>,
        and a map <var>defined</var>.
        <span class="changed">The optional inputs are
          <var>base URL</var> defaulting to <code>null</code>,
          <var>protected</var> which defaults to <code>false</code>,
          and <var>override protected</var>, defaulting to <code>false</code>,
          which is used to allow changes to protected terms.</span>.
        </p>
      <ol>
        <li>If <var>defined</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>term</var> and the associated
          value is <code>true</code> (indicating that the
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has already been created), return. Otherwise,
          if the value is <code>false</code>, a
          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-cyclic-iri-mapping" class="internalDFN" data-link-type="idl"><code>cyclic <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
          error has been detected and processing is aborted.</li>
        <li>Set the value associated with <var>defined</var>'s <var>term</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to
          <code>false</code>. This indicates that the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
          is now being created but is not yet complete.</li>
        <li>Initialize <var>value</var> to a copy of the value associated with the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          <var>term</var> in <var>local context</var>.</li>
        <li class="changed">If <var>term</var> is <code>@type</code>,
          and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
          a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-keyword-redefinition" class="internalDFN" data-link-type="idl"><code>keyword redefinition</code></a> error has
          been detected and processing is aborted.
          At this point,
          <var>value</var> <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with only either or both of the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>:
          <ul>
            <li>An entry for <code>@container</code> with value <code>@set</code>.</li>
            <li>An entry for <code>@protected</code>.</li>
          </ul>
          Any other value means that a
          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-keyword-redefinition" class="internalDFN" data-link-type="idl"><code>keyword redefinition</code></a> error has
          been detected and processing is aborted.</li>
        <li><span class="changed">Otherwise</span>, since <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> cannot be overridden,
          <var>term</var> <em class="rfc2119" title="MUST NOT">MUST NOT</em> be a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> and a
          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-keyword-redefinition" class="internalDFN" data-link-type="idl"><code>keyword redefinition</code></a>
          error has been detected and processing is aborted.
          If <var>term</var> has the form of a keyword
          (i.e., it matches the ABNF rule <code>"@"1*ALPHA</code> from [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">RFC5234</a></cite>]),
          return; processors <em class="rfc2119" title="SHOULD">SHOULD</em> generate a warning.</li>
        <li class="changed">Initialize <var>previous definition</var> to any existing
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>term</var> in <var>active context</var>,
          removing that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> from <var>active context</var>.</li>
        <li class="changed">If <var>value</var> is <code>null</code>,
          convert it to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose
          key is <code>@id</code> and whose value is <code>null</code>.</li>
        <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, convert it
          to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose
          key is <code>@id</code> and whose value is <var>value</var>.
          <span class="changed">Set <var>simple term</var> to <code>true</code></span>.</li>
        <li>Otherwise, <var>value</var> <em class="rfc2119" title="MUST">MUST</em> be a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, if not, an
          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
          error has been detected and processing is aborted.
          <span class="changed">Set <var>simple term</var> to <code>false</code></span>.</li>
        <li>Create a new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>, <var>definition</var>,
          <span class="changed">initializing <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> to <code>false</code>,
            <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a> to <var>protected</var>,
            and <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a> to <code>false</code></span>.</li>
        <li class="changed">If the <code>@protected</code> entry in <var>value</var>
          is <code>true</code> set the <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a> flag in <var>definition</var> to true.
          If the value of <code>@protected</code> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a>,
          an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@protected-value" class="internalDFN" data-link-type="idl"><code>invalid @protected value</code></a> error has been detected and processing is aborted.
          If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
          an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
          has been detected and processing is aborted.</li>
        <li>If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@type</code>:
          <ol>
            <li>Initialize <var>type</var> to the value associated with the
              <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>. Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-mapping" class="internalDFN" data-link-type="idl"><code>invalid type mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li>Set <var>type</var> to the result of
              <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a> <var>type</var></span>,
              using <var>local context</var>, and <var>defined</var>.</li>
            <li class="changed">If the expanded <var>type</var> is
              <code>@json</code> or <code>@none</code>, and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-mapping" class="internalDFN" data-link-type="idl"><code>invalid type mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li id="ctd-invalid-type">Otherwise, if the expanded <var>type</var> is
              neither <code>@id</code>, nor <code>@json</code>,
              nor <code>@none</code>,
              nor <code>@vocab</code>, 
              nor an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-mapping" class="internalDFN" data-link-type="idl"><code>invalid type mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li>Set the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> for <var>definition</var> to <var>type</var>.</li>
          </ol>
        </li>
        <li>If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@reverse</code>:
          <ol>
            <li>If <var>value</var> contains <code>@id</code> or <code>@nest</code>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-reverse-property" class="internalDFN" data-link-type="idl"><code>invalid reverse property</code></a>
              error has been detected and processing is aborted.</li>
            <li>If the value associated with the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li>If the value associated with the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is a string
              having the form of a keyword
              (i.e., it matches the ABNF rule <code>"@"1*ALPHA</code> from [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">RFC5234</a></cite>]),
              return; processors <em class="rfc2119" title="SHOULD">SHOULD</em> generate a warning.</li>
            <li>Otherwise, set the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var> to the
              result of
              <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span>
              the value associated with the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              using <var>local context</var>, and <var>defined</var>.
              If the result does not have the <a href="https://tools.ietf.org/html/rfc3987#section-2.2">form</a> of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li>If <var>value</var> contains an <code>@container</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              set the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> of <var>definition</var>
              to <span class="changed">an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing</span> its value;
              if its value is neither <code>@set</code>, nor
              <code>@index</code>, nor <code>null</code>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-reverse-property" class="internalDFN" data-link-type="idl"><code>invalid reverse property</code></a>
              error has been detected (reverse properties only support set- and
              index-containers) and processing is aborted.</li>
            <li>Set the <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a> flag of <var>definition</var>
              to <code>true</code>.</li>
            <li>Set the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> of <var>term</var> in
              <var>active context</var> to <var>definition</var> and the
              value associated with <var>defined</var>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>term</var> to
              <code>true</code> and return.</li>
          </ol>
        </li>
        <li>If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> and its value
          does not equal <var>term</var>:
          <ol>
            <li id="ctd-id-null">If the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>value</var>
              is <code>null</code>, the term is not used for <abbr title="Internationalized Resource Identifier">IRI</abbr> expansion, but is
              retained to be able to detect future redefinitions of this term.</li>
            <li id="ctd-id-not-null">Otherwise:
              <ol>
                <li>If the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
                  error has been detected and processing is aborted.</li>
                <li>If the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                  is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>, but
                  has the form of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
                  (i.e., it matches the ABNF rule <code>"@"1*ALPHA</code> from [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">RFC5234</a></cite>]),
                  return; processors <em class="rfc2119" title="SHOULD">SHOULD</em> generate a warning.</li>
                <li>Otherwise, set the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var> to the
                  result of
                  <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span>
                  the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  using <var>local context</var>, and <var>defined</var>.
                  If the resulting <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> is neither a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>, nor an
                  <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, nor a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
                  error has been detected and processing is aborted; if it equals <code>@context</code>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-keyword-alias" class="internalDFN" data-link-type="idl"><code>invalid keyword alias</code></a>
                  error has been detected and processing is aborted.</li>
                <li id="ctd-contains-colon" class="changed">If the <var>term</var> contains a colon (<code>:</code>)
                  anywhere but as the first or last character of <var>term</var>,
                  or if it contains a slash (<code>/</code>) anywhere:
                  <ol>
                    <li>Set the value associated with <var>defined</var>'s <var>term</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to
                      <code>true</code>.</li>
                    <li>If the result of <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>term</var>
                      using <var>local context</var>, and <var>defined</var>,
                      is not the same as the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
                      error has been detected and processing is aborted.</li>
                  </ol>
                </li>
                <li class="changed">If <var>term</var> contains neither a colon (<code>:</code>) nor a slash (<code>/</code>),
                  <span class="changed"><var>simple term</var> is <code>true</code></span>,
                  and if the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var>
                  is either an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> ending with a <a href="https://tools.ietf.org/html/rfc3986#section-2.2">gen-delim</a> character,
                  or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
                  set the <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> in <var>definition</var> to <code>true</code>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>
          Otherwise if the <var>term</var> contains a colon (<code>:</code>)
          <span class="changed">anywhere after the first character</span>:
          <ol>
            <li>If <var>term</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a> with a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> that is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>local context</var>
              a dependency has been found. Use this algorithm recursively passing
              <var>active context</var>, <var>local context</var>, the
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> as <var>term</var>, and <var>defined</var>.</li>
            <li>If <var>term</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> has a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>active context</var>, set
              the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var> to the result of
              concatenating the value associated with the <a data-lt="prefix" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix's</a>
              <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> and the <var>term</var>'s <var>suffix</var>.</li>
            <li>Otherwise, <var>term</var> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>. Set the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
              of <var>definition</var> to <var>term</var>.</li>
          </ol>
        </li>
        <li class="changed">
          Otherwise if the <var>term</var> contains a slash (<code>/</code>):
          <ol>
            <li><var>Term</var> is a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a>.</li>
            <li>Set the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var> to the
              result of <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>term</var>.
              If the resulting <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> is not an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
              error has been detected and processing is aborted.</li>
          </ol>
        </li>
        <li class="changed">Otherwise, if term is <code>@type</code>, set the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
          of <var>definition</var> to <code>@type</code>.</li>
        <li>Otherwise, if <var>active context</var> has a
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>, the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
          of <var>definition</var> is set to the result of concatenating the value
          associated with the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a> and <var>term</var>.
          If it does not have a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>, an
          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-iri-mapping" class="internalDFN" data-link-type="idl"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></a>
          error been detected and processing is aborted.</li>
        <li>If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@container</code>:
          <ol>
            <li id="ctd-container">Initialize <var>container</var> to the value associated with the
              <code>@container</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be either
              <code class="changed">@graph</code>,
              <code class="changed">@id</code>,
              <code>@index</code>,
              <code>@language</code>,
              <code>@list</code>,
              <code>@set</code>,
              <code class="changed">@type</code>,
              <span class="changed">
                or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing exactly any one of those keywords,
                an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing <code>@graph</code> and
                either <code>@id</code> or <code>@index</code> optionally
                including <code>@set</code>,
                or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing a combination of <code>@set</code> and any of
                <code>@index</code>, <code>@graph</code>,
                <code>@id</code>, <code>@type</code>,
                <code>@language</code> in any order
              </span>.
              Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-container-mapping" class="internalDFN" data-link-type="idl"><code>invalid container mapping</code></a>
              has been detected and processing is aborted.</li>
            <li class="changed">If the container value
              is <code>@graph</code>, <code>@id</code>, or <code>@type</code>, or is otherwise not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
              generate an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-container-mapping" class="internalDFN" data-link-type="idl"><code>invalid container mapping</code></a>
              error and abort processing if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>.</li>
            <li>Set the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> of <var>definition</var> to
              <var>container</var>
              <span class="changed">coercing to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, if necessary</span>.</li>
            <li class="changed">If the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> of <var>definition</var> includes <code>@type</code>:
              <ol>
                <li>If <var>type mapping</var> in <var>definition</var> is undefined, set it to <code>@id</code>.</li>
                <li>If <var>type mapping</var> in <var>definition</var> is neither <code>@id</code> nor <code>@vocab</code>,
                  an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-mapping" class="internalDFN" data-link-type="idl"><code>invalid type mapping</code></a>
                  error has been detected and processing is aborted.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li class="changed">If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@index</code>:
          <ol>
            <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code> or
              <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> does not include <code>@index</code>,
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
            <li>Initialize <var>index</var> to the value associated with the
              <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> expanding to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
              Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
            <li>Set the <a href="#dfn-index-mapping" class="internalDFN" data-link-type="dfn">index mapping</a> of <var>definition</var> to <var>index</var></li>
          </ol>
        </li>
        <li class="changed">If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@context</code>:
          <ol>
            <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
            <li>Initialize <var>context</var> to the value associated with the
              <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which is treated as a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>.</li>
            <li>Invoke the <a href="#context-processing-algorithm">Context Processing algorithm</a>
              using the <var>active context</var>, <var>context</var> as <var>local context</var>,
              <var>base URL</var>,
              and <code>true</code> for <var>override protected</var>.
              If any error is detected, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-scoped-context" class="internalDFN" data-link-type="idl"><code>invalid scoped context</code></a> error
              has been detected and processing is aborted.
              <div class="note" role="note" id="issue-container-generatedID-10"><div role="heading" class="note-title marker" id="h-note-10" aria-level="5"><span>Note</span></div><p class="">The result of the <a href="#context-processing-algorithm">Context Processing algorithm</a>
                is discarded; it is called to detect errors at definition time.
                If used, the context will be re-processed and applied to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>
                as part of <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expansion</a> or <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>.</p></div></li>
            <li>Set the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> of <var>definition</var> to <var>context</var>,
              and <a href="#dfn-base-url" class="internalDFN" data-link-type="dfn">base URL</a> to <var>base URL</var>.</li>
          </ol>
        </li>
        <li>If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@language</code> and
          does not contain the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@type</code>:
          <ol>
            <li>Initialize <var>language</var> to the value associated with the
              <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be either <code>null</code>
              or a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>.
              <span class="changed">If <var>language</var> is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> according to
                <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>],
                processors <em class="rfc2119" title="SHOULD">SHOULD</em> issue a warning.</span>
              Otherwise, an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-language-mapping" class="internalDFN" data-link-type="idl"><code>invalid language mapping</code></a>
              error has been detected and processing is aborted.</li>
            <li>Set the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> of <var>definition</var> to <var>language</var>.
              <div class="note" role="note" id="issue-container-generatedID-11"><div role="heading" class="note-title marker" id="h-note-11" aria-level="5"><span>Note</span></div><div class="changed">Processors <em class="rfc2119" title="MAY">MAY</em> normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lower case.</div></div>
            </li>
          </ol>
        </li>
        <li class="changed">If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@direction</code> and
          does not contain the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@type</code>:
          <ol>
            <li>Initialize <var>direction</var> to the value associated with the
              <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be either <code>null</code>,
              <code>"ltr"</code>, or <code>"rtl"</code>. Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-base-direction" class="internalDFN" data-link-type="idl"><code>invalid base direction</code></a>
              error has been detected and processing is aborted.</li>
            <li>Set the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>
              of <var>definition</var> to <var>direction</var>.</li>
          </ol>
        </li>
        <li class="changed">If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@nest</code>:
          <ol>
            <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
            <li>Initialize <a href="#dfn-nest-value" class="internalDFN" data-link-type="dfn">nest value</a> in <var>definition</var> to the value associated with the
              <code>@nest</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> and
              <em class="rfc2119" title="MUST NOT">MUST NOT</em> be a keyword other than <code>@nest</code>. Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@nest-value" class="internalDFN" data-link-type="idl"><code>invalid @nest value</code></a>
              error has been detected and processing is aborted.</li>
          </ol>
        </li>
        <li class="changed">If <var>value</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@prefix</code>:
          <ol>
            <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>, or if
              <var>term</var> contains a colon (<code>:</code>) or slash (<code>/</code>), an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
            <li>Set the <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> to the value associated with the
              <code>@prefix</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a>. Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@prefix-value" class="internalDFN" data-link-type="idl"><code>invalid @prefix value</code></a>
              error has been detected and processing is aborted.</li>
            <li>If the <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> of <var>definition</var> is set to <code>true</code>,
              and its <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>,
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a>
              has been detected and processing is aborted.</li>
          </ol>
        </li>
        <li id="ctd-invalid-entries">If <var>value</var> contains any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> other than <code>@id</code>,
          <code>@reverse</code>, <code>@container</code>,
          <code class="changed">@context</code>, 
          <code class="changed">@direction</code>,
          <code class="changed">@index</code>,
          <code>@language</code>,
          <code class="changed">@nest</code>,
          <code class="changed">@prefix</code>,
          <code class="changed">@protected</code>,
          or <code>@type</code>,
          an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-term-definition" class="internalDFN" data-link-type="idl"><code>invalid term definition</code></a> error has
          been detected and processing is aborted.</li>
        <li class="changed">If <var>override protected</var> is <code>false</code>
          and <var>previous definition</var> exists and is protected;
          <ol>
            <li>If <var>definition</var> is not the same as <var>previous definition</var>
              (other than the value of <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a>),
              a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-protected-term-redefinition" class="internalDFN" data-link-type="idl"><code>protected term redefinition</code></a> error has been detected,
              and processing is aborted.</li>
            <li>Set <var>definition</var> to <var>previous definition</var> to retain the value
              of <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a>.</li>
          </ol>
        </li>
        <li>Set the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> of <var>term</var> in
          <var>active context</var> to <var>definition</var> and set the value
          associated with <var>defined</var>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>term</var> to
          <code>true</code>.</li>
      </ol>
    </section>
  </section> 

  <section id="inverse-context-creation"><h3 id="x4-3-inverse-context-creation"><bdi class="secno">4.3 </bdi>Inverse Context Creation<a class="self-link" aria-label="§" href="#inverse-context-creation"></a></h3>

    <p>When there is more than one <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that could be chosen
      to compact an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, it has to be ensured that the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
      selection is both deterministic and represents the most context-appropriate
      choice whilst taking into consideration algorithmic complexity.</p>

    <p>In order to make <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> selections, the concept of an
      <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> is introduced. An <dfn data-dfn-type="dfn" id="dfn-inverse-context">inverse context</dfn>
      is essentially a reverse lookup table that maps
      <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>,
      <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mappings</a>, and
      <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mappings</a> to a simple
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> for a given <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>. A
      <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> only needs to be generated for an
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> if it is being used for <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>.</p>

    <p>To make use of an <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a>, a list of preferred
      <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> and the
      <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> are gathered
      for a particular value associated with an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>. These parameters
      are then fed to the <a href="#term-selection">Term Selection algorithm</a>,
      which will find the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that most appropriately
      matches the value's mappings.</p>

    <section class="informative" id="overview-1">
      <h4 id="x4-3-1-overview"><bdi class="secno">4.3.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-1"></a></h4><p><em>This section is non-normative.</em></p>

      <p>To create an <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> for a given
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>, each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> in the
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> is visited, ordered by length, shortest
        first (ties are broken by choosing the lexicographically least
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>). For each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, an entry is added to
        the <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> for each possible combination of
        <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> and <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>
        or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> that would legally match the
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>. Illegal matches include differences between a
        value's <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> and
        that of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>. If a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> has no
        <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>, <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>, or
        <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> (or some combination of these), then it
        will have an entry in the <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> using the special
        key <code>@none</code>. This allows the
        <a href="#term-selection">Term Selection algorithm</a> to fall back
        to choosing more generic <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> when a more
        specifically-matching <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> is not available for a particular
        <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> and value combination.</p>

      <p class="changed">Although normalizing <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> is optional,
        the <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> creates entries based on normalized
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a>, so that the proper term can be selected
        regardless of representation.</p>
    </section>

    <section class="algorithm" id="algorithm-1">
      <h4 id="x4-3-2-algorithm"><bdi class="secno">4.3.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-1"></a></h4>

      <p>The algorithm takes one required input: the <var>active context</var> that
        the <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> is being created for.</p>

      <ol>
        <li>Initialize <var>result</var> to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li>Initialize <var>default language</var> to <code>@none</code>.
          If the <var>active context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>,
          set <var>default language</var> to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>
          <span class="changed">normalized to lower case</span>.</li>
        <li>For each key <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> and value <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in
          the <var>active context</var>, ordered by shortest <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
          first (breaking ties by choosing the lexicographically least
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>):
          <ol>
            <li>If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> is <code>null</code>,
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> cannot be selected during <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>,
              so continue to the next <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>.</li>
            <li>Initialize <var>container</var> to <code>@none</code>.
              <span class="changed">
                If the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> is not empty, set <var>container</var>
                to the concatenation of all values of the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
                in lexicographical order
              </span>.</li>
            <li>Initialize <var>var</var> to the value of the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
              for the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>.</li>
            <li>If <var>var</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>result</var>, add
              an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> where the key is <var>var</var> and the value
              is an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> to <var>result</var>.</li>
            <li>Reference the value associated with the <var>var</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in
              <var>result</var> using the variable <var>container map</var>.</li>
            <li>If <var>container map</var> has no <var>container</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              create one and set its value to a new
              <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with <span class="changed">three</span> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
              The first <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is <code>@language</code> and its value is a new empty
              <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, the second <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is <code>@type</code>
              and its value is a new empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
              <span class="changed">and the third <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is <code>@any</code>
                and its value is a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                <code>@none</code> set to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> being processed</span>.</li>
            <li>Reference the value associated with the <var>container</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              in <var>container map</var> using the variable <var>type/language map</var>.</li>
            <li>Reference the value associated with the <code>@type</code>
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>type/language map</var> using the variable
              <var>type map</var>.</li>
            <li>If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> indicates that the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
              represents a <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a>:
              <ol>
                <li>If <var>type map</var> does not have an <code>@reverse</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li class="changed">Otherwise, if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has a
              <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> which is <code>@none</code>:
              <ol>
                <li>Reference the value associated with the <code>@language</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>type/language map</var> using the variable
                  <var>language map</var>.</li>
                <li>If <var>language map</var> does not have an <code>@any</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
                <li>If <var>type map</var> does not have an <code>@any</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li>Otherwise, if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has a
              <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>:
              <ol>
                <li>If <var>type map</var> does not have an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> corresponding
                  to the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li>Reference the value associated with the <code>@language</code>
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>type/language map</var> using the variable
              <var>language map</var>.</li>
            <li class="changed">If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has both
              a <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> and a <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>:
              <ol>
                <li>Create a new variable <var>lang dir</var>.</li>
                <li>If neither the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> nor the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>
                  are <code>null</code>, set <var>lang dir</var> to the concatenation
                  of <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> and <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>
                  separated by an underscore (<code>"_"</code>)
                  normalized to lower case.</li>
                <li>Otherwise, if <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> is not <code>null</code>,
                  set <var>lang dir</var> to the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
                  normalized to lower case.
                </li><li>Otherwise, if <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> is not <code>null</code>,
                  set <var>lang dir</var> to <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>
                  preceded by an underscore (<code>"_"</code>).</li>
                <li>Otherwise, set <var>lang dir</var> to <code>@null</code>.</li>
                <li>If <var>language map</var> does not have a <var>lang dir</var>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li>Otherwise, if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has a
              <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> (might be <code>null</code>):
              <ol>
                <li>If the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> equals <code>null</code>,
                  set <var>language</var> to <code>@null</code>; otherwise
                  to the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
                  <span class="changed">normalized to lower case</span>.</li>
                <li>If <var>language map</var> does not have a <var>language</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li class="changed">Otherwise, if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has a
              <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> (might be <code>null</code>):
              <ol>
                <li>If the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> equals <code>null</code>,
                  set <var>direction</var> to <code>@none</code>; otherwise
                  to <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> preceded by an underscore (<code>"_"</code>).</li>
                <li>If <var>language map</var> does not have a <var>direction</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li class="changed">Otherwise, if <var>active context</var> has a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>:
              <ol>
                <li>Initialize a variable <var>lang dir</var>
                  with the concatenation of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>,
                  separate by an underscore (<code>"_"</code>),
                  normalized to lower case.</li>
                <li>If <var>language map</var> does not have a <var>lang dir</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
                <li>If <var>language map</var> does not have an <code>@none</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
                <li>If <var>type map</var> does not have an <code>@none</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
            <li>Otherwise:
              <ol>
                <li>If <var>language map</var> does not have a <var>default language</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                  <span class="changed">(after being normalized to lower case)</span>,
                  create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
                <li>If <var>language map</var> does not have an <code>@none</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
                <li>If <var>type map</var> does not have an <code>@none</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set its value to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
                  being processed.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="term-selection"><h3 id="x4-4-term-selection"><bdi class="secno">4.4 </bdi>Term Selection<a class="self-link" aria-label="§" href="#term-selection"></a></h3>

    <p>This algorithm, invoked via the <a href="#iri-compaction"><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction algorithm</a>,
      makes use of an <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a>
      <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a> to find the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that is best
      used to <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compact</a> an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>. Other
      information about a value associated with the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> is given,
      including which <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
      and which <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> would
      be best used to express the value.</p>

    <section class="informative" id="overview-2">
      <h4 id="x4-4-1-overview"><bdi class="secno">4.4.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-2"></a></h4><p><em>This section is non-normative.</em></p>

      <p>The <a data-lt="inverse context" href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context's</a> entry for
        the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> will be first searched according to the preferred
        <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>, in the order
        that they are given. Amongst <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> with a matching
        <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>, preference will be given to those
        with a matching <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
        over those without a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or
        <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>. If there is no <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
        with a matching <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> then the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
        without a <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> that matches the given
        <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> is selected. If
        there is still no selected <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, then a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
        with no <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> will
        be selected if available. No <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> will be selected that
        has a conflicting <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>.
        Ties between <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> that have the same
        mappings are resolved by first choosing the shortest terms, and then by
        choosing the lexicographically least term. Note that these ties are
        resolved automatically because they were previously resolved when the
        <a href="#inverse-context-creation">Inverse Context Creation algorithm</a>
        was used to create the <a href="#dfn-inverse-context" class="internalDFN" data-link-type="dfn">inverse context</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-2">
      <h4 id="x4-4-2-algorithm"><bdi class="secno">4.4.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-2"></a></h4>

      <p>This algorithm has five required inputs. They are:
        an <var>inverse context</var>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> or <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        <var>var</var>, an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>containers</var> that represents an
        ordered list of preferred <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>,
        a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> <var>type/language</var> that indicates whether
        to look for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> with a matching <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>
        or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>, and an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> representing
        an ordered list of <var>preferred values</var> for the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>
        or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> to look for.</p>

      <ol>
        <li>Initialize <var>container map</var> to the value associated with
          <var>var</var> in the <var>inverse context</var>.</li>
        <li>For each item <var>container</var> in <var>containers</var>:
          <ol>
            <li>If <var>container</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>container map</var>, then
              there is no <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> with a matching
              <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for it, so continue to the next
              <var>container</var>.</li>
            <li>Initialize <var>type/language map</var> to the value associated
              with the <var>container</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>container map</var>.</li>
            <li>Initialize <var>value map</var> to the value associated
              with <var>type/language</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>type/language map</var>.</li>
            <li>For each <var>item</var> in <var>preferred values</var>:
              <ol>
                <li>If <var>item</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>value map</var>,
                  then there is no <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> with a matching
                  <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
                  so continue to the next <var>item</var>.</li>
                <li>Otherwise, a matching term has been found, return the value
                  associated with the <var>item</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in
                  <var>value map</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>No matching term has been found. Return <code>null</code>.</li>
      </ol>
    </section>

    <section class="informative" id="examples">
      <h4 id="x4-4-3-examples"><bdi class="secno">4.4.3 </bdi>Examples<a class="self-link" aria-label="§" href="#examples"></a></h4><p><em>This section is non-normative.</em></p>
      <p>The following examples are intended to illustrate how the term selection algorithm
        behaves for different term definitions and values. It is not comprehensive, but
        intended to illustrate different parts of the algorithm.</p>

      <section id="language-map-term">
        <h5 id="language-map-term-0">Language Map Term<a class="self-link" aria-label="§" href="#language-map-term"></a></h5>
        <p>If the term definition has <code>"@container": "@language"</code>, it will only match a
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> having no <code>@type</code>.</p>

        <aside class="example" data-ignore="" id="example-14-term-definition-with-language-map"><div class="marker">
      <a class="self-link" href="#example-14-term-definition-with-language-map">Example<bdi> 14</bdi></a><span class="example-title">: Term definition with language map</span>
    </div>
          <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@context"</span>: {<span class="hljs-attr">"t"</span>: {<span class="hljs-attr">"@id"</span>: <span class="hljs-string">"http://example.org/t"</span>, <span class="hljs-attr">"@container"</span>: <span class="hljs-string">"@language"</span>}}
}</code></pre>

          <p>The inverse context will contain the following:</p>

          <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@language"</span>: {
    <span class="hljs-attr">"@language"</span>: {<span class="hljs-attr">"@none"</span>: <span class="hljs-string">"t"</span>},
    <span class="hljs-attr">"@type"</span>: {<span class="hljs-attr">"@none"</span>: <span class="hljs-string">"t"</span>},
    <span class="hljs-attr">"@any"</span>: {<span class="hljs-attr">"@none"</span>: <span class="hljs-string">"t"</span>}
  }
}</code></pre>
        </aside>

        <aside class="example" data-ignore="" id="example-15-language-map-term-with-language-value"><div class="marker">
      <a class="self-link" href="#example-15-language-map-term-with-language-value">Example<bdi> 15</bdi></a><span class="example-title">: Language map term with language value</span>
    </div>
          <p>Given the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>{"http://example.org/t": {"@value": "foo", "@type": "http:/example.org/type"}}</code>,
            The algorithm will be invoked as follows:</p>
          <dl>
            <dt><var>containers</var></dt>
            <dd><code>["@language", "@language@set", "@set", "@none", "@index", "@index@set"]</code></dd>
            <dt><var>type/language</var></dt>
            <dd><code>@language</code></dd>
            <dt><var>preferred values</var></dt>
            <dd><code>["en", "@none"]</code></dd>
          </dl>
          <p>The <var>value map</var> will be set to <code>{"@none": "t"}</code>,
            as <var>preferred values</var> contains <code>"@none"</code>,
            the algorithm returns <code>"t"</code> as the term to use for compaction.</p>
        </aside>
      </section>

      <section id="datatyped-term">
        <h5 id="datatyped-term-0">Datatyped Term<a class="self-link" aria-label="§" href="#datatyped-term"></a></h5>
        <p>If the term definition has a datatype, it will only match a
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> having a matching datatype.</p>

        <aside class="example" data-ignore="" id="example-16-term-definition-with-datatype"><div class="marker">
      <a class="self-link" href="#example-16-term-definition-with-datatype">Example<bdi> 16</bdi></a><span class="example-title">: Term definition with datatype</span>
    </div>
          <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@context"</span>: {<span class="hljs-attr">"t"</span>: {<span class="hljs-attr">"@id"</span>: <span class="hljs-string">"http://example.org/t"</span>, <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"http:/example.org/type"</span>}}
}</code></pre>

          <p>The inverse context will contain the following:</p>

          <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@none"</span>: {
    <span class="hljs-attr">"@language"</span>: {},
    <span class="hljs-attr">"@type"</span>: {<span class="hljs-attr">"http:/example.org/type"</span>: <span class="hljs-string">"t"</span>},
    <span class="hljs-attr">"@any"</span>: {<span class="hljs-attr">"@none"</span>: <span class="hljs-string">"t"</span>}
  }
}</code></pre>
        </aside>

        <aside class="example" data-ignore="" id="example-17-datatyped-term-with-datatyped-value"><div class="marker">
      <a class="self-link" href="#example-17-datatyped-term-with-datatyped-value">Example<bdi> 17</bdi></a><span class="example-title">: Datatyped term with datatyped value</span>
    </div>
          <p>Given the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>{"http://example.org/t": {"@value": "foo", "@type": "http:/example.org/type"}}</code>,
            The algorithm will be invoked as follows:</p>
          <dl>
            <dt><var>containers</var></dt>
            <dd><code>["@set", "@none", "@index", "@index@set"]</code></dd>
            <dt><var>type/language</var></dt>
            <dd><code>@type</code></dd>
            <dt><var>preferred values</var></dt>
            <dd><code>["http:/example.org/type", "@none"]</code></dd>
          </dl>
          <p>The <var>value map</var> will be set to <code>{"http:/example.org/type": "t"}</code>,
            as <var>preferred values</var> contains <code>"http:/example.org/type"</code>,
            the algorithm returns <code>"t"</code> as the term to use for compaction.</p>
        </aside>

        <aside class="example" data-ignore="" id="example-18-datatyped-term-with-simple-value"><div class="marker">
      <a class="self-link" href="#example-18-datatyped-term-with-simple-value">Example<bdi> 18</bdi></a><span class="example-title">: Datatyped term with simple value</span>
    </div>
          <p>Given the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>{"http://example.org/t": {"@value": "foo"}}</code>,
            The algorithm will be invoked as follows:</p>
          <dl>
            <dt><var>containers</var></dt>
            <dd><code>["@set", "@none", "@index", "@index@set", "@language", "@language@set"]</code></dd>
            <dt><var>type/language</var></dt>
            <dd><code>@language</code></dd>
            <dt><var>preferred values</var></dt>
            <dd><code>["@null", "@none"]</code></dd>
          </dl>
          <p>The <var>value map</var> will be set to <code>{"@none": "t"}</code>,
            as no key in <var>preferred values</var> matches a key in <var>value map</var>,
            the algorithm returns <code>null</code> and no term is found.</p>
        </aside>

        <aside class="example" data-ignore="" id="example-19-datatyped-term-with-object-value"><div class="marker">
      <a class="self-link" href="#example-19-datatyped-term-with-object-value">Example<bdi> 19</bdi></a><span class="example-title">: Datatyped term with object value</span>
    </div>
          <p>Given the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>{"http://example.org/t": {"@id": "http://example.org/id"}}</code>,
            The algorithm will be invoked as follows:</p>
          <dl>
            <dt><var>containers</var></dt>
            <dd><code>["@id", "@id@set", "@type", "@set@type", "@set", "@none", "@index", "@index@set"]</code></dd>
            <dt><var>type/language</var></dt>
            <dd><code>@type</code></dd>
            <dt><var>preferred values</var></dt>
            <dd><code>["@id", "@vocab", "@none"]</code></dd>
          </dl>
          <p>The <var>value map</var> will be set to <code>{"http:/example.org/type": "t"}</code>,
            as no key in <var>preferred values</var> matches a key in <var>value map</var>,
            the algorithm returns <code>null</code> and no term is found.</p>
        </aside>
      </section>
    </section>
  </section> 
</section> 

<section id="expansion-algorithms"><h2 id="x5-expansion-algorithms"><bdi class="secno">5. </bdi>Expansion Algorithms<a class="self-link" aria-label="§" href="#expansion-algorithms"></a></h2>

  <p>The following sections describe algorithms for expanding JSON-LD
    documents, IRIs and values.</p>

  <section id="expansion-algorithm"><h3 id="x5-1-expansion-algorithm"><bdi class="secno">5.1 </bdi>Expansion Algorithm<a class="self-link" aria-label="§" href="#expansion-algorithm"></a></h3>

    <p>This algorithm expands a JSON-LD document, such that all <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>
      definitions are removed, all <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> and
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a> are expanded to
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>,
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>, or
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> and all
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD values</a> are expressed in
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a> in <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a>.</p>

    <section class="informative" id="overview-3">
      <h4 id="x5-1-1-overview"><bdi class="secno">5.1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-3"></a></h4><p><em>This section is non-normative.</em></p>

      <p>Starting with its root <var>element</var>, we can process the
        JSON-LD document recursively, until we have a fully
        <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expanded</a> <var>result</var>. When
        <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expanding</a> an <var>element</var>, we can treat
        each one differently according to its type, in order to break down the
        problem:</p>

      <ol>
        <li>If the <var>element</var> is <code>null</code>, there is nothing
          to expand.</li>
        <li>Otherwise, if <var>element</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a>, we expand it
          according to the <a href="#value-expansion">Value Expansion algorithm</a>.</li>
        <li>Otherwise, if the <var>element</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, then we expand
          each of its items recursively and return them in a new
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
        <li>Otherwise, <var>element</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. We expand
          each of its <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>, adding them to our <var>result</var>, and then we expand
          each value for each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> recursively. Some of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> keys will be
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> or
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a> and others will be
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> or simply ignored because
          they do not have definitions in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>. Any
          <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> will be expanded using the
          <a href="#iri-expansion"><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion algorithm</a>.
        </li>
      </ol>

      <p>Finally, after ensuring <var>result</var> is in an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
        we return <var>result</var>.</p>
    </section>

    <section class="algorithm" id="algorithm-3">
      <h4 id="x5-1-2-algorithm"><bdi class="secno">5.1.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-3"></a></h4>

      <p>The algorithm takes four required <span class="changed">and three optional</span> input variables.
        The required inputs are an <var>active context</var>,
        an <var>active property</var>, an <var>element</var> to be expanded,
        <span class="changed">and a <var>base URL</var> associated with the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a> of the original
          document to expand</span>.
        <span class="changed">The optional inputs are the
          <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
          flag allowing special forms of input used for <a href="https://www.w3.org/TR/json-ld11-framing/#dfn-framing">frame expansion</a>,
          the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flag, used to order
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> keys lexicographically, where noted,
          and the <var>from map</var> flag, used to control reverting
          previous <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> associated with non-propagated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">contexts</a>.
          If not passed, the optional flags are set to <code>false</code></span>.</p>

      <p class="changed">The algorithm also performs processing steps specific to expanding
        a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11-framing/#dfn-frame">JSON-LD Frame</a>. For a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11-framing/#dfn-frame">frame</a>, the <code>@id</code> and
        <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> can accept an array of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> or
        an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> can also
        accept an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>, or an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.
        Framing also uses additional keyword <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>:
        (<code>@explicit</code>, <code>@default</code>,
        <code>@embed</code>, <code>@explicit</code>, <code>@omitDefault</code>, or
        <code>@requireAll</code>) which are preserved through expansion.
        Special processing for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11-framing/#dfn-frame">JSON-LD Frame</a> is invoked when the
        <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set to <code>true</code>.</p>

      <div class="note" role="note" id="issue-container-generatedID-12"><div role="heading" class="note-title marker" id="h-note-12" aria-level="5"><span>Note</span></div><p class="">As mentioned in <a href="https://www.w3.org/TR/json-ld11/#terms">Terms</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>],
        to avoid forward-compatibility issues, <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> should not start with an
        <code>@</code> character as future versions of JSON-LD may introduce
        additional <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a>.
        This algorithm will treat such terms like any other term, i.e., they are ignored unless mapped to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
        Implementations of this algorithm may consider providing a
        runtime flag to show a warning if such terms are encountered.</p></div>

      <div class="note" role="note" id="issue-container-generatedID-13"><div role="heading" class="note-title marker" id="h-note-13" aria-level="5"><span>Note</span></div><p class="">The use of empty <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> (<code>""</code>) is not
        allowed as not all programming languages are able to handle empty JSON keys.
        Implementations of this algorithm may consider providing a
        runtime flag to show a warning if such terms are encountered.</p></div>

      <div class="note" role="note" id="issue-container-generatedID-14"><div role="heading" class="note-title marker" id="h-note-14" aria-level="5"><span>Note</span></div><p class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
        and may be removed in a future version of JSON-LD.
        Implementations of this algorithm may consider providing a
        runtime flag to show a warning if such terms are encountered.</p></div>

        <ol>
        <li>If <var>element</var> is <code>null</code>, return <code>null</code>.</li>
        <li class="changed">If <var>active property</var> is <code>@default</code>,
          initialize the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag to <code>false</code>.</li>
        <li class="changed">If <var>active property</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>active context</var>
          with a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>, initialize <var>property-scoped context</var> to that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>.</li>
        <li>If <var>element</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a>,
          <ol>
            <li>If <var>active property</var> is <code>null</code> or <code>@graph</code>,
              drop the free-floating <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a> by returning <code>null</code>.</li>
            <li class="changed">If <var>property-scoped context</var> is defined,
              set <var>active context</var> to the result of the
              <a href="#context-processing-algorithm">Context Processing algorithm</a>,
              passing <var>active context</var>, <var>property-scoped context</var> as <var>local context</var>,
              and <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>active property</var>
              in <var>active context</var>.</li>
            <li>Return the result of the
              <a href="#value-expansion">Value Expansion algorithm</a>, passing the
              <var>active context</var>, <var>active property</var>, and
              <var>element</var> as <var>value</var>.</li>
          </ol>
        </li>
        <li>If <var>element</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
          <ol>
            <li>Initialize an empty array, <var>result</var>.</li>
            <li>For each <var>item</var> in <var>element</var>:
              <ol>
                <li>Initialize <var>expanded item</var> to the result of using this
                  algorithm recursively, passing <var>active context</var>,
                  <var>active property</var>, <var>item</var> as <var>element</var>,
                  <var class="changed">base URL</var>,
                  <span class="changed">the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                    <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a></span>,
                    and <var>from map</var> flags.</li>
                <li class="changed">If the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
                  of <var>active property</var> includes <code>@list</code>,
                  and <var>expanded item</var> is an
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, set <var>expanded item</var> to a new
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                  <code>@list</code> where the value is the original
                  <var>expanded item</var>.</li>
                <li>If <var>expanded item</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, append each
                  of its items to <var>result</var>. Otherwise, if
                  <var>expanded item</var> is not null, append it to <var>result</var>.</li>
              </ol>
            </li>
            <li>Return <var>result</var>.</li>
          </ol>
        </li>
        <li>Otherwise <var>element</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li id="alg-expand-prev-context" class="changed">If <var>active context</var> has a <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a>,
          the <var>active context</var> is not propagated.
          If <var>from map</var> is undefined or <code>false</code>,
          and <var>element</var> does not contain an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> expanding to <code>@value</code>,
          and <var>element</var> does not consist of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> expanding to <code>@id</code>
          (where <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> are <span class="changed"><a data-lt="IRI expanding" href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanded</a></span>,
          set <var>active context</var> to <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a> from <var>active context</var>,
          as the scope of a term-scoped <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> does not apply when processing new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.</li>
        <li id="alg-expand-property-scoped-context" class="changed">If <var>property-scoped context</var> is defined,
          set <var>active context</var> to the result of the
          <a href="#context-processing-algorithm">Context Processing algorithm</a>,
          passing <var>active context</var>, <var>property-scoped context</var> as <var>local context</var>,
          <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>active property</var>,
          in <var>active context</var>
          and <code>true</code> for <var>override protected</var>.</li>
        <li>If <var>element</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@context</code>, set
          <var>active context</var> to the result of the
          <a href="#context-processing-algorithm">Context Processing algorithm</a>,
          passing <var>active context</var>, the value of the
          <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> as <var>local context</var>
          <span class="changed">and <var>base URL</var></span>.</li>
        <li class="changed">Initialize <var>type-scoped context</var> to <var>active context</var>.
          This is used for expanding values that may be relevant to any previous
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-scoped-context">type-scoped context</a>.</li>
        <li class="changed">For each <var>key</var> and <var>value</var> in <var>element</var>
          ordered lexicographically by <var>key</var>
          where <var>key</var> <span class="changed"><a data-lt="IRI expanding" href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expands</a></span> to <code>@type</code>:
          <ol>
            <li>Convert <var>value</var> into an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, if necessary.</li>
            <li id="expand-type-scoped-context">For each <var>term</var> which is a value of <var>value</var> ordered lexicographically,
              if <var>term</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
              and <var>term</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>type-scoped context</var>
              has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>, set <var>active context</var> to the result
              <a href="#context-processing-algorithm">Context Processing algorithm</a>,
              passing <var>active context</var>,
              the value of the
              <var>term</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> as <var>local context</var>,
              <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>value</var>
              in <var>active context</var>,
              and <code>false</code> for <var>propagate</var>.</li>
          </ol>
        </li>
        <li id="alg-expand-initialize-vars">Initialize two empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>, <var>result</var>
          <span class="changed">and <var>nests</var>.
            Initialize <var>input type</var> to expansion of the last value of the first <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>element</var>
            expanding to <code>@type</code> (if any), ordering <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> lexicographically by key</span>.
            Both the key and value of the matched entry are
            <span class="changed"><a data-lt="IRI expanding" href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanded</a></span>.
        </li>
        <li id="alg-expand-each-key-value">
          For each <var>key</var> and <var>value</var> in <var>element</var>,
          ordered lexicographically by <var>key</var> <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>:
          <ol>
            <li>If <var>key</var> is <code>@context</code>, continue to
              the next <var>key</var>.</li>
            <li>Initialize <var>expanded property</var> to the result of
              <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>key</var>.</li>
            <li>If <var>expanded property</var> is <code>null</code> or it neither
              contains a colon (<code>:</code>) nor it is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>,
              drop <var>key</var> by continuing to the next <var>key</var>.</li>
            <li>If <var>expanded property</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>:
              <ol>
                <li>If <var>active property</var> equals <code>@reverse</code>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-reverse-property-map" class="internalDFN" data-link-type="idl"><code>invalid reverse property map</code></a>
                  error has been detected and processing is aborted.</li>
                <li>If <var>result</var> already has an <var>expanded property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  <span class="changed">other than <code>@included</code> or <code>@type</code>
                  (unless <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>)</span>,
                  a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-colliding-keywords" class="internalDFN" data-link-type="idl"><code>colliding keywords</code></a>
                  error has been detected and processing is aborted.</li>
                <li>If <var>expanded property</var> is <code>@id</code>:
                  <ol>
                    <li>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@id-value" class="internalDFN" data-link-type="idl"><code>invalid @id value</code></a>
                      error has been detected and processing is aborted.
                      <span class="changed">
                        When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>value</var>
                        <em class="rfc2119" title="MAY">MAY</em> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one
                        or more <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>.</span></li>
                    <li>Otherwise,
                      set <var>expanded value</var> to the result of
                      <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>value</var>
                      using <code>true</code> for <var>document relative</var>
                      and <code>false</code> for <var>vocab</var>.
                      <span class="changed">
                        When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>expanded value</var> will be
                        an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one or more of the values, with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>
                        values expanded using the <a href="#iri-expansion"><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion algorithm</a> as above.</span></li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@type</code>:
                  <ol>
                    <li>If <var>value</var>
                      is neither a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> nor an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-value" class="internalDFN" data-link-type="idl"><code>invalid type value</code></a>
                      error has been detected and processing is aborted.
                      <span class="changed">
                        When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>value</var>
                        <em class="rfc2119" title="MAY">MAY</em> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-object">default object</a>
                        where the value of <code>@default</code> is restricted to be
                        an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
                        All other values mean that <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-type-value" class="internalDFN" data-link-type="idl"><code>invalid type value</code></a>
                        error has been detected and processing is aborted.</span></li>
                    <li class="changed">If <var>value</var>
                      is an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, set <var>expanded value</var> to <var>value</var>.</li>
                    <li class="changed">Otherwise, if <var>value</var>
                      is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-object">default object</a>, set <var>expanded value</var> to
                      a new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-object">default object</a> with the value of <code>@default</code> set
                      to the result of
                      <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>value</var>
                      using <var class="changed">type-scoped context</var> for <var>active context</var>,
                      and <code>true</code> for <var>document relative</var>.</li>
                    <li id="expansion-tsc">Otherwise,
                      set <var>expanded value</var> to the result of
                      <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span>
                      each of its values
                      using <var class="changed">type-scoped context</var> for <var>active context</var>,
                      and <code>true</code> for <var>document relative</var>.
                    </li>
                    <li><span class="changed">If <var>result</var> already has an entry for <code>@type</code>,
                      prepend the value of <code>@type</code> in <var>result</var> to <var>expanded value</var>,
                      transforming it into an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, if necessary.</span>
                      <div class="note" role="note" id="issue-container-generatedID-15"><div role="heading" class="note-title marker" id="h-note-15" aria-level="5"><span>Note</span></div><div class="">
                        No transformation from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> <var>value</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                        <var>expanded value</var> is implied, and the form or <var>value</var>
                        should be preserved in <var>expanded value</var>.
                      </div></div></li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@graph</code>, set
                  <var>expanded value</var> to the result of using this algorithm
                  recursively passing <var>active context</var>, <code>@graph</code>
                  for <var>active property</var>, <var>value</var> for <var>element</var>,
                  <var class="changed">base URL</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>,
                  <span class="changed">
                    ensuring that <var>expanded value</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one or more <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a></span>.</li>
                <li class="changed">If <var>expanded property</var> is <code>@included</code>:
                  <ol>
                    <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                      continue with the next <var>key</var> from <var>element</var>.</li>
                    <li>Set <var>expanded value</var> to the result of using
                      this algorithm recursively passing <var>active context</var>,
                      <var>active property</var>, <var>value</var> for <var>element</var>,
                      <var>base URL</var>,
                      and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                      and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags,
                      ensuring that the result is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                    <li>If any element of <var>expanded value</var> is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@included-value" class="internalDFN" data-link-type="idl"><code>invalid @included value</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>If <var>result</var> already has an entry for <code>@included</code>,
                      prepend the value of <code>@included</code> in <var>result</var> to <var>expanded value</var>.</li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@value</code>:
                  <ol>
                    <li id="alg-expand-type-json" class="changed">If
                      <var>input type</var> is <code>@json</code>,
                      set <var>expanded value</var> to <var>value</var>.
                      If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-value-object-value" class="internalDFN" data-link-type="idl"><code>invalid value object value</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>Otherwise, if <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a> or <code>null</code>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-value-object-value" class="internalDFN" data-link-type="idl"><code>invalid value object value</code></a>
                      error has been detected and processing is aborted.
                      <span class="changed">When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>value</var>
                      <em class="rfc2119" title="MAY">MAY</em> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> or an array of
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a> values.</span></li>
                    <li>Otherwise, set <var>expanded value</var> to <var>value</var>.
                      <span class="changed">When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set,
                      <var>expanded value</var> will be an
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one or more <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> values
                      or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</span>
                    </li>
                    <li>If <var>expanded value</var>
                      is <code>null</code>, set the <code>@value</code>
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>result</var> to <code>null</code> and continue with the
                      next <var>key</var> from <var>element</var>. Null values need to be preserved
                      in this case as the meaning of an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> depends
                      on the existence of an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@language</code>:
                  <ol>
                    <li>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-language-tagged-string" class="internalDFN" data-link-type="idl"><code>invalid language-tagged string</code></a>
                      error has been detected and processing is aborted.
                      <span class="changed">When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>value</var>
                        <em class="rfc2119" title="MAY">MAY</em> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> or an array of zero or more
                        <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a></span>.</li>
                    <li><span class="changed">
                      Otherwise, set <var>expanded value</var> to <var>value</var>.
                      If <var>value</var> is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> according to
                      <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>],
                      processors <em class="rfc2119" title="SHOULD">SHOULD</em> issue a warning.
                      When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set,
                       <var>expanded value</var> will be an
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one or more <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> values
                      or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</span>
                      <div class="note" role="note" id="issue-container-generatedID-16"><div role="heading" class="note-title marker" id="h-note-16" aria-level="5"><span>Note</span></div><div class="changed">Processors <em class="rfc2119" title="MAY">MAY</em> normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lower case.</div></div>
                      </li>
                    </ol>
                </li>
                <li class="changed">If <var>expanded property</var> is <code>@direction</code>:
                  <ol>
                    <li>If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is <code>json-ld-1.0</code>,
                      continue with the next <var>key</var> from <var>element</var>.</li>
                    <li>If <var>value</var> is neither <code>"ltr"</code> nor <code>"rtl"</code>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-base-direction" class="internalDFN" data-link-type="idl"><code>invalid base direction</code></a>
                      error has been detected and processing is aborted.
                      When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, <var>value</var>
                      <em class="rfc2119" title="MAY">MAY</em> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> or an array of zero or more
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>.</li>
                    <li>Otherwise, set <var>expanded value</var> to <var>value</var>.
                      When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set,
                      <var>expanded value</var> will be an
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of one or more <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> values
                      or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@index</code>:
                  <ol>
                    <li>If <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@index-value" class="internalDFN" data-link-type="idl"><code>invalid @index value</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>Otherwise,
                      set <var>expanded value</var> to <var>value</var>.</li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@list</code>:
                  <ol>
                    <li>If <var>active property</var> is <code>null</code> or
                      <code>@graph</code>, continue with the next <var>key</var>
                      from <var>element</var> to remove the free-floating list.</li>
                    <li id="alg-expand-list-value">Otherwise, initialize <var>expanded value</var> to the result of using
                      this algorithm recursively passing <var>active context</var>,
                      <var>active property</var>, <var>value</var> for <var>element</var>,
                      <var class="changed">base URL</var>,
                      <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                        and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags,
                        ensuring that the result is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</span>.</li>
                  </ol>
                </li>
                <li>If <var>expanded property</var> is <code>@set</code>, set
                  <var>expanded value</var> to the result of using this algorithm
                  recursively, passing <var>active context</var>,
                  <var>active property</var>, <var>value</var> for <var>element</var>,
                  <var class="changed">base URL</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                <li>If <var>expanded property</var> is <code>@reverse</code>:
                  <ol>
                    <li>If <var>value</var> is not a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@reverse-value" class="internalDFN" data-link-type="idl"><code>invalid @reverse value</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>Otherwise initialize <var>expanded value</var> to the result of using this
                      algorithm recursively, passing <var>active context</var>,
                      <code>@reverse</code> as <var>active property</var>,
                      <var>value</var> as <var>element</var>,
                      <var class="changed">base URL</var>,
                      <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                        and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                    <li>If <var>expanded value</var> contains an <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      i.e., <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> that are reversed twice, execute for each of its
                      <var>property</var> and <var>item</var> the following steps:
                      <ol>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>item</var>
                          to the <var>property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>result</var>
                          using <code>true</code> for <var>as array</var>.</li>
                      </ol>
                    </li>
                    <li>If <var>expanded value</var> contains an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> other than <code>@reverse</code>:
                      <ol>
                        <li class="changed">Set <var>reverse map</var> to the value
                          of the <code>@reverse</code> entry in <var>result</var>,
                          initializing it to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, if necessary.</li>
                        <li>For each <var>property</var> and <var>items</var> in <var>expanded value</var>
                          other than <code>@reverse</code>:
                          <ol>
                            <li>For each <var>item</var> in <var>items</var>:
                              <ol>
                                <li>If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, an
                                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-reverse-property-value" class="internalDFN" data-link-type="idl"><code>invalid reverse property value</code></a>
                                  has been detected and processing is aborted.</li>
                                <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>item</var>
                                  to the <var>property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>reverse map</var>
                                  using <code>true</code> for <var>as array</var>.</li>
                              </ol>
                            </li>
                          </ol>
                        </li>
                      </ol>
                    </li>
                    <li>Continue with the next <var>key</var> from <var>element</var>.</li>
                  </ol>
                </li>
                <li class="changed">If <var>expanded property</var> is <code>@nest</code>,
                  add <var>key</var> to <var>nests</var>, initializing it to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
                  if necessary.
                  Continue with the next <var>key</var> from <var>element</var>.</li>
                <li class="changed">When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set,
                  if <var>expanded property</var> is any other
                  framing keyword (<code>@default</code>,
                  <code>@embed</code>, <code>@explicit</code>, <code>@omitDefault</code>, or
                  <code>@requireAll</code>),
                  set <var>expanded value</var> to the result of performing the
                  <a href="#expansion-algorithm">Expansion Algorithm</a>
                  recursively, passing <var>active context</var>,
                  <var>active property</var>, <var>value</var> for <var>element</var>,
                  <var>base URL</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                <li id="alg-expand-expanded-property-to-result">Unless <var>expanded value</var> is <code>null</code>,
                  <span class="changed"><var>expanded property</var> is <code>@value</code>,
                    and <var>input type</var> is not <code>@json</code>,</span>
                    set the <var>expanded property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>result</var> to
                  <var>expanded value</var>.</li>
                <li>Continue with the next <var>key</var> from <var>element</var>.</li>
              </ol>
            </li>
            <li>Initialize <var>container mapping</var> to <var>key</var>'s <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> in
              <var>active context</var>.</li>
            <li class="changed">If <var>key</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>active context</var>
              has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <code>@json</code>,
              set <var>expanded value</var> to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, set the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              <code>@value</code> to <var>value</var>, and set the entry <code>@type</code> to <code>@json</code>.</li>
            <li>Otherwise, if <var>container mapping</var> <span class="changed">includes</span> <code>@language</code> and
              <var>value</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> then <var>value</var>
              is expanded from a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-language-map">language map</a>
              as follows:
              <ol>
                <li>Initialize <var>expanded value</var> to an empty
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li class="changed">Initialize <var>direction</var> to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a> from <var>active context</var>.</li>
                <li class="changed">If <var>key</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>
                  has a <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a>,
                  update <var>direction</var> with that value.</li>
                <li>For each key-value pair <var>language</var>-<var>language value</var>
                  in <var>value</var>, ordered lexicographically by <var>language</var> <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>:
                  <ol>
                    <li>If <var>language value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                      set <var>language value</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only
                      <var>language value</var>.</li>
                    <li>For each <var>item</var> in <var>language value</var>:
                      <ol>
                        <li class="changed">If <var>item</var> is <code>null</code>,
                          continue to the next entry in <var>language value</var>.</li>
                        <li><var>item</var> must be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
                          otherwise an
                          <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-language-map-value" class="internalDFN" data-link-type="idl"><code>invalid language map value</code></a>
                          error has been detected and processing is aborted.</li>
                        <li>Initialize a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>v</var>
                          consisting of two
                          key-value pairs: (<code>@value</code>-<var>item</var>)
                          and (<code>@language</code>-<var>language</var>).
                          <span class="changed">If <var>item</var> is neither <code>@none</code> nor <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> according to
                            <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>],
                            processors <em class="rfc2119" title="SHOULD">SHOULD</em> issue a warning.</span>
                          <div class="note" role="note" id="issue-container-generatedID-17"><div role="heading" class="note-title marker" id="h-note-17" aria-level="5"><span>Note</span></div><div class="changed">Processors <em class="rfc2119" title="MAY">MAY</em> normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lower case.</div></div>
                        </li>
                        <li class="changed">If <var>language</var> is <code>@none</code>,
                          or expands to <code>@none</code>, remove <code>@language</code> from <var>v</var>.</li>
                        <li class="changed">
                          If <var>direction</var> is not <code>null</code>,
                          add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <code>@direction</code> to <var>v</var> with <var>direction</var>.</li>
                        <li>Append <var>v</var> to <var>expanded value</var>.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>Otherwise, if <var>container mapping</var>
              <span class="changed">includes</span> <code>@index</code>,
              <span class="changed"><code>@type</code>, or <code>@id</code></span> and
              <var>value</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> then <var>value</var>
              is expanded from an map as follows:
              <ol>
                <li>Initialize <var>expanded value</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li class="changed">Initialize <var>index key</var> to
                  the <var>key</var>'s <a href="#dfn-index-mapping" class="internalDFN" data-link-type="dfn">index mapping</a> in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>,
                  or <code>@index</code>, if it does not exist.</li>
                <li>For each key-value pair <var>index</var>-<var>index value</var>
                  in <var>value</var>, ordered lexicographically by <var>index</var>
                  <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>:
                  <ol>
                    <li class="changed">If <var>container mapping</var> includes <code>@id</code> or <code>@type</code>,
                      initialize <var>map context</var> to the <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a>
                      from <var>active context</var> if it exists,
                      otherwise, set <var>map context</var> to <var>active context</var>.</li>
                    <li class="changed">If <var>container mapping</var> includes <code>@type</code>
                      and <var>index</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in
                      <var>map context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>, update
                      <var>map context</var> to the result of the
                      <a href="#context-processing-algorithm">Context Processing algorithm</a>,
                      passing <var>map context</var> as <var>active context</var>
                      the value of the <var>index</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>
                      as <var>local context</var>
                      and <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>index</var>
                      in <var>map context</var>.</li>
                      <li>Otherwise, set <var>map context</var> to <var>active context</var>.</li>
                    <li>Initialize <var>expanded index</var> to the result of
                      <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>index</var>.</li>
                    <li>If <var>index value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                      set <var>index value</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only
                      <var>index value</var>.</li>
                    <li>Initialize <var>index value</var> to the result of
                      using this algorithm recursively, passing
                      <var class="changed">map context</var> as <var>active context</var>,
                      <var>key</var> as <var>active property</var>,
                      <var>index value</var> as <var>element</var>,
                      <var class="changed">base URL</var>,
                      <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                        and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                    <li>For each <var>item</var> in <var>index value</var>:
                      <ol class="algorithm changed">
                        <li id="alg-expand-container-index-graph">If <var>container mapping</var> includes <code>@graph</code>,
                          <span class="changed">and <var>item</var> is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>,</span>
                          set <var>item</var> to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing the key-value pair
                          <code>@graph</code>-<var>item</var>,
                          ensuring that the value is represented using an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                        <li id="alg-expand-container-index-not-index" class="changed">If <var>container mapping</var> includes <code>@index</code>,
                          <var>index key</var> is not <code>@index</code>,
                          and <var>expanded index</var> is not <code>@none</code>:
                          <ol>
                            <li>Initialize <var>re-expanded index</var> to the result of calling
                              the <a href="#value-expansion">Value Expansion algorithm</a>,
                              passing the <var>active context</var>,
                              <var>index key</var> as <var>active property</var>,
                              and <var>index</var> as <var>value</var>.</li>
                            <li>Initialize <var>expanded index key</var> to the result of
                              <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>index key</var>.</li>
                            <li>Initialize <var>index property values</var> to the concatenation of
                              <var>re-expanded index</var> with any existing values of
                              <var>expanded index key</var> in <var>item</var>.</li>
                            <li>Add the key-value pair (<var>expanded index key</var>-<var>index property values</var>)
                              to <var>item</var>.</li>
                            <li>If <var>item</var> is a value object,
                              it <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain any extra properties;
                              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-value-object" class="internalDFN" data-link-type="idl"><code>invalid value object</code></a>
                              error has been detected and processing is aborted.</li>
                          </ol>
                        </li>
                        <li>Otherwise, if <var>container mapping</var> includes <code>@index</code>,
                          <var>item</var> does not have an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@index</code>,
                          and <var>expanded index</var> is not <code>@none</code>,
                          add the key-value pair (<code>@index</code>-<var>index</var>) to <var>item</var>.</li>
                        <li>Otherwise, if <var>container mapping</var> includes <code>@id</code>
                          <var>item</var> does not have the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code>,
                          and <var>expanded index</var> is not <code>@none</code>,
                          add the key-value pair (<code>@id</code>-<var>expanded index</var>) to <var>item</var>,
                          where <var>expanded index</var> is set to the result of
                          <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span><var>index</var>
                          using <code>true</code> for <var>document relative</var>
                          and <code>false</code> for <var>vocab</var>.</li>
                        <li id="alg-expand-container-mapping-type">Otherwise, if <var>container mapping</var> includes <code>@type</code>
                          and <var>expanded index</var> is not <code>@none</code>,
                          initialize <var>types</var> to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                          consisting of <var>expanded index</var> followed by any existing
                          values of <code>@type</code> in <var>item</var>.
                          Add the key-value pair (<code>@type</code>-<var>types</var>) to <var>item</var>.</li>
                        <li>Append <var>item</var> to <var>expanded value</var>.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>Otherwise, initialize <var>expanded value</var> to the result of
              using this algorithm recursively, passing <var>active context</var>,
              <var>key</var> for <var>active property</var>, <var>value</var> for <var>element</var>,
              <var class="changed">base URL</var>,
              <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a>
                and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
            <li>If <var>expanded value</var> is <code>null</code>, ignore <var>key</var>
              by continuing to the next <var>key</var> from <var>element</var>.</li>
            <li>If <var>container mapping</var> <span class="changed">includes</span> <code>@list</code> and
              <var>expanded value</var> is not already a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>,
              convert <var>expanded value</var> to a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>
              by first setting it to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only
              <var>expanded value</var> if it is not already an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
              and then by setting it to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing
              the key-value pair <code>@list</code>-<var>expanded value</var>.</li>
            <li class="changed">If <var>container mapping</var> <span>includes</span>
              <code>@graph</code>,
              and includes neither <code>@id</code> nor <code>@index</code>,
              convert <var>expanded value</var> into an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, if necessary,
              then convert each value <var>ev</var> in <var>expanded value</var> into a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>:
              <ol>
                <li>Convert <var>ev</var> into
                  a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a> by creating a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing the key-value
                  pair <code>@graph</code>-<var>ev</var>
                  where <var>ev</var> is represented as an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.
                  <div class="note" role="note" id="issue-container-generatedID-18"><div role="heading" class="note-title marker" id="h-note-18" aria-level="5"><span>Note</span></div><div class="">This may lead to a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a> including another <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>,
                    if <var>ev</var> was already in the form of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>.</div></div></li>
              </ol>
            </li>
            <li>If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> associated to
              <var>key</var> indicates that it is a <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a>
              <ol>
                <li>If <var>result</var> has no <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create
                  one and initialize its value to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                <li>Reference the value of the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>result</var>
                  using the variable <var>reverse map</var>.</li>
                <li>If <var>expanded value</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, set
                  it to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing <var>expanded value</var>.</li>
                <li>For each <var>item</var> in <var>expanded value</var>
                  <ol>
                    <li>If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-reverse-property-value" class="internalDFN" data-link-type="idl"><code>invalid reverse property value</code></a>
                      has been detected and processing is aborted.</li>
                    <li>If <var>reverse map</var> has no <var>expanded property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      create one and initialize its value to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                    <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>item</var>
                      to the <var>expanded property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>reverse map</var>
                      using <code>true</code> for <var>as array</var>.</li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>Otherwise, <var>key</var> is not a <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a>
              <span class="changed">use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>expanded value</var>
                to the <var>expanded property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>result</var>
                using <code>true</code> for <var>as array</var>.</span>
            </li>
          </ol>
        </li>
        <li id="alg-expand-resolve-nest" class="changed">For each key <var>nesting-key</var> in <var>nests</var>,
          ordered lexicographically if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code>:
          <ol>
            <li>Initialize <var>nested values</var> to the value of <var>nesting-key</var>
              in <var>element</var>, ensuring that it is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
            <li>For each <var>nested value</var> in <var>nested values</var>:
              <ol>
                <li>If <var>nested value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, or any key within
                  <var>nested value</var> expands to <code>@value</code>, an
                  <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@nest-value" class="internalDFN" data-link-type="idl"><code>invalid @nest value</code></a> error
                  has been detected and processing is aborted.</li>
                <li>Recursively repeat steps <a href="#alg-expand-each-key-value">13</a>
                  and <a href="#alg-expand-resolve-nest">14</a>
                  using <var>nested value</var> for <var>element</var>.
                  <div class="note" role="note" id="issue-container-generatedID-19"><div role="heading" class="note-title marker" id="h-note-19" aria-level="5"><span>Note</span></div><div class="">By invoking steps <a href="#alg-expand-each-key-value">13</a>
                    and <a href="#alg-expand-resolve-nest">14</a> on <var>nested value</var>
                    we are able to unfold arbitrary levels of nesting, with results being merged into
                    <var>result</var>.
                    Step <a href="#alg-expand-each-key-value">13</a> iterates through each
                    entry in <var>nested value</var> and expands it, while collecting new
                    <var>nested values</var> found at each level, until all nesting has been extracted.</div></div>
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li>If <var>result</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@value</code>:
          <ol>
            <li>The <var>result</var> must not contain any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> other than
              <code class="changed">@direction</code>,
              <code>@index</code>,
              <code>@language</code>,
              <code>@type</code>,
              and <code>@value</code>.
              It must not contain an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> if it contains either <code>@language</code> or <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>.
              Otherwise, an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-value-object" class="internalDFN" data-link-type="idl"><code>invalid value object</code></a>
              error has been detected and processing is aborted.</li>
            <li class="changed">If the <var>result</var>'s <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              is <code>@json</code>, then the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> may
              contain any value, and is treated as a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a>.</li>
            <li id="alg-expand-null-value">Otherwise, if the value of <var>result</var>'s <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is
              <code>null</code>, or an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, return <code>null</code>.</li>
            <li>Otherwise, if the value of <var>result</var>'s <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> and <var>result</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              <code>@language</code>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-language-tagged-value" class="internalDFN" data-link-type="idl"><code>invalid language-tagged value</code></a>
              error has been detected (only <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>
              can be language-tagged) and processing is aborted.</li>
            <li>Otherwise, if the <var>result</var> has an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              and its value is not an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-typed-value" class="internalDFN" data-link-type="idl"><code>invalid typed value</code></a>
              error has been detected and processing is aborted.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>result</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@type</code>
          and its associated value is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, set it to
          an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only the associated value.</li>
        <li>Otherwise, if <var>result</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@set</code>
          or <code>@list</code>:
          <ol>
            <li>The <var>result</var> must contain at most one other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              which must be <code>@index</code>. Otherwise, an
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-set-or-list-object" class="internalDFN" data-link-type="idl"><code>invalid set or list object</code></a>
              error has been detected and processing is aborted.</li>
            <li>If <var>result</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@set</code>, then
              set <var>result</var> to the <a data-lt="entry" data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry's</a> associated value.</li>
          </ol>
        </li>
        <li id="alg-expand-only-language">If <var>result</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that contains only the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          <code>@language</code>, <span class="changed">return</span> <code>null</code>.</li>
        <li>If <var>active property</var> is <code>null</code> or <code>@graph</code>,
          drop free-floating values as follows:
          <ol>
            <li>If <var>result</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> which is empty,
              or contains only the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> <code>@value</code> or <code>@list</code>,
              set <var>result</var> to <code>null</code>.</li>
            <li>Otherwise, if <var>result</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> whose only
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is <code>@id</code>, set <var>result</var> to <code>null</code>.
              <span class="changed">
                When the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag is set, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
                containing only the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is retained.</span></li>
          </ol>
        </li>
        <li id="alg-expand-return">Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="iri-expansion"><h3 id="x5-2-iri-expansion"><bdi class="secno">5.2 </bdi><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion<a class="self-link" aria-label="§" href="#iri-expansion"></a></h3>

    <p>In JSON-LD documents, some keys and values may represent
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>. This section defines an algorithm for
      transforming a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> that represents an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> into
      an absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.
      It also covers transforming <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword aliases</a>
      into <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a>.</p>

    <p><a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> expansion may occur during context processing or during
      any of the other JSON-LD algorithms. If <abbr title="Internationalized Resource Identifier">IRI</abbr> expansion occurs during context
      processing, then the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> and its related <var>defined</var>
      map from the <a href="#context-processing-algorithm">Context Processing algorithm</a>
      are passed to this algorithm. This allows for <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
      dependencies to be processed via the
      <a href="#create-term-definition">Create Term Definition algorithm</a>.</p>

    <section class="informative" id="overview-4">
      <h4 id="x5-2-1-overview"><bdi class="secno">5.2.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-4"></a></h4><p><em>This section is non-normative.</em></p>

      <p>In order to expand <var>value</var> to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, we must
        first determine if it is <code>null</code>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, a
        <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword alias</a>, or some form of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>. Based on what
        we find, we handle the specific kind of expansion; for example, we expand
        a <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword alias</a> to a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> and a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
        to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> according to its <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
        in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>. While inspecting <var>value</var> we
        may also find that we need to create <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
        dependencies because we're running this algorithm during context processing.
        We can tell whether or not we're running during context processing by
        checking <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> against <code>null</code>.
        We know we need to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in the
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> when <var>value</var> is
        an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> and the <var>defined</var> map
        does not have an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <var>value</var> with an associated value of
        <code>true</code>. The <var>defined</var> map is used during
        <a href="#context-processing-algorithm">Context Processing</a> to keep track of
        which <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> have already been defined or are
        in the process of being defined. We create a
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> by using the
        <a href="#create-term-definition">Create Term Definition algorithm</a>.</p>

      <div class="note" role="note" id="issue-container-generatedID-20"><div role="heading" class="note-title marker" id="h-note-20" aria-level="5"><span>Note</span></div><p class="changed">Values that have the form of a keyword,
        but are not keywords (i.e., they begin with <code>"@"</code>) do not
        map to any value, as they are reserved for future use.
        The algorithm returns <code>null</code>, so that they will be ignored when encountered.</p></div>
    </section>

    <section class="algorithm" id="algorithm-4">
      <h4 id="x5-2-2-algorithm"><bdi class="secno">5.2.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-4"></a></h4>

      <p>The algorithm takes two required and four optional input variables. The
        required inputs are an <var>active context</var> and a <var>value</var>
        to be expanded. The optional inputs are two flags,
        <var>document relative</var> and <var>vocab</var>, that specifying
        whether <var>value</var> can be interpreted as a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a>
        against the document's base <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or the
        <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a>
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>, respectively, and
        a <var>local context</var> and a map <var>defined</var> to be used when
        this algorithm is used during <a href="#context-processing-algorithm">Context Processing</a>.
        If not passed, the two flags are set to <code>false</code> and
        <var>local context</var> and <var>defined</var> are initialized to <code>null</code>.</p>

      <ol>
        <li>If <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> or <code>null</code>,
          return <var>value</var> as is.</li>
        <li class="changed">
          If <var>value</var> has the form of a keyword
          (i.e., it matches the ABNF rule <code>"@"1*ALPHA</code> from [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">RFC5234</a></cite>]),
          a processor <em class="rfc2119" title="SHOULD">SHOULD</em> generate a warning and return <code>null</code>.</li>
        <li>If <var>local context</var> is not <code>null</code>, it contains
          an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> with a key that equals <var>value</var>, and the value of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          for <var>value</var> in <var>defined</var> is not <code>true</code>,
          invoke the <a href="#create-term-definition">Create Term Definition algorithm</a>,
          passing <var>active context</var>, <var>local context</var>,
          <var>value</var> as <var>term</var>, and <var>defined</var>. This will ensure that
          a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> is created for <var>value</var> in
          <var>active context</var> during <a href="#context-processing-algorithm">Context Processing</a>.
        </li>
        <li class="changed">If <var>active context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for
          <var>value</var>, and the associated <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>,
          return that <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>.</li>
        <li>If <var>vocab</var> is <code>true</code> and the
          <var>active context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for
          <var>value</var>, return the associated <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>.</li>
        <li>If <var>value</var> contains a colon (<code>:</code>)
          <span class="changed">anywhere after the first character</span>,
          it is either
          an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, or a
          <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>:
          <ol>
            <li>Split <var>value</var> into a <var>prefix</var> and <var>suffix</var>
              at the first occurrence of a colon (<code>:</code>).</li>
            <li>If <var>prefix</var> is underscore (<code>_</code>)
              or <var>suffix</var> begins with double-forward-slash
              (<code>//</code>), return <var>value</var> as it is already an
              <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</li>
            <li>If <var>local context</var> is not <code>null</code>, it
              contains a <var>prefix</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, and the value
              of the <var>prefix</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>defined</var>
              is not <code>true</code>, invoke the
              <a href="#create-term-definition">Create Term Definition algorithm</a>,
              passing <var>active context</var>,
              <var>local context</var>, <var>prefix</var> as <var>term</var>,
              and <var>defined</var>. This will ensure that a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> is created for <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a>
              in <var>active context</var> during
              <a href="#context-processing-algorithm">Context Processing</a>.</li>
            <li>If <var>active context</var> contains a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
              for <var>prefix</var>
              <span class="changed">having a non-<code>null</code> <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
                and the <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> is <code>true</code></span>,
              return the result of concatenating the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
              associated with <var>prefix</var> and <var>suffix</var>.</li>
            <li><span class="changed">If <var>value</var> has the <a href="https://tools.ietf.org/html/rfc3987#section-2.2">form</a> of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a></span>,
              return <var>value</var>.</li>
          </ol>
        </li>
        <li>If <var>vocab</var> is <code>true</code>, and
          <var>active context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>,
          return the result of concatenating the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>
          with <var>value</var>.</li>
        <li>Otherwise, if <var>document relative</var> is <code>true</code>
          set <var>value</var> to the result of resolving <var>value</var> against
          the <a class="changed internalDFN" data-lt="context-base-iri" href="#dfn-context-base-iri" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> from <var>active context</var>. Only the basic algorithm in
          <a href="https://tools.ietf.org/html/rfc3986#section-5.2">section 5.2</a>
          of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986</a></cite>] is used; neither
          <a href="https://tools.ietf.org/html/rfc3986#section-6.2.2">Syntax-Based Normalization</a> nor
          <a href="https://tools.ietf.org/html/rfc3986#section-6.2.3">Scheme-Based Normalization</a>
          are performed. Characters additionally allowed in <abbr title="Internationalized Resource Identifier">IRI</abbr> references are treated
          in the same way that unreserved characters are treated in URI references, per
          <a href="https://tools.ietf.org/html/rfc3987#section-6.5">section 6.5</a>
          of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3987" title="Internationalized Resource Identifiers (IRIs)">RFC3987</a></cite>].</li>
        <li>Return <var>value</var> as is.</li>
      </ol>
    </section>
  </section> 

  <section id="value-expansion"><h3 id="x5-3-value-expansion"><bdi class="secno">5.3 </bdi>Value Expansion<a class="self-link" aria-label="§" href="#value-expansion"></a></h3>

    <p>Some values in JSON-LD can be expressed in a
      <a href="#dfn-compact-form" class="internalDFN" data-link-type="dfn">compact form</a>. These values are required
      to be <a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">expanded</a> at times when processing
      JSON-LD documents. A value is said to be in <dfn data-dfn-type="dfn" id="dfn-expanded-form">expanded form</dfn>
      after the application of this algorithm.</p>

    <section class="informative" id="overview-5">
      <h4 id="x5-3-1-overview"><bdi class="secno">5.3.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-5"></a></h4><p><em>This section is non-normative.</em></p>

      <p>If <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> in the
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> set to <code>@id</code> or <code>@vocab</code>,
        <span class="changed">and the value is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,</span>
        a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose
        value is the result of using the
        <a href="#iri-expansion"><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion algorithm</a> on <var>value</var>
        is returned.</p>

      <p>Otherwise, the result will be a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing
        an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose value is the passed <var>value</var>.
        Additionally, an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> will be included if there is a
        <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> associated with the <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a>
        or an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> if <var>value</var> is a
        <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> and there is <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> associated
        with the <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a>.</p>

      <p>Note that values interpreted as <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> fall into two categories:
        those that are <var>document relative</var>, and those that are
        <em>vocabulary relative</em>. <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">Properties</a> and values of <code>@type</code>,
        along with terms marked as <code>"@type": "@vocab"</code>
        are <em>vocabulary relative</em>, meaning that they need to be either
        a defined <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        where the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>,
        or a string which is turned into an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> using
        the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-5">
      <h4 id="x5-3-2-algorithm"><bdi class="secno">5.3.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-5"></a></h4>

      <p>The algorithm takes three required inputs: an <var>active context</var>,
        an <var>active property</var>, and a <var>value</var> to expand.</p>

      <ol>
        <li>If the <var>active property</var> has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>
          in <var>active context</var> that is <code>@id</code>,
          <span class="changed">and the <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,</span>
          return a new
          <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> where the
          key is <code>@id</code> and the value is the result
          <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>value</var>
          using <code>true</code> for <var>document relative</var>
          and <code>false</code> for <var>vocab</var>.</li>
        <li>If <var>active property</var> has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> in
          <var>active context</var> that is <code>@vocab</code>,
          <span class="changed">and the <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,</span>
          return a new
          <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> where the
          key is <code>@id</code> and the value is the result of
          <span class="changed"><a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a></span> <var>value</var>
          using <code>true</code> for <var>document relative</var>.</li>
        <li>Otherwise, initialize <var>result</var> to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
          with an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose value is set to
          <var>value</var>.</li>
        <li>If <var>active property</var> has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> in
          <var>active context</var>,
          <span class="changed">other than <code>@id</code>, <code>@vocab</code>, or <code>@none</code>,</span>
          add <code>@type</code> to
          <var>result</var> and set its value to the value associated with the
          <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>.</li>
        <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>:
          <ol>
            <li>Initialize <var>language</var> to the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> for <var>active property</var>
              in <var>active context</var>, if any, otherwise to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>
              of <var>active context</var>.</li>
            <li class="changed">Initialize <var>direction</var> to the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> for <var>active property</var>
              in <var>active context</var>, if any, otherwise to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>
              of <var>active context</var>.</li>
            <li>If <var>language</var> is not <code>null</code>,
              add <code>@language</code> to <var>result</var> with the value <var>language</var>.</li>
            <li class="changed">If <var>direction</var> is not <code>null</code>,
              add <code>@direction</code> to <var>result</var> with the value <var>direction</var>.</li>
          </ol>
        </li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

</section> 


<section id="compaction-algorithms"><h2 id="x6-compaction-algorithms"><bdi class="secno">6. </bdi>Compaction Algorithms<a class="self-link" aria-label="§" href="#compaction-algorithms"></a></h2>

  <p>The following sections describe algorithms for compacting JSON-LD
    documents, IRIs and values.</p>

  <section id="compaction-algorithm"><h3 id="x6-1-compaction-algorithm"><bdi class="secno">6.1 </bdi>Compaction Algorithm<a class="self-link" aria-label="§" href="#compaction-algorithm"></a></h3>

    <p>This algorithm compacts a JSON-LD document, such that the given
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> is applied. This must result in shortening
      any applicable <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> to
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> or
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a>, any applicable
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> to
      <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword aliases</a>, and
      any applicable <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD values</a>
      expressed in <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a> to simple values such as
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a> or
      <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a>.</p>

    <section class="informative" id="overview-6">
      <h4 id="x6-1-1-overview"><bdi class="secno">6.1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-6"></a></h4><p><em>This section is non-normative.</em></p>

      <p>Starting with its root <var>element</var>, we can process the
        JSON-LD document recursively, until we have a fully
        <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacted</a> <var>result</var>. When
        <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a> an <var>element</var>, we can treat
        each one differently according to its type, in order to break down the
        problem:</p>

      <ol>
        <li>If the <var>element</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a>, it is
          already in <a href="#dfn-compact-form" class="internalDFN" data-link-type="dfn">compacted form</a>, so we simply return it.</li>
        <li>If the <var>element</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, we compact
          each of its items recursively and return them in a new
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
        <li>Otherwise <var>element</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The value
          of each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in element is compacted recursively. Some of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> keys will be
          compacted, using the <a href="#iri-compaction"><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction algorithm</a>,
          to <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">terms</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact IRIs</a>
          and others will be compacted from <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> to
          <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword aliases</a> or simply left
          unchanged because they do not have definitions in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>.
          Values will be converted to <a href="#dfn-compact-form" class="internalDFN" data-link-type="dfn">compacted form</a> via the
          <a href="#value-compaction">Value Compaction algorithm</a>. Some data
          will be reshaped based on <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
          specified in the context such as <code>@index</code> or <code>@language</code>
          maps.</li>
      </ol>
    </section>

    <section class="algorithm" id="algorithm-6">
      <h4 id="x6-1-2-algorithm"><bdi class="secno">6.1.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-6"></a></h4>

      <p>The algorithm takes <span class="changed">four required and two optional</span> input variables.
        The required inputs are an <var>active context</var>,
        an <var>inverse context</var>, an <var>active property</var>,
        and an <var>element</var> to be compacted.
        <span class="changed">The optional inputs are the
          <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a> flag
          and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flag, used to order
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> keys lexicographically, where noted.
          If not passed, both flags are set to <code>false</code></span>.</p>

      <ol>
        <li class="changed">Initialize <var>type-scoped context</var> to <var>active context</var>.
          This is used for compacting values that may be relevant to any previous
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-scoped-context">type-scoped context</a>.</li>
        <li>If <var>element</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a>, it is already in its most
          compact form, so simply return <var>element</var>.</li>
        <li>If <var>element</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>:
          <ol>
            <li>Initialize <var>result</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
            <li>For each <var>item</var> in <var>element</var>:
              <ol>
                <li>Initialize <var>compacted item</var> to the result of using this
                  algorithm recursively, passing <var>active context</var>,
                  <var>inverse context</var>, <var>active property</var>,
                  <var>item</var> for <var>element</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                <li>If <var>compacted item</var> is not <code>null</code>, then append
                  it to <var>result</var>.</li>
              </ol>
            </li>
            <li>If <var>result</var> is empty or contains more than one value,
              or <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a> is <code>false</code>,
              <span class="changed">or <var>active property</var> is either <code>@graph</code> or <code>@set</code>,
              or <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for <var>active property</var> in
              <var>active context</var> includes either <code>@list</code> or <code>@set</code>,</span>
              return <var>result</var>.</li>
            <li>Otherwise, return the value in <var>result</var>.</li>
          </ol>
        </li>
        <li>Otherwise <var>element</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li class="changed">If <var>active context</var> has a <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a>,
          the <var>active context</var> is not propagated.
          If <var>element</var> does not contain an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
          and <var>element</var> does not consist of a single <code>@id</code> entry,
          set <var>active context</var> to <a href="#dfn-previous-context" class="internalDFN" data-link-type="dfn">previous context</a> from <var>active context</var>,
          as the scope of a term-scoped <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> does not apply when processing new <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.</li>
        <li class="changed">If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>active property</var> in <var>active context</var>
          has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>:
          <ol>
            <li>Set <var>active context</var> to the result of the
              <a href="#context-processing-algorithm">Context Processing algorithm</a>,
              passing <var>active context</var>,
              the value of the <var>active property</var>'s <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> as <var>local context</var>,
              <span class="changed">
                <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>active property</var>
                in <var>active context</var>,
                and <code>true</code> for <var>override protected</var></span>.</li>
            <li>Set <var>inverse context</var> using the
              <a href="#inverse-context-creation">Inverse Context Creation algorithm</a>
              using <var>active context</var>.</li>
          </ol>
        </li>
        <li>If <var>element</var> has an <code>@value</code> or <code>@id</code>
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> and the result of using the
          <a href="#value-compaction">Value Compaction algorithm</a>,
          passing <var>active context</var>, <var>inverse context</var>,
          <var>active property</var>, and <var>element</var> as <var>value</var> is
          a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a>,
          <span class="changed">or the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>active property</var>
            has a <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <code>@json</code>,</span>
          return that result.</li>
        <li class="changed">If <var>element</var> is a
          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, and the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for
          <var>active property</var> in <var>active context</var> <span class="changed">includes</span> <code>@list</code>,
          return the result of using this algorithm recursively, passing
          <var>active context</var>, <var>inverse context</var>,
          <var>active property</var>, value of <code>@list</code>
          in <var>element</var> for <var>element</var>,
          <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
            and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
        <li>Initialize <var>inside reverse</var> to <code>true</code> if
          <var>active property</var> equals <code>@reverse</code>,
          otherwise to <code>false</code>.</li>
        <li>Initialize <var>result</var> to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li class="changed">If <var>element</var> has an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
          create a new array <var>compacted types</var> initialized
          by transforming each <var>expanded type</var> of that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          into its compacted form
          <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded type</var></span>.
          Then, for each <var>term</var>
          in <var>compacted types</var> ordered lexicographically:
          <ol>
            <li>If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>term</var> in <var>type-scoped context</var> has a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>:
              <ol>
                <li>Set <var>active context</var> to the result of the
                  <a href="#context-processing-algorithm">Context Processing algorithm</a>,
                  passing <var>active context</var> and the value of <var>term</var>'s
                  <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> in <var>type-scoped context</var> as <var>local context</var>
                  <span class="changed">
                    <var>base URL</var> from the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>term</var>
                    in <var>type-scoped context</var></span>.</li>
                <li>Set <var>inverse context</var> using the
                  <a href="#inverse-context-creation">Inverse Context Creation algorithm</a>
                  using <var>active context</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>For each key <var>expanded property</var> and value <var>expanded value</var>
          in <var>element</var>, ordered lexicographically by <var>expanded property</var>
          <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>:
          <ol>
            <li>If <var>expanded property</var> is <code>@id</code>:
              <ol>
                <li>If <var>expanded value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
                  then initialize <var>compacted value</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded value</var>
                    with <var>vocab</var> set to <code>false</code></span>.</li>
                <li>Initialize <var>alias</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded property</var></span>.</li>
                <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>alias</var> to <var>result</var> whose value is
                  set to <var>compacted value</var> and continue to the next
                  <var>expanded property</var>.</li>
              </ol>
            </li>
            <li>If <var>expanded property</var> is <code>@type</code>:
              <ol>
                <li>If <var>expanded value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>,
                  then initialize <var>compacted value</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded value</var>
                    using <var>type-scoped context</var> for <var>active context</var></span>.</li>
                <li>Otherwise, <var>expanded value</var> must be a
                  <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>:
                  <ol>
                    <li>Initialize <var>compacted value</var> to an empty
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                    <li>For each item <var>expanded type</var> in
                      <var>expanded value</var>:
                      <ol>
                        <li>Set <var>term</var>
                          <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded type</var>
                            using <var>type-scoped context</var> for <var>active context</var></span>.</li>
                        <li>Append <var>term</var>, to <var>compacted value</var>.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
                <li>Initialize <var>alias</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded property</var></span>.</li>
                <li class="changed">Initialize <var>as array</var>
                  to <code>true</code> if the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for <var>alias</var> in the
                  <var>active context</var> includes <code>@set</code>,
                  otherwise to the negation of <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>.</li>
                <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted value</var>
                  to the <var>alias</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>result</var>
                  using <var>as array</var>.</li>
                <li>Continue to the next <var>expanded property</var>.</li>
              </ol>
            </li>
            <li>If <var>expanded property</var> is <code>@reverse</code>:
              <ol>
                <li>Initialize <var>compacted value</var> to the result of using this
                  algorithm recursively, passing <var>active context</var>,
                  <var>inverse context</var>, <code>@reverse</code> for
                  <var>active property</var>, <var>expanded value</var>
                  for <var>element</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                <li>For each <var>property</var> and <var>value</var> in <var>compacted value</var>:
                  <ol>
                    <li>If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>property</var> in the
                      <var>active context</var> indicates that <var>property</var> is
                      a <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a>
                      <ol>
                        <li class="changed">Initialize <var>as array</var>
                          to <code>true</code> if the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for <var>property</var> in the
                          <var>active context</var> includes <code>@set</code>,
                          otherwise the negation of <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>.</li>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>value</var>
                          to the <var>property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>result</var>
                          using <var>as array</var>.</li>
                        <li>Remove the <var>property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from
                          <var>compacted value</var>.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
                <li>If <var>compacted value</var> has some remaining <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>, i.e.,
                  it is not an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>:
                  <ol>
                    <li>Initialize <var>alias</var>
                      <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@reverse</code></span>.</li>
                    <li>Set the value of the <var>alias</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>result</var> to
                      <var>compacted value</var>.</li>
                  </ol>
                </li>
                <li>Continue with the next <var>expanded property</var> from <var>element</var>.</li>
              </ol>
            </li>
            <li class="changed">If <var>expanded property</var> is <code>@preserve</code>
              then:
              <ol>
                <li>Initialize <var>compacted value</var> to the result of using this
                  algorithm recursively, passing
                  <var>active context</var>,
                  <var>inverse context</var>,
                  <var>active property</var>,
                  <var>expanded value</var> for <var>element</var>,
                  <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span>.</li>
                <li>Add <var>compacted value</var> as the value of <code>@preserve</code>
                  in <var>result</var> unless <var>expanded value</var> is an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
              </ol>
            </li>
            <li>If <var>expanded property</var> is <code>@index</code> and
              <var>active property</var> has a <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
              in <var>active context</var> that <span class="changed">includes</span> <code>@index</code>,
              then the compacted result will be inside of an <code>@index</code>
              container, drop the <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> by continuing
              to the next <var>expanded property</var>.</li>
            <li>Otherwise, if <var>expanded property</var> is
              <code class="changed">@direction</code>,
              <code>@index</code>,
              <code>@language</code>,
              or <code>@value</code>:
              <ol>
                <li>Initialize <var>alias</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded property</var></span>.</li>
                <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>alias</var> to <var>result</var> whose value is
                  set to <var>expanded value</var> and continue with the next
                  <var>expanded property</var>.</li>
              </ol>
            </li>
            <li>If <var>expanded value</var> is an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>:
              <ol>
                <li>Initialize <var>item active property</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded property</var>
                    using <var>expanded value</var> for <var>value</var>
                    and <var>inside reverse</var> for <var>reverse</var></span>.</li>
                <li class="changed">If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>item active property</var>
                  in the <var>active context</var> has a <a href="#dfn-nest-value" class="internalDFN" data-link-type="dfn">nest value</a>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> (<var>nest term</var>):
                  <ol>
                    <li>If <var>nest term</var> is not <code>@nest</code>,
                      or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> in the <var>active context</var> that expands to <code>@nest</code>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@nest-value" class="internalDFN" data-link-type="idl"><code>invalid @nest value</code></a>
                      error has been detected, and processing is aborted.</li>
                    <li>If <var>result</var> does not have a <var>nest term</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      initialize it to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                    <li>Initialize <var>nest result</var> to the value of <var>nest term</var> in <var>result</var>.</li>
                  </ol>
                </li>
                <li class="changed">Otherwise, initialize <var>nest result</var> to <var>result</var>.</li>
                <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                  to the <var>item active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>nest result</var>
                  using <code>true</code> for <var>as array</var>.</li>
              </ol>
            </li>
            <li>
              At this point, <var>expanded value</var> must be an
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> due to the
              <a href="#expansion-algorithm">Expansion algorithm</a>.
              For each item <var>expanded item</var> in <var>expanded value</var>:
              <ol>
                <li>Initialize <var>item active property</var>
                  <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <var>expanded property</var>
                    using <var>expanded item</var> for <var>value</var>
                    and <var>inside reverse</var> for <var>reverse</var></span>.</li>
                <li class="changed">If the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> for <var>item active property</var>
                  in the <var>active context</var> has a <a href="#dfn-nest-value" class="internalDFN" data-link-type="dfn">nest value</a>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> (<var>nest term</var>):
                  <ol>
                    <li>If <var>nest term</var> is not <code>@nest</code>,
                      or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> in the <var>active context</var> that expands to <code>@nest</code>,
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-@nest-value" class="internalDFN" data-link-type="idl"><code>invalid @nest value</code></a>
                      error has been detected, and processing is aborted.</li>
                    <li>If <var>result</var> does not have a <var>nest term</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      initialize it to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                    <li>Initialize <var>nest result</var> to the value of <var>nest term</var> in <var>result</var>.</li>
                  </ol>
                </li>
                <li>Otherwise, initialize <var>nest result</var> to <var>result</var>.</li>
                <li>Initialize <var>container</var> to <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for
                  <var>item active property</var> in <var>active context</var>,
                  or to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, if there is no such <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>.</li>
                <li class="changed">Initialize <var>as array</var>
                  to <code>true</code> if <var>container</var> includes <code>@set</code>,
                  or if <var>item active property</var> is <code>@graph</code> or <code>@list</code>,
                  otherwise the negation of <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>.</li>
                <li>Initialize <var>compacted item</var> to the result of using
                  this algorithm recursively, passing
                  <var>active context</var>, <var>inverse context</var>,
                  <var>item active property</var> for <var>active property</var>,
                  <var>expanded item</var> for <var>element</var> if it does
                  not contain the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@list</code>
                  <span class="changed">and is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a> containing <code>@list</code></span>,
                  otherwise pass the value of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <var>element</var>.
                  <span class="changed">Along with the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
                    and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flags</span></li>
                <li>If <var>expanded item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>:
                  <ol>
                    <li>If <var>compacted item</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
                      then set <var>compacted item</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only
                      <var>compacted item</var>.</li>
                    <li>If <var>container</var> does not include <code>@list</code>:
                      <ol>
                        <li>Convert <var>compacted item</var> to a
                          <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a> by setting it to a
                          <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                          where the key is the result of
                          <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@list</code></span>
                          and the value is the original <var>compacted item</var>.</li>
                        <li>If <var>expanded item</var> contains the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                          <code>@index</code>-<var>value</var>, then add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                          to <var>compacted item</var> where the key is the
                          result of
                          <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@index</code></span>
                          and value is <var>value</var>.</li>
                        <li>Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                          to the <var>item active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in
                          <var>nest result</var>
                          using <var>as array</var>.</li>
                      </ol>
                    </li>
                    <li class="changed">Otherwise, set the value of the <var>item active property</var> entry
                      in <var>nest result</var> to <var>compacted item</var>.</li>
                  </ol>
                </li>
                <li class="changed">If <var>expanded item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>:
                  <ol>
                    <li>If <var>container</var> includes <code>@graph</code> and <code>@id</code>:
                      <ol>
                        <li>Initialize <var>map object</var> to the value of <var>item active property</var>
                          in <var>nest result</var>,
                          initializing it to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, if necessary.</li>
                        <li>Initialize <var>map key</var>
                          <span class="changed">by <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a>
                            the value of <code>@id</code> in <var>expanded item</var>
                            or <code>@none</code> if no such value exists
                            with <var>vocab</var> set to <code>false</code>
                            if there is an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>expanded item</var></span>.</li>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                          to the <var>map key</var> entry in <var>map object</var>
                          using <var>as array</var>.</li>
                      </ol>
                    </li>
                    <li>Otherwise, if <var>container</var> includes <code>@graph</code> and <code>@index</code>
                      and <var>expanded item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-simple-graph-object">simple graph object</a>:
                      <ol>
                        <li>Initialize <var>map object</var> to the value of <var>item active property</var>
                          in <var>nest result</var>,
                          initializing it to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, if necessary.</li>
                        <li>Initialize <var>map key</var> the value of <code>@index</code> in
                          <var>expanded item</var> or <code>@none</code>, if no such
                          value exists.</li>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                          to the <var>map key</var> entry in <var>map object</var>
                          using <var>as array</var>.</li>
                      </ol>
                    </li>
                    <li>Otherwise, if <var>container</var> includes <code>@graph</code>
                      and <var>expanded item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-simple-graph-object">simple graph object</a>
                      the value cannot be represented as a map object.
                      <ol>
                        <li>If <var>compacted item</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                          with more than one value, it cannot be directly represented,
                          as multiple objects would be interpreted as different named graphs.
                          Set <var>compacted item</var> to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
                          containing the key
                          from <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@included</code></span>
                          and the original <var>compacted item</var> as the value. </li>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                          to the <var>item active property</var> entry in <var>nest result</var>
                          using <var>as array</var>.</li>
                      </ol>                      
                    </li>
                    <li>Otherwise, <var>container</var> does not include <code>@graph</code>
                      or otherwise does not match one of the previous cases.
                      <ol>
                        <li>Set <var>compacted item</var> to a new map containing
                          the key
                          from <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@graph</code></span>
                          using the original <var>compacted item</var> as a value.</li>
                        <li>If expanded item contains an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                          add an entry in <var>compacted item</var> using the key
                          from <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@id</code></span>
                          using the value
                          of <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> the value of <code>@id</code> in <var>expanded item</var>
                            using <code>false</code> for <var>vocab</var></span>.</li>
                        <li>If expanded item contains an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                          add an entry in <var>compacted item</var> using the key
                          from <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@index</code></span>
                          and the value of <code>@index</code> in <var>expanded item</var>.</li>
                        <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                          to the <var>item active property</var> entry in <var>nest result</var>
                          using <var>as array</var>.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
                <li>
                  <span class="changed">Otherwise</span>, if <var>container</var> <span class="changed">includes</span> <code>@language</code>,
                  <code>@index</code>, <span class="changed"><code>@id</code>,
                    or <code>@type</code></span>
                    <span class="changed">and <var>container</var> does not include <code>@graph</code></span>:
                  <ol>
                    <li class="changed">Initialize <var>map object</var> to the value of <var>item active property</var>
                      in <var>nest result</var>,
                      initializing it to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, if necessary.</li>
                    <li>Initialize <var>container key</var>
                      by <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a></span>
                      either <code>@language</code>, <code>@index</code>, <code>@id</code>, or <code>@type</code>
                      based on the contents of <var>container</var>.</li>
                    <li class="changed">Initialize <var>index key</var> to the value of <a href="#dfn-index-mapping" class="internalDFN" data-link-type="dfn">index mapping</a> in
                      the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> associated with <var>item active property</var> in <var>active context</var>,
                      or <code>@index</code>, if no such value exists.</li>
                    <li>If <var>container</var> includes <code>@language</code> and
                      <var>expanded item</var> contains a
                      <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, then set <var>compacted item</var>
                      to the value associated with its <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.
                      Set <var>map key</var> to the value of <code>@language</code> in <var>expanded item</var>, if any.</li>
                    <li>Otherwise, if <var>container</var> includes <code>@index</code>
                      and <var>index key</var> is <code>@index</code>,
                      set <var>map key</var> to the value of <code>@index</code> in <var>expanded item</var>, if any.</li>
                    <li class="changed">Otherwise, if <var>container</var> includes <code>@index</code>
                      and <var>index key</var> is not <code>@index</code>,
                      set <var>map key</var> to the first value of <var>container key</var> in <var>compacted item</var>, if any.
                      If there are remaining values in <var>compacted item</var>
                      for <var>container key</var>, set the value of
                      <var>container key</var> in <var>compacted item</var>
                      to those remaining values. Otherwise, remove that
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>compacted item</var>.
                    </li>
                    <li class="changed">Otherwise, if <var>container</var> includes <code>@id</code>, set
                      <var>map key</var> to the value of <var>container key</var> in
                      <var>compacted item</var> and remove <var>container key</var> from <var>compacted item</var>.</li>
                    <li class="changed">Otherwise, if <var>container</var> includes <code>@type</code>:
                      <ol>
                        <li>Set <var>map key</var> to the first value of <var>container key</var> in <var>compacted item</var>, if any.</li>
                        <li>If there are remaining values in <var>compacted item</var>
                          for <var>container key</var>, set the value of
                          <var>container key</var> in <var>compacted item</var>
                          to those remaining values.</li>
                        <li>Otherwise, remove that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>compacted item</var>.</li>
                        <li>If <var>compacted item</var> contains a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> with a key expanding
                          to <code>@id</code>, set <var>compacted item</var>
                          to the result of using
                          this algorithm recursively, passing
                          <var>active context</var>, <var>inverse context</var>,
                          <var>item active property</var> for <var>active property</var>,
                          and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> composed of the single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <code>@id</code> from <var>expanded item</var> for <var>element</var>.
                          
                        </li>
                      </ol>
                    </li>
                    <li>If <var>map key</var> is <code>null</code>,
                      set it to the result of
                      <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@none</code></span>.</li>
                    <li class="changed">Use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                      to the <var>map key</var> entry in <var>map object</var>
                      using <var>as array</var>.</li>
                  </ol>
                </li>
                <li class="changed">Otherwise, use <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a> to add <var>compacted item</var>
                  to the <var>item active property</var> entry in <var>result</var>
                  using <var>as array</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="iri-compaction"><h3 id="x6-2-iri-compaction"><bdi class="secno">6.2 </bdi><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction<a class="self-link" aria-label="§" href="#iri-compaction"></a></h3>

    <p>This algorithm compacts an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> to a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> or
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> to a
      <a href="#dfn-keyword-alias" class="internalDFN" data-link-type="dfn">keyword alias</a>. A value that is associated with the
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> may be passed in order to assist in selecting the most
      context-appropriate <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>.</p>

    <section class="informative" id="overview-7">
      <h4 id="x6-2-1-overview"><bdi class="secno">6.2.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-7"></a></h4><p><em>This section is non-normative.</em></p>

      <p>If the passed <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> is <code>null</code>,
        we simply return <code>null</code>.
        Otherwise, we first try to find a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
        can be compacted to if it is relative to
        <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>.
        In order to select the most appropriate <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>,
        we may have to collect information about the passed <var>value</var>.
        This information includes determining the preferred <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>,
        <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>
        for expressing the <var>value</var>.
        For <a data-lt="list object" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">JSON-LD lists</a>, the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a>
        or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> will be chosen based on the most
        specific values that work for all items in the list.
        Once this information is gathered,
        it is passed to the <a href="#term-selection">Term Selection algorithm</a>,
        which will return the most appropriate <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>.</p>

      <p>If no <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> was found that could be used to compact the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
        an attempt is made to compact the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        using the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>,
        if there is one.
        If the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> could not be compacted,
        an attempt is made to find a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
        <span class="changed">A term will be used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
          only if the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> contains the <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a>
          with the value <code>true</code>.</span>
        If there is no appropriate <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
        <span class="changed">and the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-compacttorelative" class="internalDFN" data-link-type="idl"><code>compactToRelative</code></a> option is <code>true</code></span>,
        the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> is transformed to a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a>
        using the document's <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
        Finally, if the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> still could not be compacted,
        it is returned as is.</p>

      <p class="changed">When considering <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
        the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> is also considered, either with, or without,
        a <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>,
        and the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> is normalized to lower case.</p>

      <p class="changed">In the case were this algorithm would return the input <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> as is,
        and that <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> can be mistaken for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>,
        this algorithm will raise an error,
        because it has no way to return an unambiguous representation of the original <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</p>
    </section>

    <section class="algorithm" id="algorithm-7">
      <h4 id="x6-2-2-algorithm"><bdi class="secno">6.2.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-7"></a></h4>

      <p>This algorithm takes three required inputs and three optional inputs.
        The required inputs are an <var>active context</var>, an <var>inverse context</var>,
        and the <var>var</var> to be compacted.
        The optional inputs are a <var>value</var> associated with the <var>var</var>,
        a <var>vocab</var> flag which specifies whether the passed <var>var</var>
        should be compacted using the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>,
        and a <var>reverse</var> flag which specifies whether a <a href="#dfn-reverse-property" class="internalDFN" data-link-type="dfn">reverse property</a> is being compacted.
        If not passed, <var>value</var> is set to <code>null</code>
        and both <var>vocab</var> and <var>reverse</var> are both set to <code>false</code>.</p>

      <ol>
        <li>If <var>var</var> is <code>null</code>, return <code>null</code>.</li>
        <li>If <var>vocab</var> is <code>true</code> and <var>var</var> is an
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>inverse context</var>:
          <ol>
            <li class="changed">Initialize <var>default language</var>
              based on the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a>
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>, normalized to lower case and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>:
              <ol>
                <li>If the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>
                  is not <code>null</code>, to the concatenation of
                  the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>
                  and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>, separated by an underscore (<code>"_"</code>),
                  normalized to lower case.</li>
                <li>Otherwise, to the <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>,
                  if it has one,
                  normalized to lower case,
                  otherwise to <code>@none</code>.</li>
              </ol>
            </li>
            <li class="changed">If <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing an <code>@preserve</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              use the first element from the value of <code>@preserve</code> as <var>value</var>.</li>
            <li>Initialize <var>containers</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. This
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> will be used to keep track of an ordered list of
              preferred <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> for a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>,
              based on what is compatible with <var>value</var>.
              <div class="note" role="note" id="issue-container-generatedID-21"><div role="heading" class="note-title marker" id="h-note-21" aria-level="5"><span>Note</span></div><div class="">
                Algorithm steps may append the same value to <var>containers</var>,
                but the order in which they are added is significant for choosing the most appropriate term.
              </div></div>
            </li>
            <li>Initialize <var>type/language</var> to <code>@language</code>,
              and <var>type/language value</var> to <code>@null</code>. These two
              variables will keep track of the preferred
              <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> for
              a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, based on what is compatible with <var>value</var>.</li>
            <li class="changed">If <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> which is also a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
              and <var>value</var> is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>
              then append the values <code>@index</code> and <code>@index@set</code> to <var>containers</var>.</li>
            <li>If <var>reverse</var> is <code>true</code>, set <var>type/language</var>
              to <code>@type</code>, <var>type/language value</var> to
              <code>@reverse</code>, and append <code>@set</code> to <var>containers</var>.</li>
            <li>Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, then set
              <var>type/language</var> and <var>type/language value</var>
              to the most specific values that work for all items in
              the list as follows:
              <ol>
                <li>If <code>@index</code> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>value</var>, then
                  append <code>@list</code> to <var>containers</var>.</li>
                <li>Initialize <var>list</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> associated
                  with the <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>value</var>.</li>
                <li>Initialize <var>common type</var> and <var>common language</var> to <code>null</code>. If
                  <var>list</var> is empty, set <var>common language</var> to
                  <var>default language</var>.</li>
                <li>For each <var>item</var> in <var>list</var>:
                  <ol>
                    <li>Initialize <var>item language</var> to <code>@none</code> and
                      <var>item type</var> to <code>@none</code>.</li>
                    <li>If <var>item</var> contains an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
                      <ol>
                        <li class="changed">If <var>item</var> contains an <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                          then set <var>item language</var> to the concatenation of
                          the <var>item</var>'s <code>@language</code> entry (if any)
                          the <var>item</var>'s <code>@direction</code>, separated by an underscore (<code>"_"</code>),
                          normalized to lower case.</li>
                        <li>Otherwise, if <var>item</var> contains an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                          then set <var>item language</var> to its associated value,
                          normalized to lower case.</li>
                        <li>Otherwise, if <var>item</var> contains a
                          <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, set <var>item type</var> to its
                          associated value.</li>
                        <li>Otherwise, set <var>item language</var> to
                          <code>@null</code>.</li>
                      </ol>
                    </li>
                    <li>Otherwise, set <var>item type</var> to <code>@id</code>.</li>
                    <li>If <var>common language</var> is <code>null</code>,
                      set <var>common language</var> to <var>item language</var>.</li>
                    <li>Otherwise, if <var>item language</var> does not equal
                      <var>common language</var> and <var>item</var> contains a
                      <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, then set <var>common language</var>
                      to <code>@none</code> because list items have conflicting
                      languages.</li>
                    <li>If <var>common type</var> is <code>null</code>,
                      set <var>common type</var> to <var>item type</var>.</li>
                    <li>Otherwise, if <var>item type</var> does not equal
                      <var>common type</var>, then set <var>common type</var>
                      to <code>@none</code> because list items have conflicting
                      types.</li>
                    <li>If <var>common language</var> is <code>@none</code> and
                      <var>common type</var> is <code>@none</code>, then
                      stop processing items in the list because it has been
                      detected that there is no common language or type amongst
                      the items.</li>
                  </ol>
                </li>
                <li>If <var>common language</var> is <code>null</code>,
                  set <var>common language</var> to <code>@none</code>.</li>
                <li>If <var>common type</var> is <code>null</code>,
                  set <var>common type</var> to <code>@none</code>.</li>
                <li>If <var>common type</var> is not <code>@none</code> then set
                  <var>type/language</var> to <code>@type</code> and
                  <var>type/language value</var> to <var>common type</var>.</li>
                <li>Otherwise, set <var>type/language value</var> to
                  <var>common language</var>.</li>
              </ol>
            </li>
            <li class="changed">Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-graph-object">graph object</a>,
              prefer a mapping most appropriate for the particular value.
              <ol>
                <li>If <var>value</var> contains an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  append the values <code>@graph@index</code> and <code>@graph@index@set</code>
                  to <var>containers</var>.</li>
                <li>If <var>value</var> contains an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  append the values <code>@graph@id</code> and <code>@graph@id@set</code>
                  to <var>containers</var>.</li>
                <li>Append the values <code>@graph</code> <code>@graph@set</code>,
                  and <code>@set</code>
                  to <var>containers</var>.</li>
                <li>If <var>value</var> does not contain an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  append the values <code>@graph@index</code> and <code>@graph@index@set</code>
                  to <var>containers</var>.</li>
                <li>If the <var>value</var> does not contain an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  append the values <code>@graph@id</code> and <code>@graph@id@set</code>
                  to <var>containers</var>.</li>
                <li>Append the values <code>@index</code> and <code>@index@set</code>
                  to <var>containers</var>.</li>
                <li>Set <var>type/language</var> to <code>@type</code>
                  and set <var>type/language value</var> to <code>@id</code>.</li>
              </ol>
            </li>
            <li>Otherwise:
              <ol>
                <li>If <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>:
                  <ol>
                    <li class="changed">If <var>value</var> contains an <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      and does not contain an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      then set <var>type/language value</var> to the concatenation of
                      the <var>value</var>'s <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> (if any)
                      and the <var>value</var>'s <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, separated by an underscore (<code>"_"</code>),
                      normalized to lower case.
                      Append <code>@language</code> and <code>@language@set</code> to <var>containers</var>.</li>
                    <li>Otherwise, if <var>value</var> contains an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      and does not contain an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      then set <var>type/language value</var> to
                      the value of <code>@langauge</code> normalized to lower case,
                      and append <code>@language</code>,
                      <span class="changed">and <code>@language@set</code></span> to
                      <var>containers</var>.</li>
                    <li>Otherwise, if <var>value</var> contains an
                      <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, then set <var>type/language value</var> to
                      its associated value and set <var>type/language</var> to
                      <code>@type</code>.</li>
                  </ol>
                </li>
                <li>Otherwise, set <var>type/language</var> to <code>@type</code>
                  and set <var>type/language value</var> to <code>@id</code>,
                  <span class="changed">and append <code>@id</code>, <code>@id@set</code>,
                    <code>@type</code>, and <code>@set@type</code></span>,
                  to <var>containers</var>.</li>
                <li>Append <code>@set</code> to <var>containers</var>.</li>
              </ol>
            </li>
            <li>Append <code>@none</code> to <var>containers</var>. This represents
              the non-existence of a <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>, and it will
              be the last <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> value to be checked as it
              is the most generic.</li>
            <li class="changed">
              If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is not <code>json-ld-1.0</code> and <var>value</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
              or does not contain an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              append <code>@index</code> and <code>@index@set</code> to <var>containers</var>.
            </li><li class="changed">
              If <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is not <code>json-ld-1.0</code> and
              <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing only an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              append <code>@language</code> and <code>@language@set</code> to <var>containers</var>.</li>
            <li>If <var>type/language value</var> is <code>null</code>,
              set <var>type/language value</var> to <code>@null</code>.
              This is the key under which <code>null</code> values
              are stored in the <var>inverse context</var> <var>entry</var>.</li>
            <li>Initialize <var>preferred values</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.
              This <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> will indicate, in order, the preferred values for
              a <a data-lt="term" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term's</a> <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or
              <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a>.</li>
            <li>If <var>type/language value</var> is <code>@reverse</code>, append
              <code>@reverse</code> to <var>preferred values</var>.</li>
            <li>If <var>type/language value</var> is <code>@id</code> or <code>@reverse</code> and
              <var>value</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> containing an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>If the result of
                  <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a>
                    the value of the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>value</var></span>
                  has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in the <var>active context</var>
                  with an <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> that equals the value of the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>value</var>,
                  then append <code>@vocab</code>, <code>@id</code>, and
                  <code>@none</code>, in that order, to <var>preferred values</var>.</li>
                <li>Otherwise, append <code>@id</code>, <code>@vocab</code>, and
                  <code>@none</code>, in that order, to <var>preferred values</var>.</li>
              </ol>
            </li>
            <li>Otherwise, append <var>type/language value</var> and <code>@none</code>, in
              that order, to <var>preferred values</var>.
              <span class="changed">If <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>
                with an empty <var>array</var> as the value of <code>@list</code>,
                set <var>type/language</var> to <code>@any</code>.</span></li>
            <li class="changed">Append <code>@any</code> to <var>preferred values</var>.</li>
            <li class="changed">If <var>preferred values</var>
              contains any entry having an underscore (<code>"_"</code>),
              append the substring of that entry from the underscore to the end of the string
              to <var>preferred values</var>.</li>
            <li>Initialize <var>term</var> to the result of the
              <a href="#term-selection">Term Selection algorithm</a>, passing
              <var>inverse context</var>, <var>var</var>, <var>containers</var>,
              <var>type/language</var>, and <var>preferred values</var>.</li>
            <li>If <var>term</var> is not <code>null</code>, return <var>term</var>.</li>
          </ol>
        </li>
        <li>At this point, there is no simple <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a> that <var>var</var>
          can be compacted to. If <var>vocab</var> is <code>true</code> and
          <var>active context</var> has a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>:
          <ol>
            <li>If <var>var</var> begins with the
              <a data-lt="vocabulary mapping" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping's</a> value
              but is longer, then initialize <var>suffix</var> to the substring
              of <var>var</var> that does not match. If <var>suffix</var> does not
              have a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>active context</var>,
              then return <var>suffix</var>.</li>
          </ol>
        </li>
        <li>The <var>var</var> could not be compacted using the
          <a data-lt="active context" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context's</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a>.
          Try to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, starting by initializing
          <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var> to <code>null</code>. This variable will be used to
          store the created <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>, if any.</li>
        <li>For each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> <var>definition</var> in <var>active context</var>:
          <ol>
            <li>If the <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> of <var>definition</var> is <code>null</code>,
              its <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> equals <var>var</var>,
              its <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a> is not a substring at the beginning of
              <var>var</var>,
              <span class="changed"> or <var>definition</var> does not have
                a <code>true</code> <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a>,</span>
              <var>definition</var>'s key cannot be used as a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-prefix">prefix</a>.
              Continue with the next <var>definition</var>.</li>
            <li>Initialize <var>candidate</var> by concatenating <var>definition</var> key,
              a colon (<code>:</code>), and the substring of <var>var</var>
              that follows after the value of the
              <var>definition</var>'s <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>.</li>
            <li>If either <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var> is <code>null</code>, <var>candidate</var> is
              shorter or the same length but lexicographically less than
              <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var> and <var>candidate</var> does not have a
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in <var>active context</var>, or if that
              <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has an <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>
              that equals <var>var</var> and <var>value</var> is <code>null</code>,
              set <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var> to <var>candidate</var>.</li>
          </ol>
        </li>
        <li>If <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var> is not <code>null</code>, return <var>compact <abbr title="Internationalized Resource Identifier">IRI</abbr></var>.</li>
        <li class="changed">To ensure that the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> <var>var</var> is
          not confused with a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
          if the <a href="https://tools.ietf.org/html/rfc3986#section-3.1"><abbr title="Internationalized Resource Identifier">IRI</abbr> scheme</a> of <var>var</var>
          matches any term in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> with <a href="#dfn-prefix-flag" class="internalDFN" data-link-type="dfn">prefix flag</a> set to <code>true</code>,
          and <var>var</var> has no <a href="https://tools.ietf.org/html/rfc3986#section-3.2"><abbr title="Internationalized Resource Identifier">IRI</abbr> authority</a> (preceded by double-forward-slash (<code>//</code>),
          an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-iri-confused-with-prefix" class="internalDFN" data-link-type="idl"><code><abbr title="Internationalized Resource Identifier">IRI</abbr> confused with prefix</code></a> error has been detected,
          and processing is aborted.</li>
        <li>If <var>vocab</var> is <code>false</code>,
          transform <var>var</var> to a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> using
          the <span class="changed"><a data-lt="context-base-iri" href="#dfn-context-base-iri" class="internalDFN" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> from <var>active context</var>, if it exists</span>.</li>
        <li>Finally, return <var>var</var> as is.</li>
      </ol>
    </section>
  </section> 

  <section id="value-compaction"><h3 id="x6-3-value-compaction"><bdi class="secno">6.3 </bdi>Value Compaction<a class="self-link" aria-label="§" href="#value-compaction"></a></h3>

    <p><a href="#dfn-expanded" class="internalDFN" data-link-type="dfn">Expansion</a> transforms all values into <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a>
      in JSON-LD. This algorithm performs the opposite operation, transforming
      a value into <dfn data-lt="compact form|compacted form" data-dfn-type="dfn" id="dfn-compact-form">compacted form</dfn>. This algorithm compacts a
      value according to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> in the given
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a> that is associated with the value's associated
      <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a>.</p>

    <section class="informative" id="overview-8">
      <h4 id="x6-3-1-overview"><bdi class="secno">6.3.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-8"></a></h4><p><em>This section is non-normative.</em></p>

      <p>The <var>value</var> to compact has either an <code>@id</code> or an
        <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</p>

      <p>For the former case, if the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of
        <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> is set to <code>@id</code> or <code>@vocab</code>
        and <var>value</var> consists of only an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> and, if
        the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> of <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a>
        <span class="changed">includes</span> <code>@index</code>, an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, <var>value</var>
        can be compacted to a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> by returning the result of
        using the <a href="#iri-compaction"><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction algorithm</a>
        to compact the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.
        Otherwise, <var>value</var> cannot be compacted and is returned as is.</p>

      <p>For the latter case, it might be possible to compact <var>value</var>
        just into the value associated with the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.
        This can be done if the <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> has a matching
        <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> or <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> and there
        is either no <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> or the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
        of <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> <span class="changed">includes</span> <code>@index</code>. It can
        also be done if <code>@value</code> is the only <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>value</var>
        (apart an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in case the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a>
        of <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a> <span class="changed">includes</span> <code>@index</code>) and
        either its associated value is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, there is
        no <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>, or there is an explicit
        <code>null</code> <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> for the
        <a href="#dfn-active-property" class="internalDFN" data-link-type="dfn">active property</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-8">
      <h4 id="x6-3-2-algorithm"><bdi class="secno">6.3.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-8"></a></h4>

      <p>This algorithm has four required inputs: an <var>active context</var>, an
        <var>inverse context</var>,  an <var>active property</var>, and a <var>value</var>
        to be compacted.</p>

      <ol>
        <li>Initialize <var>result</var> to a copy of <var>value</var>.</li>
        <li>Initialize <var>language</var> to the <a href="#dfn-language-mapping" class="internalDFN" data-link-type="dfn">language mapping</a> for <var>active property</var>
          in <var>active context</var>, if any, otherwise to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a>
          of <var>active context</var>.</li>
        <li class="changed">Initialize <var>direction</var> to the <a href="#dfn-direction-mapping" class="internalDFN" data-link-type="dfn">direction mapping</a> for <var>active property</var>
          in <var>active context</var>, if any, otherwise to the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">default base direction</a>
          of <var>active context</var>.</li>
        <li id="alg-compval-id-index">If <var>value</var> has an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          and has no other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> other than <code>@index</code>:
          <ol>
            <li>If the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <var>active property</var>
              is set to <code>@id</code>, set <var>result</var> to the result of
              <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a>
                the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                using <code>false</code> for <var>vocab</var></span>.</li>
            <li>Otherwise, if the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <var>active property</var>
              is set to <code>@vocab</code>, set <var>result</var> to the result of
              <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a>
                the value associated with the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a></span>.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>value</var> has an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose
          value matches the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <var>active property</var>,
          set <var>result</var> to the value associated with the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          of <var>value</var>.</li>
        <li class="changed">Otherwise, if the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <var>active property</var> is <code>@none</code>,
          or <var>value</var> has an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
          and the value of <code>@type</code> in <var>value</var> does not match the <a href="#dfn-type-mapping" class="internalDFN" data-link-type="dfn">type mapping</a> of <var>active property</var>,
          leave <var>value</var> as is, as value compaction is disabled.
          <ol>
            <li>Replace any value of <code>@type</code> in <var>result</var> with the result of
              <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a></span>
              the value of the <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
          </ol>
        </li>
        <li>Otherwise, if the value of the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>:
          <ol>
            <li>If <var>value</var> has an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              and the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> associated to <var>active property</var>
              includes <code>@index</code>,
              or if <var>value</var> has no <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              set <var>result</var> to the value associated with the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
          </ol>
        </li>
        <li id="alg-valcompact-lang-dir">Otherwise, if <var>value</var> has an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          whose value exactly matches <var>language</var>,
          <span class="changed">using a case-insensitive comparison</span>
          if it is not <code>null</code>, or is not present, if <var>language</var> is <code>null</code>,
          <span class="changed">and the <var>value</var> has an <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
            whose value exactly matches <var>direction</var>,
            if it is not <code>null</code>, or is not present, if <var>direction</var> is <code>null</code></span>:
          <ol>
            <li>If <var>value</var> has an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              and the <a href="#dfn-container-mapping" class="internalDFN" data-link-type="dfn">container mapping</a> associated to <var>active property</var>
              includes <code>@index</code>,
              or <var>value</var> has no <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              set <var>result</var> to the value associated with the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
          </ol>
        </li>
        <li>If <var>result</var> is a <var>map</var>,
          replace each key in <var>result</var> with the result of
          <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> that key</span>.</li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 
</section> 

<section id="flattening-algorithms"><h2 id="x7-flattening-algorithms"><bdi class="secno">7. </bdi>Flattening Algorithms<a class="self-link" aria-label="§" href="#flattening-algorithms"></a></h2>

  <p>The following sections describe algorithms for flattening JSON-LD documents,
    creating node maps, and generating blank nodes.</p>

  <section id="flattening-algorithm"><h3 id="x7-1-flattening-algorithm"><bdi class="secno">7.1 </bdi>Flattening Algorithm<a class="self-link" aria-label="§" href="#flattening-algorithm"></a></h3>

    <p>This algorithm flattens an expanded JSON-LD document by collecting all
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in a single <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
      and labeling all <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank nodes</a> with
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>.
      This resulting uniform shape of the document, may drastically simplify
      the code required to process JSON-LD data in certain applications.</p>

    <section class="informative" id="overview-9">
      <h4 id="x7-1-1-overview"><bdi class="secno">7.1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-9"></a></h4><p><em>This section is non-normative.</em></p>

      <p>First, a <var>node map</var> is generated using the
        <a href="#node-map-generation">Node Map Generation algorithm</a>
        which collects all <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> in a single
        <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. In the next step, the <var>node map</var> is
        converted to a JSON-LD document in
        <a href="https://www.w3.org/TR/json-ld11/#flattened-document-form">flattened document form</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-9">
      <h4 id="x7-1-2-algorithm"><bdi class="secno">7.1.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-9"></a></h4>

      <p>The algorithm takes <span class="changed">one required and one optional</span> input variables.
        The required input is an <var>element</var> to flatten.
        <span class="changed">The optional input is
          the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flag, used to order
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> keys lexicographically, where noted.
        If not passed, the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flag is set to <code>false</code></span>.</p>

      <p>This algorithm uses the
        <a href="#generate-blank-node-identifier">Generate Blank Node Identifier algorithm</a>
        to generate new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>
        and relabel existing <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>.
        The <a href="#generate-blank-node-identifier">Generate Blank Node Identifier algorithm</a>
        maintains an <var>identifier map</var>
        <span class="changed">to ensure that blank node identifiers in the source
          document are consistently remapped to new blank node identifiers
          avoiding collisions.</span>
        Thus, before this algorithm is run, the <var>identifier map</var> is reset.</p>

      <ol>
        <li>Initialize <var>node map</var> to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of
          a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose key is <code>@default</code> and whose value is
          an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li>Perform the <a href="#node-map-generation">Node Map Generation algorithm</a>, passing
          <var>element</var> and <var>node map</var>.</li>
        <li>Initialize <var>default graph</var> to the value of the <code>@default</code>
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node map</var>, which is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> representing
          the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a>.</li>
        <li>For each key-value pair <var>graph name</var>-<var>graph</var> in <var>node map</var>
          where <var>graph name</var> is not <code>@default</code>,
          <span class="changed">ordered lexicographically by <var>graph name</var>
          if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>,
          perform the following steps:
          <ol>
            <li>If <var>default graph</var> does not have a <var>graph name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create
              one and initialize its value to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of an
              <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose value is set to <var>graph name</var>.</li>
            <li>Reference the value associated with the <var>graph name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in
              <var>default graph</var> using the variable <var>entry</var>.</li>
            <li>Add an <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>entry</var> and set it to an
              empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
            <li>For each <var>id</var>-<var>node</var> pair in <var>graph</var> ordered lexicographically by <var>id</var>
              <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>,
              add <var>node</var> to the <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>entry</var>,
              unless the only <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var> is <code>@id</code>.</li>
          </ol>
        </li>
        <li>Initialize an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>flattened</var>.</li>
        <li>For each <var>id</var>-<var>node</var> pair in <var>default graph</var> ordered lexicographically by <var>id</var>
          <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>,
          add <var>node</var> to <var>flattened</var>,
          unless the only <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var> is <code>@id</code>.</li>
        <li>Return <var>flattened</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="node-map-generation"><h3 id="x7-2-node-map-generation"><bdi class="secno">7.2 </bdi>Node Map Generation<a class="self-link" aria-label="§" href="#node-map-generation"></a></h3>

    <p>This algorithm creates a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>node map</var> holding an indexed
      representation of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graphs</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a>
      represented in the passed expanded document. All <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a> that are not
      uniquely identified by an <abbr title="Internationalized Resource Identifier">IRI</abbr> get assigned a (new) <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.
      The resulting <var>node map</var> will have an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> for every graph in the document whose
      value is another object with an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for every <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> represented in the document.
      The default graph is stored under the <code>@default</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, all other graphs are
      stored under their <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a>.</p>

    <section class="informative" id="overview-10">
      <h4 id="x7-2-1-overview"><bdi class="secno">7.2.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-10"></a></h4><p><em>This section is non-normative.</em></p>

      <p>The algorithm recursively runs over an expanded JSON-LD document to
        collect all <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a>
        in a single <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The algorithm updates a
        <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>node map</var> whose keys represent the
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph names</a> used in the document
        (the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> is stored under the <code>@default</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>)
        and whose associated values are <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>
        which index the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a> in the
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a>. If a
        <a data-lt="entry" data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry's</a> value is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>,
        it is replaced by a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> consisting of only an
        <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>. If a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> has no <code>@id</code>
        <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> or it is identified by a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
        a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> is generated. This relabeling
        of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> is
        also done for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> and values of
        <code>@type</code>.</p>
    </section>

    <section class="algorithm" id="algorithm-10">
      <h4 id="x7-2-2-algorithm"><bdi class="secno">7.2.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-10"></a></h4>

      <p>The algorithm takes as input an expanded JSON-LD document <var>element</var> and a reference to
        a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>node map</var>. Furthermore it has the optional parameters
        <var>active graph</var> (which defaults to <code>@default</code>), an <var>active subject</var>,
        <var>active property</var>, and a reference to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>list</var>. If
        not passed, <var>active subject</var>, <var>active property</var>, and <var>list</var> are
        set to <code>null</code>.</p>

      <ol>
        <li>If <var>element</var> is an array, process each <var>item</var> in <var>element</var>
          as follows and then return:
          <ol>
            <li>Run this algorithm recursively by passing <var>item</var> for <var>element</var>,
              <var>node map</var>, <var>active graph</var>, <var>active subject</var>,
              <var>active property</var>, and <var>list</var>.</li>
          </ol>
        </li>
        <li>Otherwise <var>element</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>. Reference the
          <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> which is the value of the <a href="#dfn-active-graph" class="internalDFN" data-link-type="dfn">active graph</a>
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node map</var> using the variable <var>graph</var>. If the
          <var>active subject</var> is <code>null</code>, set <var>node</var> to <code>null</code>
          otherwise reference the <var>active subject</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>graph</var> using the
          variable <var>subject node</var>.</li>
        <li id="alg-nmg-each-type">For each <var>item</var> in the <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>element</var>,
          if any, or for the value of <code>@type</code>, if the value of <code>@type</code> exists and is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>:
          <ol>
            <li>If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, replace it with a newly
              <a href="#generate-blank-node-identifier">generated blank node identifier</a>
              passing <var>item</var> for <var>identifier</var>.</li>
          </ol>
        </li>
        <li>If <var>element</var> has an <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, perform the following steps:
          <ol>
            <li>If <var>list</var> is <code>null</code>:
              <ol>
                <li>If <var>subject node</var> does not have an <var>active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and initialize its value to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                  containing <var>element</var>.</li>
                <li>Otherwise, compare <var>element</var> against every item in the
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> associated with the <var>active property</var>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>subject node</var>. If there is no item equivalent to <var>element</var>,
                  append <var>element</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. Two
                  <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are considered
                  equal if they have equivalent <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry"> map entries</a>.</li>
              </ol>
            </li>
            <li>Otherwise, append <var>element</var> to the <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>list</var>.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>element</var> has an <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, perform
          the following steps:
          <ol>
            <li>Initialize a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>result</var> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              <code>@list</code> whose value is initialized to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
            <li>Recursively call this algorithm passing the value of <var>element</var>'s
              <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <var>element</var>, <var>node map</var>, <var>active graph</var>,
              <var>active subject</var>, <var>active property</var>, and
              <var>result</var> for <var>list</var>.</li>
            <li class="changed">If <var>list</var> is <code>null</code>,
              append <var>result</var> to the value of the <var>active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              of <var>subject node</var>.</li>
            <li class="changed">Otherwise, append <var>result</var> to the <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>list</var>.</li>
          </ol>
        </li>
        <li>Otherwise <var>element</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>, perform
          the following steps:
          <ol>
            <li>If <var>element</var> has an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, set <var>id</var>
              to its value and remove the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>. If <var>id</var>
              is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, replace it with a newly
              <a href="#generate-blank-node-identifier">generated blank node identifier</a>
              passing <var>id</var> for <var>identifier</var>.</li>
            <li>Otherwise, set <var>id</var> to the result of the
              <a href="#generate-blank-node-identifier">Generate Blank Node Identifier algorithm</a>
              passing <code>null</code> for <var>identifier</var>.</li>
            <li>If <var>graph</var> does not contain an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <var>id</var>, create one and initialize
              its value to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose
              value is <var>id</var>.</li>
            <li>Reference the value of the <var>id</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>graph</var> using the
              variable <var>node</var>.</li>
            <li>If <var>active subject</var> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>, a reverse property relationship
              is being processed. Perform the following steps:
              <ol>
                <li>If <var>node</var> does not have a <var>active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and initialize its value to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                  containing <var>active subject</var>.</li>
                <li>Otherwise, compare <var>active subject</var> against every item in the
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> associated with the <var>active property</var>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var>. If there is no item equivalent to <var>active subject</var>,
                  append <var>active subject</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. Two
                  <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are considered
                  equal if they have equivalent <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>.</li>
              </ol>
            </li>
            <li>Otherwise, if <var>active property</var> is not <code>null</code>, perform the following steps:
              <ol>
                <li>Create a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>reference</var> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                  <code>@id</code> whose value is <var>id</var>.</li>
                <li>If <var>list</var> is <code>null</code>:
                  <ol>
                    <li>If <var>subject node</var> does not have an <var>active property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                      create one and initialize its value to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                      containing <var>reference</var>.</li>
                    <li>Otherwise, compare <var>reference</var> against every item in the
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> associated with the <var>active property</var>
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>subject node</var>. If there is no item equivalent to <var>reference</var>,
                      append <var>reference</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. Two
                      <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> are considered
                      equal if they have equivalent <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>.</li>
                  </ol>
                </li>
                <li>Otherwise, append <var class="changed">reference</var> to the <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>list</var>.</li>
              </ol>
            </li>
            <li>If <var>element</var> has an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, append
              each item of its associated <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> to the
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> associated with the <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
              <var>node</var> unless it is already in that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. Finally
              remove the <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>.</li>
            <li>If <var>element</var> has an <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, set the <code>@index</code>
              <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var> to its value. If <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> already has an
              <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> with a different value, a
              <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-conflicting-indexes" class="internalDFN" data-link-type="idl"><code>conflicting indexes</code></a>
              error has been detected and processing is aborted. Otherwise, continue by
              removing the <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>.</li>
            <li>If <var>element</var> has an <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>Create a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>referenced node</var> with a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose
                  value is <var>id</var>.</li>
                <li>Initialize <var>reverse map</var> to the value of the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
                  <var>element</var>.</li>
                <li>For each key-value pair <var>property</var>-<var>values</var> in <var>reverse map</var>:
                  <ol>
                    <li>For each <var>value</var> of <var>values</var>:
                      <ol>
                        <li>Recursively invoke this algorithm passing <var>value</var> for
                          <var>element</var>, <var>node map</var>, <var>active graph</var>,
                          <var>referenced node</var> for <var>active subject</var>, and
                          <var>property</var> for <var>active property</var>. Passing a
                          <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> for <var>active subject</var> indicates to the
                          algorithm that a reverse property relationship is being processed.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
                <li>Remove the <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>.</li>
              </ol>
            </li>
            <li>If <var>element</var> has an <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, recursively invoke this
              algorithm passing the value of the <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <var>element</var>,
              <var>node map</var>, and <var>id</var> for <var>active graph</var> before removing
              the <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>.</li>
            <li class="changed">If <var>element</var> has an <code>@included</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              recursively invoke this algorithm passing the value of the <code>@included</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> for <var>element</var>,
              <var>node map</var>, and <var>active graph</var>
              before removing the <code>@included</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>element</var>.</li>
            <li>Finally, for each key-value pair <var>property</var>-<var>value</var> in <var>element</var> ordered by
              <var>property</var> perform the following steps:
              <ol>
                <li>If <var>property</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, replace it with a newly
                  <a href="#generate-blank-node-identifier">generated blank node identifier</a>
                  passing <var>property</var> for <var>identifier</var>.
                  <div class="note" role="note" id="issue-container-generatedID-22"><div role="heading" class="note-title marker" id="h-note-22" aria-level="5"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
                    and may be removed in a future version of JSON-LD.</div></div></li>
                <li>If <var>node</var> does not have a <var>property</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and initialize
                  its value to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li>Recursively invoke this algorithm passing <var>value</var> for <var>element</var>,
                  <var>node map</var>, <var>active graph</var>, <var>id</var> for <var>active subject</var>,
                  and <var>property</var> for <var>active property</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </section>
  </section> 

  <section class="changed algorithm" id="merge-node-maps"><h3 id="x7-3-merge-node-maps"><bdi class="secno">7.3 </bdi>Merge Node Maps<a class="self-link" aria-label="§" href="#merge-node-maps"></a></h3>
    <p>This algorithm creates a new map of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subjects</a> to <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a> using all graphs
      contained in the <var>graph map</var> created using the <a href="#node-map-generation">Node Map Generation algorithm</a>
      to create merged <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a> containing information defined for a given <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a>
      in each graph contained in the <var>node map</var>.</p>

    <ol>
      <li>Create <var>result</var> as an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a></li>
      <li>For each <var>graph name</var> and <var>node map</var> in <var>graph map</var>
        and for each <var>id</var> and <var>node</var> in <var>node map</var>:
        <ol>
          <li>Initialize <var>merged node</var> to the value for <var>id</var> in <var>result</var>, initializing it
            with a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose value is <var>id</var>, if it does not exist.</li>
          <li>For each <var>property</var> and <var>values</var> in <var>node</var>:
            <ol>
              <li>If <var>property</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>, add <var>property</var> and values to <var>merged node</var>.</li>
              <li>Otherwise, merge each element from <var>values</var> into the values for <var>property</var>
                in <var>merged node</var>, initializing it to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> if necessary.</li>
            </ol>
          </li>
        </ol>
      </li>
      <li>Return <var>result</var>.</li>
    </ol>
  </section> 

  <section id="generate-blank-node-identifier"><h3 id="x7-4-generate-blank-node-identifier"><bdi class="secno">7.4 </bdi>Generate Blank Node Identifier<a class="self-link" aria-label="§" href="#generate-blank-node-identifier"></a></h3>

    <p>This algorithm is used to generate new
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> or to
      relabel an existing <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> to avoid collision
      by the introduction of new ones.</p>

    <section class="informative" id="overview-11">
      <h4 id="x7-4-1-overview"><bdi class="secno">7.4.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-11"></a></h4><p><em>This section is non-normative.</em></p>

      <p>The simplest case is if there exists already a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        in the <var>identifier map</var> for the passed <var>identifier</var>, in which
        case it is simply returned. Otherwise, a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        is generated. If the passed <var>identifier</var> is not <code>null</code>,
        an entry is created in the <var>identifier map</var> associating the
        <var>identifier</var> with the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-11">
      <h4 id="x7-4-2-algorithm"><bdi class="secno">7.4.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-11"></a></h4>

      <p>The algorithm takes a single input variable <var>identifier</var> which may
        be <code>null</code>. The algorithm
        maintains an <var>identifier map</var> to relabel existing
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>,
        <span class="changed">which is reset when the invoking algorithm is initialized</span>.</p>

      <ol>
        <li>If <var>identifier</var> is not <code>null</code> and has an entry in the
          <var>identifier map</var>, return the mapped identifier.</li>
        <li>Otherwise, generate a new unique <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</li>
        <li>If <var>identifier</var> is not <code>null</code>, create a new entry
          for <var>identifier</var> in <var>identifier map</var> and set its value
          to the new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</li>
        <li>Return the new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</li>
      </ol>

    <div class="note" role="note" id="issue-container-generatedID-23"><div role="heading" class="note-title marker" id="h-note-23" aria-level="5"><span>Note</span></div><p class="">
      One way of generating new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> is to maintain a counter
      and increment it when generating a new identifier and appending it to
      a string such as <code>_:b</code>.
    </p></div>
    </section>
  </section> 

</section> 

<section id="rdf-serialization-deserialization-algorithms"><h2 id="x8-rdf-serialization-deserialization-algorithms"><bdi class="secno">8. </bdi>RDF Serialization/Deserialization Algorithms<a class="self-link" aria-label="§" href="#rdf-serialization-deserialization-algorithms"></a></h2>

  <p>This section describes algorithms to deserialize a JSON-LD document to an
    <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a> and vice versa. The algorithms are designed for in-memory
    implementations with random access to <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> elements.</p>

  <section id="deserialize-json-ld-to-rdf-algorithm"><h3 id="x8-1-deserialize-json-ld-to-rdf-algorithm"><bdi class="secno">8.1 </bdi>Deserialize JSON-LD to RDF Algorithm<a class="self-link" aria-label="§" href="#deserialize-json-ld-to-rdf-algorithm"></a></h3>

    <p>This algorithm deserializes a JSON-LD document to an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>.
      Please note that RDF does not allow a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> to be used
      as a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a>, while JSON-LD does. Therefore, by default
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> that would have contained blank nodes as <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> are
      discarded when interpreting JSON-LD as RDF.</p>

    <div class="note" role="note" id="issue-container-generatedID-24"><div role="heading" class="note-title marker" id="h-note-24" aria-level="4"><span>Note</span></div><p class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
      and may be removed in a future version of JSON-LD.</p></div>

    <p class="changed">If the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> option is not <code>null</code>, then special processing is used to
      convert from an <code>i18n-datatype</code> or <code>compound-literal</code> form.</p>

    <div class="issue atrisk" id="issue-container-generatedID-25"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><span>(Feature at Risk) Issue</span></div><p class="atrisk">The support for both <code>i18n-datatype</code> and <code>compound-literal</code>
      algorithm steps are non-normative, and are AT RISK for JSON-LD 1.1.
      They may be replaced with normative algorithm steps in a future version.
      Either or both of these transformation methods may be removed prior to
      JSON-LD 1.1 being finalized.
      The JSON-LD Working Group solicits feedback from the community on the
      usefulness of these transformations.</p></div>

    <p class="changed">Implementations <em class="rfc2119" title="MUST">MUST</em> generate only <dfn data-dfn-type="dfn" id="dfn-well-formed">well-formed</dfn>
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph names</a>:</p>
    <ul>
      <li>An <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> is <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> if it matches the
        <a href="https://tools.ietf.org/html/rfc3987#section-2.2">ABNF for <strong><abbr title="Internationalized Resource Identifier">IRI</abbr></strong></a> as
        described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3987" title="Internationalized Resource Identifiers (IRIs)">RFC3987</a></cite>].</li>
      <li>A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> is <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> if it matches the
        <a href="https://www.w3.org/TR/turtle/#sec-grammar-grammar">EBNF for
        <strong>BLANK_NODE_LABEL</strong></a> as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-turtle" title="RDF 1.1 Turtle">Turtle</a></cite>].
        <div class="note" role="note" id="issue-container-generatedID-26"><div role="heading" class="note-title marker" id="h-note-25" aria-level="4"><span>Note</span></div><div class="">When following the algorithm described here,
          all blank node identifiers will be normalized using the <a href="#generate-blank-node-identifier">Generate Blank Node Identifier
          algorithm</a> and automatically adhere to this form.</div></div>
      </li>
      <li>A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a> is <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> if it has the
        <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a> of a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, any <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> is
        <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a>, and any <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> is <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a>
        according to <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>].</li>
    </ul>

    <section class="informative" id="overview-12">
      <h4 id="x8-1-1-overview"><bdi class="secno">8.1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-12"></a></h4><p><em>This section is non-normative.</em></p>

      <p>The JSON-LD document is expanded and converted to a <var>node map</var> using the
        <a href="#node-map-generation">Node Map Generation algorithm</a>.
        This allows each graph represented within the document to be
        extracted and flattened, making it easier to process each
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.
        Each graph from the <var>node map</var> is processed to extract <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>,
        to which any (non-default) graph name is applied to create an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>.
        Each <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> in the <var>node map</var> has an <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
        which corresponds to the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a>,
        the other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> represent <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a>.
        Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> value is either an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        or can be transformed to an<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a>
        to generate an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">Lists</a> are transformed into an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">RDF collection</a>
        using the <a href="#list-to-rdf-conversion">List to RDF Conversion algorithm.</a></p>
    </section>

    <section class="algorithm" id="algorithm-12">
      <h4 id="x8-1-2-algorithm"><bdi class="secno">8.1.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-12"></a></h4>

      <p>The algorithm takes a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>node map</var>, which
        is the result of the <a href="#node-map-generation">Node Map Generation algorithm</a> and
        an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a> <var>dataset</var> into which new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graphs</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> are added.
        It also takes two optional input variables <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a>
        and <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a></span>.
        Unless the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option
        is set to <code>true</code>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>
        containing a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>
        are excluded from output.</p>

      <div class="note" role="note" id="issue-container-generatedID-27"><div role="heading" class="note-title marker" id="h-note-26" aria-level="5"><span>Note</span></div><p class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
        and may be removed in a future version of JSON-LD,
        as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>
        and thus the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option may be also be removed.</p></div>

      <ol>
        <li>For each <var>graph name</var> and <var>graph</var> in <var>node map</var>
          ordered by <var>graph name</var>:
          <ol>
            <li>If <var>graph name</var> is
              <span class="changed">not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a></span>, continue
              with the next <var>graph name</var>-<var>graph</var> pair.</li>
            <li id="alg-jld2rdf-init-triples" class="changed">If <var>graph name</var> is <code>@default</code>,
              initialize <var>triples</var> to the value of the <a data-link-for="RdfDataset" href="#dom-rdfdataset-defaultgraph" class="internalDFN" data-link-type="idl"><code>defaultGraph</code></a>
              attribute of <var>dataset</var>.
              Otherwise, initialize <var>triples</var> as an empty <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>
              and add to <var>dataset</var> using its
              <a data-xref-type="attribute|dict-member" data-link-for="RdfDataset" data-xref-for="RdfDataset" href="#dom-rdfdataset-add" class="internalDFN" data-link-type="idl"><code><code>add</code></code></a> method along with <var>graph name</var>
              for <a data-lt="RdfDataset-add-graphName" href="#dfn-rdfdataset-add-graphname" class="internalDFN" data-link-type="dfn"><code>graphName</code></a>.</li>
            <li>For each <var>subject</var> and <var>node</var> in <var>graph</var> ordered
              by <var>subject</var>:
              <ol>
                <li>If <var>subject</var> is
                  <span class="changed">not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a></span>, continue
                  with the next <var>subject</var>-<var>node</var> pair.</li>
                <li>For each <var>property</var> and <var>values</var> in <var>node</var>
                  ordered by <var>property</var>:
                  <ol>
                    <li>If <var>property</var> is <code>@type</code>, then for each
                      <var>type</var> in <var>values</var>,
                      create a new <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a>
                      composed of <var>subject</var>, <code>rdf:type</code> for <a data-link-for="RdfTriple" href="#dom-rdftriple-predicate" class="internalDFN" data-link-type="idl"><code>predicate</code></a>,
                      and <var>type</var> for <a data-link-for="RdfTriple" href="#dom-rdftriple-object" class="internalDFN" data-link-type="idl"><code>object</code></a>
                      <span class="changed">and add to <var>triples</var>
                      using its <a data-xref-type="attribute|dict-member" data-link-for="RdfGraph" data-xref-for="RdfGraph" href="#dom-rdfgraph-add" class="internalDFN" data-link-type="idl"><code><code>add</code></code></a> method,
                      unless <var>type</var> is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a></span>.</li>
                    <li>Otherwise, if <var>property</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
                      continue with the next <var>property</var>-<var>values</var> pair.</li>
                    <li>Otherwise, if <var>property</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> and
                      the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option is not <code>true</code>,
                      continue with the next <var>property</var>-<var>values</var> pair.
                      <div class="note" role="note" id="issue-container-generatedID-28"><div role="heading" class="note-title marker" id="h-note-27" aria-level="5"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
                        and may be removed in a future version of JSON-LD,
                        as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>
                        and thus the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option may be also be removed.</div></div>
                      </li>
                    <li>Otherwise, if <var>property</var> is
                      <span class="changed">not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a></span>,
                      continue with the next <var>property</var>-<var>values</var> pair.</li>
                    <li>Otherwise, <var>property</var> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or
                      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>. For each <var>item</var>
                      in <var>values</var>:
                      <ol>
                        <li id="alg-jld2rdf-init-list-triples" class="changed">Initialize <var>list triples</var> as an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.
                          <div class="note" role="note" id="issue-container-generatedID-29"><div role="heading" class="note-title marker" id="h-note-28" aria-level="5"><span>Note</span></div><div class="">
                            <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>, <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>,
                            or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.</div></div>
                        </li>
                        <li id="alg-jld2rdf-add-list-triples">Add a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>
                          composed of <var>subject</var>, <var>property</var>, and
                          the result of using the
                          <a href="#object-to-rdf-conversion">Object to RDF Conversion algorithm</a>
                          passing <var>item</var>
                          <span class="changed">and <var>list triples</var></span>
                          to <var>triples</var> using its <a data-xref-type="attribute|dict-member" data-link-for="RdfGraph" data-xref-for="RdfGraph" href="#dom-rdfgraph-add" class="internalDFN" data-link-type="idl"><code><code>add</code></code></a> method,
                          unless the result is <code>null</code>,
                          indicating a <span class="changed">non-<a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-resource">resource</a></span>
                          that has to be ignored.</li>
                        <li class="changed">Add all <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> instances from
                          <var>list triples</var> to <var>triples</var> using
                          its using its <a data-xref-type="attribute|dict-member" data-link-for="RdfGraph" data-xref-for="RdfGraph" href="#dom-rdfgraph-add" class="internalDFN" data-link-type="idl"><code><code>add</code></code></a> method.</li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </section>
  </section> 

  <section id="object-to-rdf-conversion"><h3 id="x8-2-object-to-rdf-conversion"><bdi class="secno">8.2 </bdi>Object to RDF Conversion<a class="self-link" aria-label="§" href="#object-to-rdf-conversion"></a></h3>

    <p>This algorithm takes a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>, <a class="changed" data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>
      and transforms it into an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-resource">resource</a> to be used as the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.
      If a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> containing a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> is passed to
      the algorithm, <code>null</code> is returned which then causes the resulting
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a> to be ignored.
      <span class="changed">If the input is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, it will also
        return the triples created from that input.</span></p>

    <section class="informative" id="overview-13">
      <h4 id="x8-2-1-overview"><bdi class="secno">8.2.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-13"></a></h4><p><em>This section is non-normative.</em></p>

      <p><a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">Value objects</a> are transformed to
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> as described in
        <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>
        whereas <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a> are transformed
        to <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>,
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>,
        or <code>null</code>.</p>
    </section>

    <section class="algorithm" id="algorithm-13">
      <h4 id="x8-2-2-algorithm"><bdi class="secno">8.2.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-13"></a></h4>

      <p>The algorithm takes as two arguments <var>item</var> which <em class="rfc2119" title="MUST">MUST</em> be
        either a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>, or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>
        and <var>list triples</var>, which is an empty array.</p>

      <ol>
        <li>If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> and the value of
          its <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> is
          <span class="changed">not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a></span>, return
          <code>null</code>.</li>
        <li>If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>, return the
          <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> associated
          with its <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
        <li class="changed">If <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>
          return the result of the
          <a href="#list-to-rdf-conversion">List Conversion algorithm</a>, passing
          the value associated with the <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from
          <var>item</var> and <var>list triples</var>.
        </li>
        <li>Otherwise, <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>. Initialize
          <var>value</var> to the value associated with the <code>@value</code>
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>item</var>.
        </li><li>Initialize <var>datatype</var> to the value associated with the
          <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>item</var> or <code>null</code> if
          <var>item</var> does not have such an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
        <li id="alg-obj2rdf-datatype" class="changed">If <var>datatype</var> is not <code>null</code>
          and neither a <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> nor <code>@json</code>,
          return <code>null</code>.</li>
        <li class="changed">If <var>item</var> has an <code>@language</code>
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> which is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a>, return <code>null</code>.</li>
        <li class="changed">If <var>datatype</var> is <code>@json</code>,
          convert <var>value</var> to the <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a>
          using the result of transforming the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> of <var>value</var>
          to JSON and set <var>datatype</var> to <code>rdf:JSON</code>.
          <div class="issue" id="issue-container-generatedID-30"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="5"><span>Issue</span></div><div class="">The JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-jcs" title="JSON Canonicalization Scheme (JCS)">JCS</a></cite>]
            is an emerging standard for JSON canonicalization
            not yet ready to be referenced.
            When a JSON canonicalization standard becomes available,
            this specification will likely be updated to require such a canonical representation.
            Users are cautioned from depending on the
            <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a> lexical representation as an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a>,
            as the specifics of serialization may change in a future revision of this document.</div></div></li>
        <li>If <var>value</var> is <code>true</code> or
          <code>false</code>, set <var>value</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>
          <code>true</code> or <code>false</code> which is the
          <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> as described in
          <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>
          If <var>datatype</var> is <code>null</code>,
          set <var>datatype</var> to <code>xsd:boolean</code>.</li>
        <li id="alg-obj2rdf-double">Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> with a non-zero fractional
          part (the result of a modulo‑1 operation)
          <span class="changed">or an absolute value greater or equal to 10<sup>21</sup></span>,
          or <var>value</var> is a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>
          and <var>datatype</var> equals <code>xsd:double</code>, convert <var>value</var> to a
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> in <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of
          an <a href="https://www.w3.org/TR/xmlschema11-2/#double"><code>xsd:double</code></a> as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>]
          and described in
          <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>.
          If <var>datatype</var> is <code>null</code>,
          set <var>datatype</var> to <code>xsd:double</code>.</li>
        <li id="alg-obj2rdf-integer">Otherwise, if <var>value</var> is a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>,
          convert it to a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> in <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of
          an <a href="https://www.w3.org/TR/xmlschema11-2/#integer"><code>xsd:integer</code></a> as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>]
          and described in
          <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>.
          If <var>datatype</var> is <code>null</code>,
          set <var>datatype</var> to <code>xsd:integer</code>.
          <div class="note" role="note" id="issue-container-generatedID-31"><div role="heading" class="note-title marker" id="h-note-29" aria-level="5"><span>Note</span></div><div class="">It follows from the previous step that <var>value</var>
            has no non-zero fractional part.</div></div></li>
        <li>Otherwise, if <var>datatype</var> is <code>null</code>,
          set <var>datatype</var> to <code>xsd:string</code> or <code>rdf:langString</code>,
          depending on if item has an <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>.</li>
        <li class="changed">If <var>item</var> contains an <code>@direction</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
          and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> is not <code>null</code>,
          <var>item</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> which is serialized using special rules.
          <ol>
            <li id="alg-obj2rdf-direction-language">
              Initialize <var>language</var> to the value of <code>@language</code> in <var>item</var>
              normalized to lower case,
              or the empty string (<code>""</code>) if there is no such entry.
              <div class="note" role="note" id="issue-container-generatedID-32"><div role="heading" class="note-title marker" id="h-note-30" aria-level="5"><span>Note</span></div><div class="">Generally, language tags are not normalized,
                but when creating an <code>i18n-datatype</code> or <code>compound-literal</code>
                values are normalized to lower case for improved interoperability.</div></div>
            </li>
            <li>If <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> is <code>i18n-datatype</code>,
              set <var>datatype</var> to the result of appending <var>language</var>
              and the value of <code>@direction</code> in <var>item</var> separated by an underscore (<code>"_"</code>)
              to <code>https://www.w3.org/ns/i18n#</code>.
              Initialize <var>literal</var> as an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a> using
              <var>value</var> and <var>datatype</var>.
              <div class="note" role="note" id="issue-container-generatedID-33"><div role="heading" class="note-title marker" id="h-note-31" aria-level="5"><span>Note</span></div><div class="changed">Processors <em class="rfc2119" title="MAY">MAY</em> normalize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> to lower case.</div></div>
              <div class="note" role="note" id="issue-container-generatedID-34"><div role="heading" class="note-title marker" id="h-note-32" aria-level="5"><span>Note</span></div><div class="">As <code>@direction</code> may be used without <code>@language</code>,
                it is possible, and legitimate, to create a datatype <abbr title="Internationalized Resource Identifier">IRI</abbr>
                such as <code>http://w3.org/ns/i18n#_ltr</code>, which does not encode a language tag.</div></div></li>
            <li>Otherwise, if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> is <code>compound-literal</code>:
              <ol>
                <li>Initialize <var>literal</var> as a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>.</li>
                <li>Create a new triple using <var>literal</var> as the subject,
                  <code>rdf:value</code> as the predicate, and the value of <code>@value</code> in <var>item</var>
                  as the object, and add it to <var>list triples</var>.</li>
                <li>If the <var>item</var> has an entry for <code>@language</code>,
                  create a new triple using <var>literal</var> as the subject,
                  <code>rdf:language</code> as the predicate, and <var>language</var>
                  as the object, and add it to <var>list triples</var>.</li>
                <li>Create a new triple using <var>literal</var> as the subject,
                  <code>rdf:direction</code> as the predicate, and the value of <code>@direction</code> in <var>item</var>
                  as the object, and add it to <var>list triples</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>Otherwise, initialize <var>literal</var> as an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a> using
          <var>value</var> and <var>datatype</var>. If <var>item</var> has an
          <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, add the value associated with the
          <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> as the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> of <var>literal</var>.</li>
        <li>Return <var>literal</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="list-to-rdf-conversion"><h3 id="x8-3-list-to-rdf-conversion"><bdi class="secno">8.3 </bdi>List to RDF Conversion<a class="self-link" aria-label="§" href="#list-to-rdf-conversion"></a></h3>

    <p>List Conversion is the process of taking a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>
      and transforming it into an
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">RDF collection</a>
      as defined in RDF Semantics [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-mt" title="RDF 1.1 Semantics">RDF11-MT</a></cite>].</p>

    <section class="informative" id="overview-14">
      <h4 id="x8-3-1-overview"><bdi class="secno">8.3.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-14"></a></h4><p><em>This section is non-normative.</em></p>

      <p>For each element of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a> a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        is allocated which is used to generate <code>rdf:first</code> and
        <code>rdf:rest</code>. The
        algorithm returns the list head, which is either the first allocated
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> or <code>rdf:nil</code> if the
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a> is empty. If a list element represents an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
        the corresponding <code>rdf:first</code> triple is omitted.</p>
    </section>

    <section class="algorithm" id="algorithm-14">
      <h4 id="x8-3-2-algorithm"><bdi class="secno">8.3.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-14"></a></h4>

      <p>The algorithm takes two inputs: an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>list</var>
        and an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>list triples</var> used for returning
        the generated <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a>.</p>

      <ol>
        <li>If <var>list</var> is empty, return <code>rdf:nil</code>.</li>
        <li>Otherwise, create an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>bnodes</var> composed of a
          <a href="#generate-blank-node-identifier">newly generated blank node identifier</a>
          for each entry in <var>list</var>.</li>
        <li>For each pair of <var>subject</var> from <var>bnodes</var> and <var>item</var> from <var>list</var>:
          <ol>
            <li class="changed">Initialize <var>embedded triples</var> to a new empty array.</li>
            <li>Initialize <var>object</var> to the result of using the
              <a href="#object-to-rdf-conversion">Object to RDF Conversion algorithm</a>
              passing <var>item</var>
              <span class="changed">and <var>embedded triples</var> for <var>list triples</var></span>.</li>
            <li>Unless <var>object</var> is <code>null</code>, append a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>
              composed of <var>subject</var>, <code>rdf:first</code>, and <var>object</var>
              to <var>list triples</var>.</li>
            <li>Initialize <var>rest</var> as the next entry in <var>bnodes</var>, or if that
              does not exist, <code>rdf:nil</code>. Append a
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a> composed of <var>subject</var>,
              <code>rdf:rest</code>, and <var>rest</var> to <var>list triples</var>.</li>
            <li class="changed">Append all values from <var>embedded triples</var> to <var>list triples</var></li>
          </ol>
        </li>
        <li>Return the first <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> from <var>bnodes</var> or
          <code>rdf:nil</code> if <var>bnodes</var> is empty.</li>
      </ol>
    </section>
  </section> 

  <section class="algorithm" id="serialize-rdf-as-json-ld-algorithm"><h3 id="x8-4-serialize-rdf-as-json-ld-algorithm"><bdi class="secno">8.4 </bdi>Serialize RDF as JSON-LD Algorithm<a class="self-link" aria-label="§" href="#serialize-rdf-as-json-ld-algorithm"></a></h3>

    <p>This algorithm serializes an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a> consisting of a
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> and zero or more
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graphs</a> into a JSON-LD document.</p>

    <p>In the RDF abstract syntax, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> have a
      <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form"><dfn data-dfn-type="dfn" id="dfn-lexical-form">lexical form</dfn></a>, as defined
      in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>]. The form of these literals is used when creating <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-value">JSON-LD values</a> based on these literals.</p>

    <section class="informative" id="overview-15">
      <h4 id="x8-4-1-overview"><bdi class="secno">8.4.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-15"></a></h4><p><em>This section is non-normative.</em></p>

      <p>Iterate through each graph in the dataset, converting each
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">RDF collection</a> into a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">list</a>
        and generating a JSON-LD document in expanded form for all
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a>, <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a>
        and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>.
        If the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a> flag is set to <code>true</code>,
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> with a
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        that equals <code>xsd:integer</code> or <code>xsd:double</code> are converted
        to a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">JSON numbers</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a>
        with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        that equals <code>xsd:boolean</code> are converted to <code>true</code> or
        <code>false</code> based on their
        <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
        as described in
        <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>.
        Unless the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-userdftype" class="internalDFN" data-link-type="idl"><code>useRdfType</code></a> flag is set to true, <code>rdf:type</code>
        predicates will be serialized as <code>@type</code> as long as the associated object is
        either an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.</p>

      <p class="changed">If the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> option is not <code>null</code>, then special processing is used to
        convert from an <code>i18n-datatype</code> or <code>compound-literal</code> form.</p>

      <div class="issue atrisk" id="issue-container-generatedID-35"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="5"><span>(Feature at Risk) Issue</span></div><p class="atrisk">The support for both <code>i18n-datatype</code> and <code>compound-literal</code>
        algorithm steps are non-normative, and are AT RISK for JSON-LD 1.1.
        They may be replaced with normative algorithm steps in a future version.
        Either or both of these transformation methods may be removed prior to
        JSON-LD 1.1 being finalized.
        The JSON-LD Working Group solicits feedback from the community on the
        usefulness of these transformations.</p></div>
    </section>

    <section id="algorithm-15">
      <h4 id="x8-4-2-algorithm"><bdi class="secno">8.4.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-15"></a></h4>

      <p>The algorithm takes one required and five optional inputs:
        an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a> <var>dataset</var>
        and the five flags
        <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a>, used to order
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> keys lexicographically, where noted</span>,
        <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a></span>,
        <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a>,
        and the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-userdftype" class="internalDFN" data-link-type="idl"><code>useRdfType</code></a>,
        that all default to <code>false</code>.</p>

      <p>The <var>dataset</var> is <a data-link-for="RdfDataset" href="#dfn-iterable" class="internalDFN" data-link-type="dfn"><code>iterable</code></a> to iterate over <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graphs</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph names</a>
        contained within the <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>. Each <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> is also <a data-link-for="RdfGraph" href="#dfn-iterable-0" class="internalDFN" data-link-type="dfn"><code>iterable</code></a>
        for iterating over <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> contained within the <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>.</p>

      <ol>
        <li>Initialize <var>default graph</var> to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li>Initialize <var>graph map</var> to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting
          of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@default</code> whose value references
          <var>default graph</var>.</li>
        <li class="changed">Initialize <var>referenced once</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li class="changed">Initialize <var>compound literal subjects</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
        <li>For each <var>graph</var> in  <var>dataset</var>:
          <ol>
            <li>If <var>graph</var> is the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a>,
              initialize <var>name</var> to <code>@default</code>, otherwise to the
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a> associated with <var>graph</var>.</li>
            <li>If <var>graph map</var> has no <var>name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set
              its value to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
            <li>If <var>compound literal subjects</var> has no <var>name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one and set
              its value to an empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
            <li>If <var>graph</var> is not the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> and
              <var>default graph</var> does not have a <var>name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
              create such an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> and initialize its value to a new
              <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code>
              whose value is <var>name</var>.</li>
            <li>Reference the value of the <var>name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>graph map</var>
              using the variable <var>node map</var>.</li>
            <li class="changed">Reference the value of the <var>name</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>compound literal subjects</var>
              using the variable <var>compound map</var>.</li>
            <li>For each <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a> in <var>graph</var>
              consisting of <var>subject</var>, <var>predicate</var>, and <var>object</var>:
              <ol>
                <li>If <var>node map</var> does not have a <var>subject</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and initialize its value to a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
                  consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose value is
                  set to <var>subject</var>.</li>
                <li>Reference the value of the <var>subject</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in <var>node map</var>
                  using the variable <var>node</var>.</li>
                <li class="changed">If the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> option
                  is <code>compound-literal</code> and <var>predicate</var> is <code>rdf:direction</code>,
                  add an entry in <var>compound map</var> for <var>subject</var> with the value <code>true</code>.</li>
                <li>If <var>object</var> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
                  and <var>node map</var> does not have an <var>object</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                  create one and initialize its value to a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
                  consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose value is
                  set to <var>object</var>.</li>
                <li>If <var>predicate</var> equals <code>rdf:type</code>, the
                  <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-userdftype" class="internalDFN" data-link-type="idl"><code>useRdfType</code></a> flag is not <code>true</code>, and <var>object</var>
                  is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
                  append <var>object</var> to the value of the <code>@type</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var>; unless such an item already exists.
                  If no such <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> exists, create one
                  and initialize it to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> whose only item is
                  <var>object</var>. Finally, continue to the next
                  <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</li>
                <li>Initialize <var>value</var> to the result of using the
                  <a href="#rdf-to-object-conversion">RDF to Object Conversion algorithm</a>,
                  passing <var>object</var>,
                  <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a></span>,
                  and <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a>.</li>
                <li>If <var>node</var> does not have a <var>predicate</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, create one
                  and initialize its value to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li>If there is no item equivalent to <var>value</var> in the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
                  associated with the <var>predicate</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var>, append a
                  reference to <var>value</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. Two <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>
                  are considered equal if they have equivalent <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>.</li>
                <li class="changed">If <var>object</var> is <code>rdf:nil</code>, it represents
                  the termination of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">RDF collection</a>:
                  <ol>
                    <li>Reference the <code>usages</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of the <var>object</var>
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node map</var> using the variable <var>usages</var>.</li>
                    <li>Append a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of three
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>, <code>node</code>, <code>property</code>, and <code>value</code>
                      to the <var>usages</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. The <code>node</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      is set to a reference to <var>node</var>, <code>property</code> to <var>predicate</var>,
                      and <code>value</code> to a reference to <var>value</var>.</li>
                  </ol>
                </li>
                <li class="changed">Otherwise, if <var>referenced once</var> has an entry for <var>object</var>,
                  set the <var>object</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>referenced once</var> to <code>false</code>.</li>
                <li class="changed">Otherwise, if <var>object</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
                  it might represent a list node:
                  <ol>
                    <li>Set the <var>object</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>referenced once</var> to a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> consisting of three
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>, <code>node</code>, <code>property</code>, and <code>value</code>
                      to the <var>usages</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>. The <code>node</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      is set to a reference to <var>node</var>, <code>property</code> to <var>predicate</var>,
                      and <code>value</code> to a reference to <var>value</var>.</li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li>For each <var>name</var> and <var>graph object</var> in <var>graph map</var>:
          <ol>
            <li class="change">If <var>compound literal subjects</var>
              has an entry for <var>name</var>, then for each <var>cl</var>
              which is a key in that entry:
              <ol>
                <li>Initialize <var>cl entry</var> to the value of <var>cl</var>
                  in <var>referenced once</var>,
                  continuing to the next <var>cl</var> if <var>cl entry</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                <li>Initialize <var>node</var> to the value of <code>node</code> in <var>cl entry</var>.</li>
                <li>Initialize <var>property</var> to value of <code>property</code> in <var>cl entry</var>.</li>
                <li>Initialize <var>value</var> to value of <code>value</code> in <var>cl entry</var>.</li>
                <li>Initialize <var>cl node</var> to the value of <var>cl</var>
                  in <var>graph object</var>, and remove that <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>graph object</var>,
                  continuing to the next <var>cl</var> if <var>cl node</var> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
                <li>For each <var>cl reference</var> in the value of <var>property</var> in <var>node</var>
                  where the value of <code>@id</code> in <var>cl reference</var> is <var>cl</var>:
                  <ol>
                    <li>Delete the <code>@id</code> entry in <var>node</var>.</li>
                    <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>node</var> for <code>@value</code> with the value taken
                      from the <code>rdf:value</code> entry in <var>cl node</var>.</li>
                    <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>node</var> for <code>@language</code> with the value taken
                      from the <code>rdf:language</code> entry in <var>cl node</var>, if any.
                      If that value is not <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> according to
                      <a href="https://tools.ietf.org/html/bcp47#section-2.2.9">section 2.2.9</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>],
                      an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-language-tagged-string" class="internalDFN" data-link-type="idl"><code>invalid language-tagged string</code></a>
                      error has been detected and processing is aborted.</li>
                    <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>node</var> for <code>@direction</code> with the value taken
                      from the <code>rdf:direction</code> entry in <var>cl node</var>, if any.
                      If that value is not <code>"ltr"</code> or <code>"rtl"</code>, an
                      <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-base-direction" class="internalDFN" data-link-type="idl"><code>invalid base direction</code></a>
                      error has been detected and processing is aborted.</li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>If <var>graph object</var> has no <code>rdf:nil</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, continue
              with the next <var>name</var>-<var>graph object</var> pair as the graph does
              not contain any lists that need to be converted.</li>
            <li>Initialize <var>nil</var> to the value of the <code>rdf:nil</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
              of <var>graph object</var>.</li>
            <li>For each item <var>usage</var> in the <code>usages</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
              <var>nil</var>, perform the following steps:
              <ol>
                <li>Initialize <var>node</var> to the value of the value of the
                  <code>node</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>usage</var>, <var>property</var> to
                  the value of the <code>property</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>usage</var>,
                  and <var>head</var> to the value of the <code>value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                  of <var>usage</var>.</li>
                <li>Initialize two empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">arrays</a> <var>list</var>
                  and <var>list nodes</var>.</li>
                <li>While <var>property</var> equals <code>rdf:rest</code>,
                  <span class="changed">the value of the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                    of <var>node</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,</span>
                  the value of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>referenced once</var> associated with the <code>@id</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <code>node</code> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
                  <var>node</var> has <code>rdf:first</code> and <code>rdf:rest</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>,
                  both of which have as value an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> consisting of a single element,
                  and <var>node</var> has no other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> apart from an optional <code>@type</code>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> whose value is an array with a single item equal to
                  <code>rdf:List</code>,
                  <var>node</var> represents a <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> list node.
                  Perform the following steps to traverse the list backwards towards its head:
                  <ol>
                    <li>Append the only item of <code>rdf:first</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
                      <var>node</var> to the <var>list</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                    <li>Append the value of the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
                      <var>node</var> to the <var>list nodes</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                    <li>Initialize <var>node usage</var> to the value of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>referenced once</var> associated with the <code>@id</code>
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <code>node</code>.</li>
                    <li>Set <var>node</var> to the value of the <code>node</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      of <var>node usage</var>, <var>property</var> to the value of the
                      <code>property</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node usage</var>, and
                      <var>head</var> to the value of the <code>value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                      of <var>node usage</var>.</li>
                    <li>If the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var> is an
                      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> instead of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>,
                      exit the while loop.</li>
                  </ol>
                </li>
                <li>Remove the <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>head</var>.</li>
                <li>Reverse the order of the <var>list</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li>Add an <code>@list</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>head</var> and initialize
                  its value to the <var>list</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li>For each item <var>node id</var> in <var>list nodes</var>, remove the
                  <var>node id</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> from <var>graph object</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li>Initialize an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> <var>result</var>.</li>
        <li>For each <var>subject</var> and <var>node</var> in <var>default graph</var>
          ordered lexicographically by <var>subject</var>
          <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>:
          <ol>
            <li>If <var>graph map</var> has a <var>subject</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>:
              <ol>
                <li>Add an <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>node</var> and initialize
                  its value to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
                <li>For each key-value pair <var>s</var>-<var>n</var> in the <var>subject</var>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>graph map</var> ordered lexicographically by <var>s</var>
                  <span class="changed">if <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> is <code>true</code></span>,
                  append <var>n</var> to the <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>node</var> after
                  removing its <code>usages</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, unless the only
                  remaining <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of <var>n</var> is <code>@id</code>.</li>
              </ol>
            </li>
            <li>Append <var>node</var> to <var>result</var> after removing its
              <code>usages</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, unless the only remaining <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of
              <var>node</var> is <code>@id</code>.</li>
          </ol>
        </li>
        <li>Return <var>result</var>.</li>
      </ol>
    </section>
  </section> 

  <section id="rdf-to-object-conversion"><h3 id="x8-5-rdf-to-object-conversion"><bdi class="secno">8.5 </bdi>RDF to Object Conversion<a class="self-link" aria-label="§" href="#rdf-to-object-conversion"></a></h3>

    <p>This algorithm transforms an RDF literal to a JSON-LD <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>
      and a RDF <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> or <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> to an JSON-LD <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.</p>

    <section class="informative" id="overview-16">
      <h4 id="x8-5-1-overview"><bdi class="secno">8.5.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview-16"></a></h4><p><em>This section is non-normative.</em></p>

      <p><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> are transformed to
        <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value objects</a> whereas <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> and
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> are
        transformed to <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.</p>
      <p class="changed">Literals with datatype <code>rdf:JSON</code>
        are transformed into a value object using the internal representation
        based on the lexical-to-value mapping defined in
        <a class="externalDfn" href="https://www.w3.org/TR/json-ld11/#the-rdf-json-datatype">JSON datatype</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>],
        and <code>@type</code> of <code>@json</code>.</p>
      <p class="changed">With the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> option set to <code>i18n-datatype</code>,
        literals with datatype starting with <code>https://www.w3.org/ns/i18n#</code>
        are transformed into a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> by decoding
        the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> from the datatype.</p>
      <p class="changed">With the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> option set to <code>compound-literal</code>,
        blank node objects using <code>rdf:direction</code> are
        are transformed into a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> by decoding
        the <code>rdf:value</code>, <code>rdf:language</code>, and <code>rdf:direction</code> properties.</p>
      <p>If the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a> flag is set to <code>true</code>,
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> with a
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        that equals <code>xsd:integer</code> or <code>xsd:double</code> are converted
        to a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">JSON numbers</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a>
        with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
        that equals <code>xsd:boolean</code> are converted to <code>true</code> or
        <code>false</code> based on their
        <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
        as described in
        <a class="sectionRef sec-ref" href="#data-round-tripping">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>.</p>
    </section>

    <section class="algorithm" id="algorithm-16">
      <h4 id="x8-5-2-algorithm"><bdi class="secno">8.5.2 </bdi>Algorithm<a class="self-link" aria-label="§" href="#algorithm-16"></a></h4>

      <p>This algorithm takes three required inputs:
        a <var>value</var> to be converted to a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
        <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a></span>,
        and a flag <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a>.</p>

      <ol>
        <li>If <var>value</var> is an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or a
          <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, return a new <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
          consisting of a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@id</code> whose value is set to
          <var>value</var>.</li>
        <li>Otherwise <var>value</var> is an
          <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a>:
          <ol>
            <li>Initialize a new empty <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> result.</li>
            <li>Initialize <var>converted value</var> to <var>value</var>.</li>
            <li>Initialize <var>type</var> to <code>null</code></li>
            <li>If <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a> is <code>true</code>
              <ol>
                <li>If the
                  <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
                  of <var>value</var> equals <code>xsd:string</code>, set
                  <var>converted value</var> to the
                  <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
                  of <var>value</var>.</li>
                <li>Otherwise, if the
                  <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
                  of <var>value</var> equals <code>xsd:boolean</code>, set
                  <var>converted value</var> to <code>true</code> if the
                  <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
                  of <var>value</var> matches <code>true</code>, or <code>false</code>
                  if it matches <code>false</code>. If it matches neither,
                  set <var>type</var> to <code>xsd:boolean</code>.</li>
                <li>Otherwise, if the
                  <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
                  of <var>value</var> equals <code>xsd:integer</code> or
                  <code>xsd:double</code> and its
                  <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
                  is a valid <code>xsd:integer</code> or <code>xsd:double</code>
                  according [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>], set <var>converted value</var>
                  to the result of converting the
                  <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a>
                  to a JSON <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>.</li>
              </ol>
            </li>
            <li class="changed">Otherwise, if <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is not <code>json-ld-1.0</code>,
              and <var>value</var> is a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a>,
              set <var>converted value</var> to the result of
              turning the lexical value of <var>value</var>
              into the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">JSON-LD internal representation</a>, and set <var>type</var> to <code>@json</code>.
              If the lexical value of <var>value</var> is not valid JSON according to
              the <a href="https://tools.ietf.org/html/rfc8259#section-2">JSON Grammar</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>],
              an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-json-literal" class="internalDFN" data-link-type="idl"><code>invalid JSON literal</code></a>
              error has been detected and processing is aborted.</li>
            <li class="changed">Otherwise, if the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of <var>value</var> starts with <code>https://www.w3.org/ns/i18n#</code>,
              and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-rdfdirection" class="internalDFN" data-link-type="idl"><code><code>rdfDirection</code></code></a> is <code>i18n-datatype</code>:
              <ol>
                <li>Set <var>converted value</var> to the <a href="#dfn-lexical-form" class="internalDFN" data-link-type="dfn">lexical form</a> of <var>value</var>.</li>
                <li>If the string prefix of the <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a>
                  of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> up until the underscore (<code>"_"</code>) is not empty,
                  add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@language</code> to <var>result</var> and set its value to that prefix.
                  <div class="note" role="note" id="issue-container-generatedID-36"><div role="heading" class="note-title marker" id="h-note-33" aria-level="5"><span>Note</span></div><div class="">As <code>@direction</code> may be used without <code>@language</code>,
                    it is possible, and legitimate, to create a datatype <abbr title="Internationalized Resource Identifier">IRI</abbr>
                    such as <code>http://w3.org/ns/i18n#_ltr</code>, which does not encode a language tag.</div></div></li>
                <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@direction</code> to <var>result</var> and set its value to the substring of the
                  <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a> following
                  the underscore (<code>"_"</code>).</li>
              </ol>
            </li>
            <li>Otherwise, if <var>value</var> is a
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>
              add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@language</code> to <var>result</var> and set its value to the
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> of <var>value</var>.</li>
            <li>Otherwise, set <var>type</var> to the
              <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
              of <var>value</var>, unless it equals <code>xsd:string</code> which is ignored.</li>
            <li>Add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@value</code> to <var>result</var> whose value
              is set to <var>converted value</var>.</li>
            <li>If <var>type</var> is not <code>null</code>, add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> <code>@type</code>
              to <var>result</var> whose value is set to <var>type</var>.</li>
            <li>Return <var>result</var>.</li>
          </ol>
        </li>
      </ol>
    </section>
  </section> 

  <section id="data-round-tripping"><h3 id="x8-6-data-round-tripping"><bdi class="secno">8.6 </bdi>Data Round Tripping<a class="self-link" aria-label="§" href="#data-round-tripping"></a></h3>

    <p>When <a href="#deserialize-json-ld-to-rdf-algorithm">deserializing JSON-LD to RDF</a>
      JSON-native <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a> are automatically
      type-coerced to <code>xsd:integer</code> or <code>xsd:double</code>
      depending on whether the <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> has a non-zero fractional part
      or not (the result of a modulo‑1 operation), the boolean values
      <code>true</code> and <code>false</code> are coerced to <code>xsd:boolean</code>,
      and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a> are coerced to <code>xsd:string</code>.
      The <span class="changed">JSON</span>, numeric, or boolean values themselves are converted to
      <dfn data-dfn-type="dfn" id="dfn-canonical-lexical-form">canonical lexical form</dfn>, i.e., a deterministic string
      representation as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>].</p>

    <p>The <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of an <em>integer</em>, i.e., a
      <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> with no non-zero fractional part
      <span class="changed">and an absolute value less than 10<sup>21</sup>,</span>
      or a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> coerced to <code>xsd:integer</code>,
      is a finite-length sequence of decimal
      digits (<code>0-9</code>) with an optional leading minus sign; leading
      zeros are prohibited. In JavaScript, implementers can use the following
      snippet of code to convert an integer to
      <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a>:</p>

    <div class="example" id="example-20-sample-integer-serialization-implementation-in-javascript">
          <div class="marker">
      <a class="self-link" href="#example-20-sample-integer-serialization-implementation-in-javascript">Example<bdi> 20</bdi></a><span class="example-title">: Sample integer serialization implementation in JavaScript</span>
    </div> <pre class="nohighlight" data-ignore="">(value).toFixed(0).toString()</pre>
        </div>

    <p>The <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of a <em>double</em>, i.e., a
      <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>
      <span class="changed">with a non-zero fractional part or an absolute value greater or equal to 10<sup>21</sup></span>,
      or a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>
      coerced to <code>xsd:double</code>, consists of a mantissa followed by the
      character <code>E</code>, followed by an exponent. The mantissa is a
      decimal number and the exponent is an integer. Leading zeros and a
      preceding plus sign (<code>+</code>) are prohibited in the exponent.
      If the exponent is zero, it is indicated by <code>E0</code>. For the
      mantissa, the preceding optional plus sign is prohibited and the
      decimal point is required. Leading and trailing zeros are prohibited
      subject to the following: number representations must be normalized
      such that there is a single digit which is non-zero to the left of
      the decimal point and at least a single digit to the right of the
      decimal point unless the value being represented is zero. The
      canonical representation for zero is <code>0.0E0</code>.
      <code>xsd:double</code>'s value space is defined by the IEEE
      double-precision 64-bit floating point type [<cite><a class="bibref" data-link-type="biblio" href="#bib-ieee-754-2008" title="IEEE 754-2008 Standard for Floating-Point Arithmetic">IEEE-754-2008</a></cite>] whereas
      the value space of JSON <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a> is not
      specified; when deserializing JSON-LD to RDF the mantissa is rounded to
      15&nbsp;digits after the decimal point. In JavaScript, implementers
      can use the following snippet of code to convert a double to
      <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a>:</p>

    <div class="example" id="example-21-sample-floating-point-number-serialization-implementation-in-javascript">
          <div class="marker">
      <a class="self-link" href="#example-21-sample-floating-point-number-serialization-implementation-in-javascript">Example<bdi> 21</bdi></a><span class="example-title">: Sample floating point number serialization implementation in JavaScript</span>
    </div> <pre class="nohighlight" data-ignore="">(value).toExponential(15).replace(/(\d)0*e\+?/,'$1E')</pre>
        </div>

    <p>The <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of the <em>boolean</em>
      values <code>true</code> and <code>false</code> are the strings
      <code>true</code> and <code>false</code>.</p>

    <p class="changed">The <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literal</a>
      is the result of serializing the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>
      into the JSON format [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>] in compliance with the constraints of the <strong>value space</strong> description within
      <a href="https://www.w3.org/TR/json-ld11/#the-rdf-json-datatype">The <code>rdf:JSON</code> Datatype</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].</p>

    <aside class="example changed" data-ignore="" id="example-22-canonicalized-json-literal"><div class="marker">
      <a class="self-link" href="#example-22-canonicalized-json-literal">Example<bdi> 22</bdi></a><span class="example-title">: Canonicalized JSON literal</span>
    </div>
      <pre class="original input" aria-busy="false"><code class="hljs">{
  "@context": {
    "@version": 1.1,
    "e": {"@id": "http://example.org/vocab#json", <span class="hl-bold">"@type": "@json"</span>}
  },
  "e": <span class="hl-bold">[
    56.0,
    {
      "d": true,
      "10": null,
      "1": [ ]
    }
  ]</span>
}</code></pre>

      <p>The example shows the value of "e" as a native JSON array including
        unnecessary whitespace, a number and an object. The result
        eliminates the whitespace, uses a canonical number representation,
        and reorders the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a> lexicographically:</p>

      <pre class="turtle result" data-content-type="text/turtle" data-result-for="Canonicalized JSON literal-original" data-to-rdf="" aria-busy="false"><code class="hljs">@prefix ex: &lt;http://example.org/vocab#&gt; .
@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
[ex:json <span class="hl-bold">"""[56,{"1":[],"10":null,"d":true}]"""^^rdf:JSON</span>] .</code></pre>
    </aside>

    <p>When JSON-native <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a> are deserialized
      to RDF, lossless data round-tripping cannot be guaranteed, as rounding
      errors might occur. When
      <a href="#serialize-rdf-as-json-ld-algorithm">serializing RDF as JSON-LD</a>,
      similar rounding errors might occur. Furthermore, the datatype or the lexical
      representation might be lost. An <code>xsd:double</code> with a value
      of <code>2.0</code> will, e.g., result in an <code>xsd:integer</code>
      with a value of <code>2</code> in <a href="#dfn-canonical-lexical-form" class="internalDFN" data-link-type="dfn">canonical lexical form</a>
      when converted from RDF to JSON-LD and back to RDF. It is important
      to highlight that in practice it might be impossible to losslessly
      convert an <code>xsd:integer</code> to a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a> because
      its value space is not limited. While the JSON specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]
      does not limit the value space of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">numbers</a>
      either, concrete implementations typically do have a limited value
      space.</p>

    <p>To ensure lossless round-tripping the
      <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>
      specifies a <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a> flag which controls whether
      <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a>
      with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
      equal to <code>xsd:integer</code>, <code>xsd:double</code>, or
      <code>xsd:boolean</code> are converted to their JSON-native
      counterparts. If the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-usenativetypes" class="internalDFN" data-link-type="idl"><code>useNativeTypes</code></a> flag is set to
      <code>false</code>, all literals remain in their original string
      representation.</p>

    <p>Some JSON serializers, such as PHP's native implementation in some versions,
      backslash-escape the forward slash character. For example, the value
      <code>http://example.com/</code> would be serialized as <code>http:\/\/example.com\/</code>.
      This is problematic as other JSON parsers might not understand those escaping characters.
      There is no need to backslash-escape forward slashes in JSON-LD. To aid
      interoperability between JSON-LD processors, forward slashes <em class="rfc2119" title="MUST NOT">MUST NOT</em> be
      backslash-escaped.</p>
  </section> 
</section>

<section id="the-application-programming-interface"><h2 id="x9-the-application-programming-interface"><bdi class="secno">9. </bdi>The Application Programming Interface<a class="self-link" aria-label="§" href="#the-application-programming-interface"></a></h2>

  <p>This API provides a clean mechanism that enables developers to convert
    JSON-LD data into a variety of output formats that are often easier to
    work with.</p>

  <p>The JSON-LD API uses <a href="https://tc39.github.io/ecma262/#sec-promise-objects">Promises</a> to represent
    the result of the various deferred operations.
    <a href="https://tc39.github.io/ecma262/#sec-promise-objects">Promises</a> are defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecmascript" title="ECMAScript Language Specification">ECMASCRIPT</a></cite>].
    General use within specifications can be found in [<cite><a class="bibref" data-link-type="biblio" href="#bib-promises-guide" title="Writing Promise-Using Specifications">promises-guide</a></cite>].
    <span class="changed">Implementations <em class="rfc2119" title="MAY">MAY</em> chose to implement in an appropriate way for their native environments
      as long as they generally use the same methods, arguments, and options
      and return the same results.</span></p>

  <div class="note" role="note" id="issue-container-generatedID-37"><div role="heading" class="note-title marker" id="h-note-34" aria-level="3"><span>Note</span></div><p class="">Interfaces are marked <code>[Exposed=(Window,Worker)]</code>,
    but the API is also intended for use outside of a browser context.</p></div>

  <section id="the-jsonldprocessor-interface"><h3 id="x9-1-the-jsonldprocessor-interface"><bdi class="secno">9.1 </bdi>The <dfn data-dfn-type="interface" data-export="" id="dom-jsonldprocessor" data-idl="interface" data-title="JsonLdProcessor" data-dfn-for=""><code>JsonLdProcessor</code></dfn> Interface<a class="self-link" aria-label="§" href="#the-jsonldprocessor-interface"></a></h3>

    <p>The <a href="#dom-jsonldprocessor" class="internalDFN" data-link-type="idl"><code>JsonLdProcessor</code></a> interface is the high-level programming structure
      that developers use to access the JSON-LD transformation methods.</p>

    <p>It is important to highlight that implementations do not modify the input parameters.
      If an error is detected, the <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> is
      rejected with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> having an appropriate <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a>
      and processing is stopped.</p>

    <p>If the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-documentloader" class="internalDFN" data-link-type="idl"><code>documentLoader</code></a>
      option is specified, it is used to dereference remote documents and contexts.
      The <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a>
      in the returned <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>
      is used as <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> and the
      <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contexturl" class="internalDFN" data-link-type="idl"><code><code>contextUrl</code></code></a>
      is used instead of looking at the HTTP Link Header directly. For the sake of simplicity, none of the algorithms
      in this document mention this directly.</p>

    <pre class="idl def" id="webidl-x975229804"><span class="idlHeader"><a class="self-link" href="#webidl-x975229804">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-jsonldprocessor" data-title="JsonLdProcessor">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-jsonldprocessor"><code>JsonLdProcessor</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-jsonldprocessor-constructor" data-title="constructor" data-dfn-for="JsonLdProcessor">
  <dfn data-export="" data-dfn-type="constructor" id="dom-jsonldprocessor-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="JsonLdProcessor" data-lt="constructor()" data-local-lt="JsonLdProcessor.constructor|JsonLdProcessor.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlMethod" id="idl-def-jsonldprocessor-compact-input-context-options" data-title="compact" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-compact"><code>compact</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldcontext" class="internalDFN" data-link-type="idl"><code>JsonLdContext</code></a></span> <span class="idlParamName">context</span> = null,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-jsonldprocessor-expand-input-options" data-title="expand" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-expand"><code>expand</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-jsonldprocessor-flatten-input-context-options" data-title="flatten" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-flatten"><code>flatten</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldcontext" class="internalDFN" data-link-type="idl"><code>JsonLdContext</code></a></span> <span class="idlParamName">context</span> = null,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-jsonldprocessor-fromrdf-input-options" data-title="fromRdf" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-fromrdf"><code>fromRdf</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-jsonldprocessor-tordf-input-options" data-title="toRdf" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-tordf"><code>toRdf</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span>
};</span></pre>

    <dl data-sort=""><dt><dfn data-dfn-for="JsonLdProcessor" data-dfn-type="method" data-export="" id="dom-jsonldprocessor-compact" data-idl="operation" data-title="compact()" data-type="Promise" data-lt="compact()|compact(input)|compact(input, context)|compact(input, context, options)" data-local-lt="JsonLdProcessor.compact|JsonLdProcessor.compact()|compact"><code>compact()</code></dfn></dt>
      <dd class="algorithm">
        <p><a href="#dfn-compact" class="internalDFN" data-link-type="dfn">Compacts</a> the given <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a> using the
          <var>context</var> according to the steps in the <a href="#compaction-algorithm">Compaction algorithm</a>:</p>

        <p class="changed">The final output is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
          derived from <var>compacted output</var>.
          If <var>compacted output</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, it is
          included with an entry of (a possibly aliased) <code>@graph</code>
          with the value of <var>compacted output</var>,
          otherwise <var>compacted output</var> is used as the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> result.
          If <a data-lt="jsonldprocessor-compact-context" href="#dfn-jsonldprocessor-compact-context" class="internalDFN" data-link-type="dfn">context</a> not <code>null</code>,
          an <code>@context</code> entry is added to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> result.</p>

        <ol>
          <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
            The following steps are then deferred.</li>
          <li class="changed">If the provided <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>,
            initialize <var>remote document</var> to <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>.</li>
          <li>Otherwise, if the provided <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> of a remote document, await and dereference it as <var>remote document</var>
            using <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, passing <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>
            for <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
            and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code><code>extractAllScripts</code></code></a> option from <a data-lt="jsonldprocessor-compact-options" href="#dfn-jsonldprocessor-compact-options" class="internalDFN" data-link-type="dfn">options</a>
            for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a>.</li>
          <li>Set <var>expanded input</var> to the result of
            using the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-expand" class="internalDFN" data-link-type="idl"><code>expand()</code></a> method
            using either <var>remote document</var>
            or <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>
            if there is no <var>remote document</var>
            for <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>,
            and <a data-lt="jsonldprocessor-compact-options" href="#dfn-jsonldprocessor-compact-options" class="internalDFN" data-link-type="dfn">options</a>,
            <span class="changed">with <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> set to <code>false</code></span>,
            <span class="changed">and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code><code>extractAllScripts</code></code></a> defaulting to <code>false</code></span>.</li>
          <li class="changed">Set <var>context base</var> to the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a>
            from <var>remote document</var>, if available, otherwise to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option
            from <a data-lt="jsonldprocessor-compact-options" href="#dfn-jsonldprocessor-compact-options" class="internalDFN" data-link-type="dfn">options</a>.</li>
          <li>If <a data-lt="jsonldprocessor-compact-context" href="#dfn-jsonldprocessor-compact-context" class="internalDFN" data-link-type="dfn">context</a> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
            having an <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
            set <var>context</var> to that <a data-lt="entry" data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry's</a> value,
            otherwise to <a data-lt="jsonldprocessor-compact-context" href="#dfn-jsonldprocessor-compact-context" class="internalDFN" data-link-type="dfn">context</a>.</li>
          <li class="changed">Initialize <var>active context</var>
            to the result of the <a href="#context-processing-algorithm">Context Processing algorithm</a>
            passing a new empty <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> as <var>active context</var>
            <var>context</var> as <var>local context</var>,
            and <var>context base</var> as <var>base URL</var>.</li>
          <li>Initialize <var>inverse context</var> to the result of performing the
            <a href="#inverse-context-creation">Inverse Context Creation algorithm</a>.</li>
          <li>Initialize <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option from <a data-lt="jsonldprocessor-compact-options" href="#dfn-jsonldprocessor-compact-options" class="internalDFN" data-link-type="dfn">options</a>, if set;
            otherwise, if the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-compacttorelative" class="internalDFN" data-link-type="idl"><code>compactToRelative</code></a> option is <strong>true</strong>,
            to the <abbr title="Internationalized Resource Identifier">IRI</abbr> of the currently being processed document, if available;
            otherwise to <code>null</code>.</li>
          <li>Set <var>compacted output</var> to the result of using the <a href="#compaction-algorithm">Compaction algorithm</a>,
            using <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>,
            <var>inverse context</var>,
            <code>null</code> for <var>active property</var>,
            <var>expanded input</var> as <var>element</var>,
            and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-compactarrays" class="internalDFN" data-link-type="idl"><code><code>compactArrays</code></code></a>
            <span class="changed">and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a></span>
            flags from <a data-lt="jsonldprocessor-compact-options" href="#dfn-jsonldprocessor-compact-options" class="internalDFN" data-link-type="dfn">options</a>.
            <ol id="api-compact-post-processing" class="changed">
              <li>If <var>compacted output</var> is an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
                replace it with a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</li>
              <li>Otherwise, if <var>compacted output</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
                replace it with a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> with a single <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
                whose key is the result of
                <span class="changed"><a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a> <code>@graph</code></span>
                and value is <var>compacted output</var>.</li>
              <li>If <a data-lt="jsonldprocessor-compact-context" href="#dfn-jsonldprocessor-compact-context" class="internalDFN" data-link-type="dfn">context</a> was not <code>null</code>,
                add an <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> to <var>compacted output</var> and set its value
                to the provided <var>context</var>.</li>
            </ol>
          </li>
          <li>Resolve the <var>promise</var> with <var>compacted output</var>
            <span class="changed">transforming <var>compacted output</var> from the
              <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> to a JSON serialization</span>.</li>
        </ol>

        <dl class="parameters">
          <dt><dfn data-lt="jsonldprocessor-compact-input" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-compact-input">input</dfn></dt>
           <dd>The <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
             array of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> to perform the compaction upon,
             or an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> referencing the JSON-LD document to compact.</dd>
          <dt><dfn data-lt="jsonldprocessor-compact-context" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-compact-context">context</dfn></dt>
          <dd>The context to use when <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a> the <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>;
            it can be specified by using a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
            an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
            or an array consisting of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> and <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>s.</dd>
          <dt><dfn data-lt="jsonldprocessor-compact-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-compact-options">options</dfn></dt>
          <dd>A set of options to configure the algorithms.
            This allows, e.g., to set the input document's base <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
            <span class="changed">The <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOptions</code></code></a> type defines default option values.</span>
          </dd>
        </dl>
      </dd>

      <dt><dfn data-dfn-for="JsonLdProcessor" data-dfn-type="method" data-export="" id="dom-jsonldprocessor-expand" data-idl="operation" data-title="expand()" data-type="Promise" data-lt="expand()|expand(input)|expand(input, options)" data-local-lt="JsonLdProcessor.expand|JsonLdProcessor.expand()|expand"><code>expand()</code></dfn></dt>
      <dd class="algorithm">
        <p><a href="#expansion">Expands</a> the given <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>
          according to the steps in the <a href="#expansion-algorithm">Expansion algorithm</a>:</p>

        <ol>
          <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
            The following steps are then deferred.</li>
          <li class="changed">If the provided <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>,
            initialize <var>remote document</var> to <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>.</li>
          <li>Otherwise, if the provided <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> of a remote document, await and dereference it as <var>remote document</var>
            using <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, passing <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>
            for <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
            the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code><code>extractAllScripts</code></code></a> option from <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a>
            for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a>.</li>
          <li class="changed">If <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a>
            from <var>remote document</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>, transform into the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>.
            If <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a> cannot be transformed to the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>,
            reject <var>promise</var> passing a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a> error.</li>
          <li>Initialize a new empty <var>active context</var>.
            The <a data-lt="context-base-iri" href="#dfn-context-base-iri" class="internalDFN" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> and <a href="#dfn-original-base-url" class="internalDFN" data-link-type="dfn">original base URL</a> of the <var>active context</var> is set to the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a>
            from <var>remote document</var>, if available;
            otherwise to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option from <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a>.
            If set, the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option from <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a> overrides the <a data-lt="context-base-iri" href="#dfn-context-base-iri" class="internalDFN" data-link-type="dfn">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</li>
          <li>If the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-expandcontext" class="internalDFN" data-link-type="idl"><code><code>expandContext</code></code></a> option in <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a> is set, 
            update the <var>active context</var> using the <a href="#context-processing-algorithm">Context Processing algorithm</a>,
            passing the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-expandcontext" class="internalDFN" data-link-type="idl"><code><code>expandContext</code></code></a> as <var>local context</var>
            and the <a href="#dfn-original-base-url" class="internalDFN" data-link-type="dfn">original base URL</a> from <var>active context</var> as <var>base URL</var>.
            If <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-expandcontext" class="internalDFN" data-link-type="idl"><code><code>expandContext</code></code></a> is a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> having an <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
            pass that <a data-lt="entry" data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry's</a> value instead for <var>local context</var>.</li>
          <li>If <var>remote document</var> has a <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contexturl" class="internalDFN" data-link-type="idl"><code><code>contextUrl</code></code></a>,
            update the <var>active context</var> using the <a href="#context-processing-algorithm">Context Processing algorithm</a>,
            passing the <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contexturl" class="internalDFN" data-link-type="idl"><code><code>contextUrl</code></code></a> as <var>local context</var>,
            and <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contexturl" class="internalDFN" data-link-type="idl"><code><code>contextUrl</code></code></a> as <var>base URL</var>.</li>
          <li>Set <var>expanded output</var> to the result of using the <a href="#expansion-algorithm">Expansion algorithm</a>,
            passing the <var>active context</var>,
            <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a> from <var>remote document</var> or <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>
            if there is no <var>remote document</var> as <var>element</var>,
            <code>null</code> as <var>active property</var>,
            <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a> as <var>base URL</var>, if available,
            otherwise to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option
            from <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a>,
            and the <span class="changed"><a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a></span>
            and <span class="changed">and <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a></span>
            flags from <a data-lt="jsonldprocessor-expand-options" href="#dfn-jsonldprocessor-expand-options" class="internalDFN" data-link-type="dfn">options</a>.
            <div class="note" role="note" id="issue-container-generatedID-38"><div role="heading" class="note-title marker" id="h-note-35" aria-level="4"><span>Note</span></div><div class="changed">If there is no <var>remote document</var>,
              then <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a> is
              a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or a <code>sequence</code> of
              <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a>, which are implicitly alread in the
              <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>.</div></div>
            <ol id="api-expand-post-processing" class="changed">
              <li>If <var>expanded output</var> is a
                <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> that contains only an <code>@graph</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>,
                set <var>expanded output</var> that value.</li>
              <li>If <var>expanded output</var> is <code>null</code>,
                set <var>expanded output</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.</li>
              <li>If <var>expanded output</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>,
                set <var>expanded output</var> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing only <var>expanded output</var>.</li>
            </ol>
          </li>
          <li>Resolve the <var>promise</var> with <var>expanded output</var>
            <span class="changed">transforming <var>expanded output</var> from the
              <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> to a JSON serialization</span>.</li>
        </ol>

        <dl class="parameters">
          <dt><dfn data-lt="jsonldprocessor-expand-input" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-expand-input">input</dfn></dt>
          <dd>The <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
            or array of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a> to perform the expansion upon,
            or an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> referencing the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a> to expand.</dd>
          <dt><dfn data-lt="jsonldprocessor-expand-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-expand-options">options</dfn></dt>
          <dd>A set of options to configure the used algorithms.
            This allows, e.g., to set the input document's <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
            <span class="changed">The <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOptions</code></code></a> type defines default option values.</span>
          </dd>
        </dl>
      </dd>

      <dt><dfn data-dfn-for="JsonLdProcessor" data-dfn-type="method" data-export="" id="dom-jsonldprocessor-flatten" data-idl="operation" data-title="flatten()" data-type="Promise" data-lt="flatten()|flatten(input)|flatten(input, context)|flatten(input, context, options)" data-local-lt="JsonLdProcessor.flatten|JsonLdProcessor.flatten()|flatten"><code>flatten()</code></dfn></dt>
      <dd class="algorithm">
        <p><a href="#flattening">Flattens</a> the given <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>
          and optionally <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacts</a> it using the provided <a data-lt="jsonldprocessor-flatten-context" href="#dfn-jsonldprocessor-flatten-context" class="internalDFN" data-link-type="dfn">context</a>
          according to the steps in the <a href="#flattening-algorithm">Flattening algorithm</a>:</p>

        <ol>
          <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
            The following steps are then deferred.</li>
          <li class="changed">If the provided <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>,
            initialize <var>remote document</var> to <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>.</li>
          <li>Otherwise, if the provided <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>
            is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> of a remote document, await and dereference it as <var>remote document</var>
            using <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, passing <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>
            for <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
            and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code><code>extractAllScripts</code></code></a> option from <a data-lt="jsonldprocessor-flatten-options" href="#dfn-jsonldprocessor-flatten-options" class="internalDFN" data-link-type="dfn">options</a>
            for <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a>.
          </li>
          <li>Set <var>expanded input</var> to the result of
            using the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-expand" class="internalDFN" data-link-type="idl"><code>expand()</code></a> method
            using either <var>remote document</var>
            or <a data-lt="jsonldprocessor-flatten-input" href="#dfn-jsonldprocessor-flatten-input" class="internalDFN" data-link-type="dfn">input</a>
            if there is no <var>remote document</var>
            for <a data-lt="jsonldprocessor-expand-input" href="#dfn-jsonldprocessor-expand-input" class="internalDFN" data-link-type="dfn">input</a>,
            and <a data-lt="jsonldprocessor-flatten-options" href="#dfn-jsonldprocessor-flatten-options" class="internalDFN" data-link-type="dfn">options</a>
            <span class="changed">with <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> set to <code>false</code></span>.</li>
          <li class="changed">Initialize the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option
            from <a data-lt="jsonldprocessor-flatten-options" href="#dfn-jsonldprocessor-flatten-options" class="internalDFN" data-link-type="dfn">options</a>, if set;
            otherwise, if the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-compacttorelative" class="internalDFN" data-link-type="idl"><code>compactToRelative</code></a> option is <strong>true</strong>,
            to the <abbr title="Internationalized Resource Identifier">IRI</abbr> of the currently being processed document, if available;
            otherwise to <code>null</code>.</li>
          <li>Initialize an empty <var>identifier map</var>.</li>
          <li>Set <var>flattened output</var> to the result of using the <a href="#flattening-algorithm">Flattening algorithm</a>,
            passing <var>expanded input</var> as <var>element</var>,
            <span class="changed">and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> flag
              from <a data-lt="jsonldprocessor-flatten-options" href="#dfn-jsonldprocessor-flatten-options" class="internalDFN" data-link-type="dfn">options</a></span>.
            <ol id="api-flatten-post-processing" class="changed">
              <li>If <a data-lt="jsonldprocessor-flatten-context" href="#dfn-jsonldprocessor-flatten-context" class="internalDFN" data-link-type="dfn">context</a> is not <code>null</code>,
                set <var>flattened output</var> to the result of
                using the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-compact" class="internalDFN" data-link-type="idl"><code>compact()</code></a> method
                using <var>flattened output</var> for <a data-lt="jsonldprocessor-compact-input" href="#dfn-jsonldprocessor-compact-input" class="internalDFN" data-link-type="dfn">input</a>,
                <a data-lt="jsonldprocessor-flatten-context" href="#dfn-jsonldprocessor-flatten-context" class="internalDFN" data-link-type="dfn">context</a>,
                and <a data-lt="jsonldprocessor-flatten-options" href="#dfn-jsonldprocessor-flatten-options" class="internalDFN" data-link-type="dfn">options</a>.</li>
            </ol>
          </li>
          <li>Resolve the <var>promise</var> with <var>flattened output</var>
            <span class="changed">transforming <var>flattened output</var> from the
              <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> to a JSON serialization</span>,
              if necessary.</li>
        </ol>

        <dl class="parameters">
          <dt><dfn data-lt="jsonldprocessor-flatten-input" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-flatten-input">input</dfn></dt>
           <dd>The <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
             or array of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>,
             or an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> referencing the JSON-LD document to flatten.</dd>
          <dt><dfn data-lt="jsonldprocessor-flatten-context" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-flatten-context">context</dfn></dt>
          <dd>The context to use when <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a> the flattened <var>expanded input</var>;
            it can be specified by using a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
            an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, or an array consisting of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>
            and <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>s.
            If <code>null</code>, the result will not be compacted but kept in expanded form.</dd>
          <dt><dfn data-lt="jsonldprocessor-flatten-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-flatten-options">options</dfn></dt>
          <dd>A set of options to configure the used algorithms.
            This allows, e.g., to set the input document's <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
            <span class="changed">The <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOptions</code></code></a> type defines default option values.</span>
          </dd>
        </dl>
      </dd>

      <dt><dfn data-dfn-for="JsonLdProcessor" class="changed" data-dfn-type="method" data-export="" id="dom-jsonldprocessor-fromrdf" data-idl="operation" data-title="fromRdf()" data-type="Promise" data-lt="fromRdf()|fromRdf(input)|fromRdf(input, options)" data-local-lt="JsonLdProcessor.fromRdf|JsonLdProcessor.fromRdf()|fromRdf"><code>fromRdf()</code></dfn></dt>
      <dd class="algorithm changed">
        <p>Transforms the given <a data-lt="jsonldprocessor-fromRdf-input" href="#dfn-jsonldprocessor-fromrdf-input" class="internalDFN" data-link-type="dfn">input</a>
          into a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD document</a> in <a href="#dfn-expanded-form" class="internalDFN" data-link-type="dfn">expanded form</a>
          according to the steps in the <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>:</p>

        <div class="note" role="note" id="issue-container-generatedID-39"><div role="heading" class="note-title marker" id="h-note-36" aria-level="4"><span>Note</span></div><p class="">This interface does not define a means of creating an <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>
          from an arbitrary input, other than the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-tordf" class="internalDFN" data-link-type="idl"><code>toRdf()</code></a> method.</p></div>

        <ol>
          <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
            The following steps are then deferred.</li>
          <li>Set <var>expanded result</var> to the result of invoking the
            <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a> method
            using <a data-lt="jsonldprocessor-fromRdf-input" href="#dfn-jsonldprocessor-fromrdf-input" class="internalDFN" data-link-type="dfn">dataset</a>
            and <a data-lt="jsonldprocessor-fromRdf-options" href="#dfn-jsonldprocessor-fromrdf-options" class="internalDFN" data-link-type="dfn">options</a>.</li>
          <li>Resolve the <var>promise</var> with <var>expanded result</var>
            <span class="changed">transforming <var>expanded result</var> from the
              <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a> to a JSON serialization</span>.</li>
        </ol>

        <dl class="parameters">
          <dt><dfn data-lt="jsonldprocessor-fromRdf-input" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-fromrdf-input">input</dfn></dt>
           <dd>The <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
             or array of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>,
             or an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> referencing the JSON-LD document to flatten.</dd>
          <dt><dfn data-lt="jsonldprocessor-fromRdf-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-fromrdf-options">options</dfn></dt>
          <dd>A set of options to configure the used algorithms.
            This allows, e.g., to set the input document's <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
            <span class="changed">The <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOptions</code></code></a> type defines default option values.</span>
          </dd>
        </dl>
      </dd>

      <dt><dfn data-dfn-for="JsonLdProcessor" class="changed" data-dfn-type="method" data-export="" id="dom-jsonldprocessor-tordf" data-idl="operation" data-title="toRdf()" data-type="Promise" data-lt="toRdf()|toRdf(input)|toRdf(input, options)" data-local-lt="JsonLdProcessor.toRdf|JsonLdProcessor.toRdf()|toRdf"><code>toRdf()</code></dfn></dt>
      <dd class="algorithm changed">
        <p>Transforms the given <a data-lt="jsonldprocessor-toRdf-input" href="#dfn-jsonldprocessor-tordf-input" class="internalDFN" data-link-type="dfn">input</a> into an <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>
          according to the steps in the <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>:</p>

        <ol>
          <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
            The following steps are then deferred.</li>
          <li>Set <var>expanded input</var> to the result of using the
            <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-expand" class="internalDFN" data-link-type="idl"><code>expand()</code></a> method
            using <a data-lt="jsonldprocessor-toRdf-input" href="#dfn-jsonldprocessor-tordf-input" class="internalDFN" data-link-type="dfn">input</a>
            and <a data-lt="jsonldprocessor-toRdf-options" href="#dfn-jsonldprocessor-tordf-options" class="internalDFN" data-link-type="dfn">options</a>
            <span class="changed">with <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a> set to <code>false</code></span>.</li>
          <li>Create a new <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a> <var>dataset</var>.</li>
          <li>Create a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>node map</var>.</li>
          <li>Invoke the <a href="#node-map-generation">Node Map Generation algorithm</a>,
            passing <var>expanded input</var> as <var>element</var>
            and <var>node map</var>.</li>
          <li>Invoke the <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>
            passing <var>node map</var>, <var>dataset</var>,
            and the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> flag from <a data-lt="jsonldprocessor-toRdf-options" href="#dfn-jsonldprocessor-tordf-options" class="internalDFN" data-link-type="dfn">options</a>.
            <div class="note" role="note" id="issue-container-generatedID-40"><div role="heading" class="note-title marker" id="h-note-37" aria-level="4"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
              and may be removed in a future version of JSON-LD,
              as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>
              and thus the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option may be also be removed.</div></div>
            </li>
          <li>Resolve the <var>promise</var> with <var>dataset</var>.</li>
        </ol>

        <dl class="parameters">
          <dt><dfn data-lt="jsonldprocessor-toRdf-input" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-tordf-input">input</dfn></dt>
           <dd>The <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
             or array of <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>,
             or an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> referencing the JSON-LD document to flatten.</dd>
          <dt><dfn data-lt="jsonldprocessor-toRdf-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-jsonldprocessor-tordf-options">options</dfn></dt>
          <dd>A set of options to configure the used algorithms.
            This allows, e.g., to set the input document's <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a>.
            <span class="changed">The <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOptions</code></code></a> type defines default option values.</span>
          </dd>
        </dl>
      </dd></dl>

    <pre class="idl changed def" id="webidl-x43687581"><span class="idlHeader"><a class="self-link" href="#webidl-x43687581">WebIDL</a></span><span data-idl="" class="idlTypedef" id="idl-def-jsonldrecord" data-title="JsonLdRecord">typedef<span class="idlType"> <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-record">record</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>, <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldrecord"><code>JsonLdRecord</code></a>;</span></pre>
    <p class="changed">The <dfn data-dfn-type="typedef" data-plurals="jsonldrecords" data-export="" id="dom-jsonldrecord" data-idl="typedef" data-title="JsonLdRecord" data-dfn-for=""><code>JsonLdRecord</code></dfn> is the definition of a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
      used to contain arbitrary <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a>
      which are the result of parsing a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-4">JSON Object</a>.

    </p><pre class="idl changed def" id="webidl-x295859679"><span class="idlHeader"><a class="self-link" href="#webidl-x295859679">WebIDL</a></span><span data-idl="" class="idlTypedef" id="idl-def-jsonldinput" data-title="JsonLdInput">typedef<span class="idlType"> (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt; or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="_IDL_" href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>)</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldinput"><code>JsonLdInput</code></a>;</span></pre>

    <p class="changed">The <dfn data-dfn-type="typedef" data-export="" id="dom-jsonldinput" data-idl="typedef" data-title="JsonLdInput" data-dfn-for=""><code>JsonLdInput</code></dfn> interface is used to refer to an input value
      that that may be a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>,
      a <code>sequence</code> of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a>,
      a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
      which can be dereferenced to retrieve a valid JSON document,
      <span class="changed">or an already dereferenced <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a></span>.</p>

    <p class="changed">When the value is a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or sequence of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a>,
      the values are taken as their equivalent internal representation values,
      where a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> is equivalent to a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
      and a sequence of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a> is equivalent to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
      of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>. The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a> are converted to their equivalents
      in [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">INFRA</a></cite>].</p>

    <pre class="idl def" id="webidl-x1159289741"><span class="idlHeader"><a class="self-link" href="#webidl-x1159289741">WebIDL</a></span><span data-idl="" class="idlTypedef" id="idl-def-jsonldcontext" data-title="JsonLdContext">typedef<span class="idlType"> (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;(<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)&gt; or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldcontext"><code>JsonLdContext</code></a>;</span></pre>

    <p>The <dfn data-dfn-type="typedef" data-export="" id="dom-jsonldcontext" data-idl="typedef" data-title="JsonLdContext" data-dfn-for=""><code>JsonLdContext</code></dfn> interface is used to refer to a value
      that may be a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>,
      a <code>sequence</code> of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a>,
      or a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> representing an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
      which can be dereferenced to retrieve a valid JSON document.</p>

    <p class="changed">When the value is a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or sequence of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a>,
      the values are taken as their equivalent internal representation values,
      where a <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> is equivalent to a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>,
      and a sequence of <a href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl">JsonLdRecords</a> is equivalent to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>
      of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>. The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entries</a> are converted to their equivalents
      in [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">INFRA</a></cite>].</p>
  </section>

  <section id="rdf-dataset-interfaces"><h3 id="x9-2-rdf-dataset-interfaces"><bdi class="secno">9.2 </bdi>RDF Dataset Interfaces<a class="self-link" aria-label="§" href="#rdf-dataset-interfaces"></a></h3>

    <p>The <dfn data-dfn-type="interface" data-export="" id="dom-rdfdataset" data-idl="interface" data-title="RdfDataset" data-dfn-for=""><code>RdfDataset</code></dfn> interface describes operations on an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>
      used by the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-fromrdf" class="internalDFN" data-link-type="idl"><code>fromRdf()</code></a>
      and <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-tordf" class="internalDFN" data-link-type="idl"><code>toRdf()</code></a> methods
      in the <a href="#dom-jsonldprocessor" class="internalDFN" data-link-type="idl"><code>JsonLdProcessor</code></a> interface.
      The interface may be used for constructing a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>,
      which has a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> accessible via the <a data-link-for="RdfDataset" href="#dom-rdfdataset-defaultgraph" class="internalDFN" data-link-type="idl"><code>defaultGraph</code></a> attribute.</p>

    <pre class="idl changed def" id="webidl-x789941608"><span class="idlHeader"><a class="self-link" href="#webidl-x789941608">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-rdfdataset" data-title="RdfDataset">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfdataset"><code>RdfDataset</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-rdfdataset-constructor" data-title="constructor" data-dfn-for="RdfDataset">
  <dfn data-export="" data-dfn-type="constructor" id="dom-rdfdataset-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfDataset" data-lt="constructor()" data-local-lt="RdfDataset.constructor|RdfDataset.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" id="idl-def-rdfdataset-defaultgraph" data-title="defaultGraph" data-dfn-for="RdfDataset">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a></span> <a class="internalDFN idlName" data-link-for="RdfDataset" data-link-type="attribute" href="#dom-rdfdataset-defaultgraph"><code>defaultGraph</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-rdfdataset-add-graphname-graph" data-title="add" data-dfn-for="RdfDataset"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName" data-link-for="RdfDataset" data-link-type="method" href="#dom-rdfdataset-add"><code>add</code></a>(<span class="idlType"><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">graphName</span>,<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a></span> <span class="idlParamName">graph</span>);</span><span data-idl="" class="idlIterable" id="idl-def-rdfdataset-iterable" data-title="iterable" data-dfn-for="RdfDataset">
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-iterable">iterable</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?, <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>&gt;;</span>
};</span></pre>

    <dl data-sort=""><dt><dfn data-dfn-for="RdfDataset" data-dfn-type="method" data-export="" id="dom-rdfdataset-add" data-idl="operation" data-title="add()" data-type="void" data-lt="add()|add(graphName, graph)" data-local-lt="RdfDataset.add|RdfDataset.add()|add"><code>add()</code></dfn></dt>
      <dd class="algorithm">
        <p>Adds an <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a> and its associated <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a> to the <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>.
          Used by the <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>.</p>

        <dl class="parameters">
          <dt><dfn data-lt="RdfDataset-add-graphName" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-rdfdataset-add-graphname">graphName</dfn></dt>
          <dd>The <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a> associated with <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a>.
            <a href="#dfn-rdfdataset-add-graphname"><code>graphName</code></a> <em class="rfc2119" title="MUST">MUST</em> be a
            <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.
          </dd>
          <dt><dfn data-lt="RdfDataset-add-graph" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-rdfdataset-add-graph">graph</dfn></dt>
          <dd>The <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a> to add to the <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>.</dd>
        </dl>
      </dd>
      <dt><dfn data-dfn-for="RdfDataset" data-dfn-type="attribute" data-export="" id="dom-rdfdataset-defaultgraph" data-idl="attribute" data-title="defaultGraph" data-type="RdfGraph" data-lt="defaultGraph" data-local-lt="RdfDataset.defaultGraph"><code>defaultGraph</code></dfn></dt>
      <dd>Provides access to the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a> associated with the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>.</dd>
      <dt><dfn data-dfn-for="RdfDataset" data-dfn-type="dfn" id="dfn-iterable"><code>iterable</code></dfn></dt>
      <dd>The <a href="https://heycam.github.io/webidl/#dfn-value-pairs-to-iterate-over">value pairs to iterate over</a>
        are the list of <var>graph name</var>-<var>graph</var> pairs,
        with the <var>graph name</var> being <code>null</code>
        (for the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a>),
        an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>,
        or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        and graph an <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a> instance.</dd></dl>

    <p>The <dfn data-dfn-type="interface" data-export="" id="dom-rdfgraph" data-idl="interface" data-title="RdfGraph" data-dfn-for=""><code>RdfGraph</code></dfn> interface describes operations on an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> used by the <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-fromrdf" class="internalDFN" data-link-type="idl"><code>fromRdf()</code></a>
      and <a data-link-for="JsonLdProcessor" href="#dom-jsonldprocessor-tordf" class="internalDFN" data-link-type="idl"><code>toRdf()</code></a> methods
      in the <a href="#dom-jsonldprocessor" class="internalDFN" data-link-type="idl"><code>JsonLdProcessor</code></a> interface.
      The interface may be used for constructing a new <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>,
      which is composed of zero or more <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> instances.</p>

    <pre class="idl changed def" id="webidl-x140206580"><span class="idlHeader"><a class="self-link" href="#webidl-x140206580">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-rdfgraph" data-title="RdfGraph">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfgraph"><code>RdfGraph</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-rdfgraph-constructor" data-title="constructor" data-dfn-for="RdfGraph">
  <dfn data-export="" data-dfn-type="constructor" id="dom-rdfgraph-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfGraph" data-lt="constructor()" data-local-lt="RdfGraph.constructor|RdfGraph.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlMethod" id="idl-def-rdfgraph-add-triple" data-title="add" data-dfn-for="RdfGraph"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName" data-link-for="RdfGraph" data-link-type="method" href="#dom-rdfgraph-add"><code>add</code></a>(<span class="idlType"><a data-xref-type="_IDL_" href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a></span> <span class="idlParamName">triple</span>);</span><span data-idl="" class="idlIterable" id="idl-def-rdfgraph-iterable" data-title="iterable" data-dfn-for="RdfGraph">
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-iterable">iterable</a>&lt;<a data-xref-type="_IDL_" href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a>&gt;;</span>
};</span></pre>

    <dl data-sort=""><dt><dfn data-dfn-for="RdfGraph" data-dfn-type="method" data-export="" id="dom-rdfgraph-add" data-idl="operation" data-title="add()" data-type="void" data-lt="add()|add(triple)" data-local-lt="RdfGraph.add|RdfGraph.add()|add"><code>add()</code></dfn></dt>
      <dd class="algorithm">
        <p>Adds an <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> to the <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>.
          Used by the <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>.</p>

        <dl class="parameters">
          <dt><dfn data-lt="RdfGraph-add-triple" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-rdfgraph-add-triple">triple</dfn></dt>
          <dd>The <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> to add to the <a href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>.</dd>
        </dl>
      </dd>
      <dt><dfn data-dfn-for="RdfGraph" data-dfn-type="dfn" id="dfn-iterable-0"><code>iterable</code></dfn></dt>
      <dd>A <a href="https://heycam.github.io/webidl/#dfn-value-iterator">value iterator</a>
        over the <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> instances associated with the graph.
        Note that a given <a href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a> instance may appear in more than one graph
        within a particular <a href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a> instance.</dd></dl>

    <p>The <dfn data-dfn-type="interface" data-export="" id="dom-rdftriple" data-idl="interface" data-title="RdfTriple" data-dfn-for=""><code>RdfTriple</code></dfn> interface describes an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</p>

    <pre class="idl changed def" id="webidl-x1589662450"><span class="idlHeader"><a class="self-link" href="#webidl-x1589662450">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-rdftriple" data-title="RdfTriple">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdftriple"><code>RdfTriple</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-rdftriple-constructor" data-title="constructor" data-dfn-for="RdfTriple">
  <dfn data-export="" data-dfn-type="constructor" id="dom-rdftriple-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfTriple" data-lt="constructor()" data-local-lt="RdfTriple.constructor|RdfTriple.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" id="idl-def-rdftriple-subject" data-title="subject" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-subject"><code>subject</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-rdftriple-predicate" data-title="predicate" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-predicate"><code>predicate</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-rdftriple-object" data-title="object" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> (<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="_IDL_" href="#dom-rdfliteral" class="internalDFN" data-link-type="idl"><code>RdfLiteral</code></a>)</span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-object"><code>_object</code></a>;</span>
};</span></pre>

    <dl>
      <dt><dfn data-dfn-for="RdfTriple" data-dfn-type="attribute" data-plurals="subjects" data-export="" id="dom-rdftriple-subject" data-idl="attribute" data-title="subject" data-type="USVString" data-lt="subject" data-local-lt="RdfTriple.subject"><code>subject</code></dfn></dt>
      <dd>An absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
        denoting the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</dd>
      <dt><dfn data-dfn-for="RdfTriple" data-dfn-type="attribute" data-plurals="predicates" data-export="" id="dom-rdftriple-predicate" data-idl="attribute" data-title="predicate" data-type="USVString" data-lt="predicate" data-local-lt="RdfTriple.predicate"><code>predicate</code></dfn></dt>
      <dd>An absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> denoting the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.
        If used to represent a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">Generalized RDF Dataset</a>,
        it may also be a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>.
        <div class="note" role="note" id="issue-container-generatedID-41"><div role="heading" class="note-title marker" id="h-note-38" aria-level="4"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
          and may be removed in a future version of JSON-LD, as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>.</div></div>
        </dd>
      <dt><dfn data-dfn-for="RdfTriple" data-dfn-type="attribute" data-export="" id="dom-rdftriple-object" data-idl="attribute" data-title="object" data-type="USVString|RdfLiteral" data-lt="object" data-local-lt="RdfTriple.object"><code>object</code></dfn></dt>
      <dd>An absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>, or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>
        denoting the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</dd>
    </dl>

    <p>The <dfn data-dfn-type="interface" data-export="" id="dom-rdfliteral" data-idl="interface" data-title="RdfLiteral" data-dfn-for=""><code>RdfLiteral</code></dfn> interface describes an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF Literal</a>.</p>

    <pre class="idl changed def" id="webidl-x2088240233"><span class="idlHeader"><a class="self-link" href="#webidl-x2088240233">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-rdfliteral" data-title="RdfLiteral">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfliteral"><code>RdfLiteral</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-rdfliteral-constructor" data-title="constructor" data-dfn-for="RdfLiteral">
  <dfn data-export="" data-dfn-type="constructor" id="dom-rdfliteral-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfLiteral" data-lt="constructor()" data-local-lt="RdfLiteral.constructor|RdfLiteral.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" id="idl-def-rdfliteral-value" data-title="value" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-value"><code>value</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-rdfliteral-datatype" data-title="datatype" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-datatype"><code>datatype</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-rdfliteral-language" data-title="language" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-language"><code>language</code></a>;</span>
};</span></pre>

    <dl>
      <dt><dfn data-dfn-for="RdfLiteral" data-dfn-type="attribute" data-export="" id="dom-rdfliteral-value" data-idl="attribute" data-title="value" data-type="USVString" data-lt="value" data-local-lt="RdfLiteral.value"><code>value</code></dfn></dt>
      <dd>The lexical value of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>.</dd>
      <dt><dfn data-dfn-for="RdfLiteral" data-dfn-type="attribute" data-export="" id="dom-rdfliteral-datatype" data-idl="attribute" data-title="datatype" data-type="USVString" data-lt="datatype" data-local-lt="RdfLiteral.datatype"><code>datatype</code></dfn></dt>
      <dd>An absolute <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> denoting the <a data-lt="RDF11-CONCEPTS#dfn-datatype-iri" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri">datatype <abbr title="Internationalized Resource Identifier">IRI</abbr></a> of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>.
        If the value is <code>rdf:langString</code>,
        <a data-link-for="RdfLiteral" href="#dom-rdfliteral-language" class="internalDFN" data-link-type="idl"><code>language</code></a> <em class="rfc2119" title="MUST">MUST</em> be specified.</dd>
      <dt><dfn data-dfn-for="RdfLiteral" data-dfn-type="attribute" data-export="" id="dom-rdfliteral-language" data-idl="attribute" data-title="language" data-type="USVString" data-lt="language" data-local-lt="RdfLiteral.language"><code>language</code></dfn></dt>
      <dd>An optional <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>].
        If this value is specified, <a data-link-for="RdfLiteral" href="#dom-rdfliteral-datatype" class="internalDFN" data-link-type="idl"><code>datatype</code></a> <em class="rfc2119" title="MUST">MUST</em> be <code>rdf:langString</code>.</dd>
    </dl>
  </section> 

  <section id="the-jsonldoptions-type"><h3 id="x9-3-the-jsonldoptions-type"><bdi class="secno">9.3 </bdi>The JsonLdOptions Type<a class="self-link" aria-label="§" href="#the-jsonldoptions-type"></a></h3>

    <p>The <dfn data-dfn-type="dictionary" data-plurals="jsonldoption" data-export="" id="dom-jsonldoptions" data-idl="dictionary" data-title="JsonLdOptions" data-dfn-for=""><code>JsonLdOptions</code></dfn> type is used to pass various options to the
      <a href="#dom-jsonldprocessor" class="internalDFN" data-link-type="idl"><code>JsonLdProcessor</code></a> methods.</p>

    <pre class="idl def" id="webidl-x1767988930"><span class="idlHeader"><a class="self-link" href="#webidl-x1767988930">WebIDL</a></span><span data-idl="" class="idlDictionary" id="idl-def-jsonldoptions" data-title="JsonLdOptions">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-jsonldoptions"><code>JsonLdOptions</code></a> {<span data-idl="" class="idlMember" id="idl-def-jsonldoptions-base" data-title="base" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>             <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-base"><code>base</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-compactarrays" data-title="compactArrays" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-compactarrays"><code>compactArrays</code></a> = true;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-compacttorelative" data-title="compactToRelative" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-compacttorelative"><code>compactToRelative</code></a> = true;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-documentloader" data-title="documentLoader" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>?</span>  <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-documentloader"><code>documentLoader</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-expandcontext" data-title="expandContext" data-dfn-for="JsonLdOptions"><span class="idlType">
  (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>? or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)</span> <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-expandcontext"><code>expandContext</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-extractallscripts" data-title="extractAllScripts" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-extractallscripts"><code>extractAllScripts</code></a> = false;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-frameexpansion" data-title="frameExpansion" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-frameexpansion"><code>frameExpansion</code></a> = false;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-ordered" data-title="ordered" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-ordered"><code>ordered</code></a> = false;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-processingmode" data-title="processingMode" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span>              <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-processingmode"><code>processingMode</code></a> = "json-ld-1.1";</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-producegeneralizedrdf" data-title="produceGeneralizedRdf" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-producegeneralizedrdf"><code>produceGeneralizedRdf</code></a> = true;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-rdfdirection" data-title="rdfDirection" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>             <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-rdfdirection"><code>rdfDirection</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-usenativetypes" data-title="useNativeTypes" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-usenativetypes"><code>useNativeTypes</code></a> = false;</span><span data-idl="" class="idlMember" id="idl-def-jsonldoptions-userdftype" data-title="useRdfType" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-userdftype"><code>useRdfType</code></a> = false;</span>
};</span></pre>

    <dl data-sort=""><dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-base" data-idl="field" data-title="base" data-type="USVString"><code>base</code></dfn></dt>
      <dd>The base <abbr title="Internationalized Resource Identifier">IRI</abbr> to use when expanding or <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a> the document.
        If set, this overrides the input document's <abbr title="Internationalized Resource Identifier">IRI</abbr>.</dd>
      <dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-compactarrays" data-idl="field" data-title="compactArrays" data-type="boolean"><code>compactArrays</code></dfn></dt>
      <dd>If set to <code>true</code>, the JSON-LD processor replaces arrays
        with just one element with that element during <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compaction</a>.
        If set to <code>false</code>,
        all arrays will remain arrays even if they have just one element.
      </dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-compacttorelative" data-idl="field" data-title="compactToRelative" data-type="boolean"><code>compactToRelative</code></dfn></dt>
      <dd class="changed">Determines if IRIs are compacted
        relative to the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-base" class="internalDFN" data-link-type="idl"><code><code>base</code></code></a> option
        or document location when <a href="#dfn-compact" class="internalDFN" data-link-type="dfn">compacting</a>.</dd>
      <dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-documentloader" data-idl="field" data-title="documentLoader" data-type="LoadDocumentCallback"><code>documentLoader</code></dfn></dt>
      <dd>The callback of the loader to be used to retrieve remote documents and contexts,
        implementing the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>.
        If specified, it is used to retrieve remote documents and contexts;
        otherwise, if not specified, the processor's built-in loader is used.</dd>
      <dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-expandcontext" data-idl="field" data-title="expandContext" data-type="JsonLdRecord|USVString"><code>expandContext</code></dfn></dt>
      <dd>A context that is used to initialize the active context when expanding a document.</dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-extractallscripts" data-idl="field" data-title="extractAllScripts" data-type="boolean"><code>extractAllScripts</code></dfn></dt>
      <dd>If set to <code>true</code>,
        when extracting <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a> from HTML,
        unless a specific <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a> is targeted,
        extracts all encountered <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a> using an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> form, if necessary.</dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-frameexpansion" data-idl="field" data-title="frameExpansion" data-type="boolean"><code>frameExpansion</code></dfn></dt>
      <dd class="changed">Enables special frame processing rules for the <a href="#expansion-algorithm">Expansion Algorithm</a>.</dd>
      <dd class="changed">Enables special rules for the <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>
        to use JSON-LD native types as values, where possible.</dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-ordered" data-idl="field" data-title="ordered" data-type="boolean"><code>ordered</code></dfn></dt>
      <dd class="changed">If set to <code>true</code>,
        certain algorithm processing steps where indicated are ordered lexicographically.
        If <code>false</code>, order is not considered in processing.</dd>
      <dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-processingmode" data-idl="field" data-title="processingMode" data-type="USVString"><code>processingMode</code></dfn></dt>
      <dd>Sets the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a>.
        If set to <code>json-ld-1.0</code> or <code>json-ld-1.1</code>,
        the implementation must produce exactly the same results as the
        algorithms defined in this specification.
        If set to another value,
        the JSON-LD processor is allowed to extend or modify the algorithms defined in this specification
        to enable application-specific optimizations.
        The definition of such optimizations is beyond the scope of this specification
        and thus not defined.
        Consequently, different implementations may implement different optimizations.
        Developers must not define modes beginning with <code>json-ld</code>
        as they are reserved for future versions of this specification.</dd>
      <dt><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-producegeneralizedrdf" data-idl="field" data-title="produceGeneralizedRdf" data-type="boolean"><code>produceGeneralizedRdf</code></dfn></dt>
      <dd>If set to <code>true</code>, the JSON-LD processor may emit
        <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank nodes</a> for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a> <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a>,
        otherwise they will be omitted.
        <dfn data-lt="generalized rdf dataset|Generalized RDF Datasets" data-dfn-type="dfn" id="dfn-generalized-rdf-dataset" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">Generalized RDF Datasets</a></dfn>
          are defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].
        <div class="note" role="note" id="issue-container-generatedID-42"><div role="heading" class="note-title marker" id="h-note-39" aria-level="4"><span>Note</span></div><div class="">The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
          and may be removed in a future version of JSON-LD,
          as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>
          and thus the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option may be also be removed.</div></div>
      </dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-rdfdirection" data-idl="field" data-title="rdfDirection" data-type="USVString"><code>rdfDirection</code></dfn></dt>
      <dd class="changed">Determines how <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value objects</a> containing a <a href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a>
        are transformed to and from RDF.
        <ul>
          <li>If set to <code>i18n-datatype</code>, an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literal</a> is generated using a datatype <abbr title="Internationalized Resource Identifier">IRI</abbr>
            based on <code>https://www.w3.org/ns/i18n#</code> with both the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> (if present)
            and <a href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> encoded.
            When transforming from RDF, this datatype is decoded to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>
            containing <code>@language</code> (if present) and <code>@direction</code>.</li>
          <li>If set to <code>compound-literal</code>, a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> is emitted instead of a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>,
            where the blank node is the subject of <code>rdf:value</code>, <code>rdf:direction</code>, and <code>rdf:language</code> (if present)
            properties.
            When transforming from RDF, this object is decoded to create a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>
            containing <code>@language</code> (if present) and <code>@direction</code>.</li>
        </ul>
      </dd><dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-usenativetypes" data-idl="field" data-title="useNativeTypes" data-type="boolean"><code>useNativeTypes</code></dfn></dt>
      <dd class="changed">Causes the <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>
        to use native JSON values in <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value objects</a> avoiding the need for an explicitly <code>@type</code>.</dd>
      <dt class="changed"><dfn data-dfn-for="JsonLdOptions" data-dfn-type="dict-member" data-export="" id="dom-jsonldoptions-userdftype" data-idl="field" data-title="useRdfType" data-type="boolean"><code>useRdfType</code></dfn></dt>
      <dd class="changed">Enables special rules for the <a href="#serialize-rdf-as-json-ld-algorithm">Serialize RDF as JSON-LD Algorithm</a>
        causing <code>rdf:type</code> properties to be kept as <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2">IRIs</a> in the output, rather than use <code>@type</code>.</dd>
      </dl>
  </section> 

  <section id="remote-document-and-context-retrieval"><h3 id="x9-4-remote-document-and-context-retrieval"><bdi class="secno">9.4 </bdi>Remote Document and Context Retrieval<a class="self-link" aria-label="§" href="#remote-document-and-context-retrieval"></a></h3>

    <p>Users of an API implementation can utilize a callback to control how
      remote documents and contexts are retrieved.
      This section details the parameters of that callback
      and the data structure used to return the retrieved context.</p>

    <section class="algorithm" id="loaddocumentcallback">
      <h4 id="x9-4-1-loaddocumentcallback"><bdi class="secno">9.4.1 </bdi>LoadDocumentCallback<a class="self-link" aria-label="§" href="#loaddocumentcallback"></a></h4>

      <p>The <dfn data-dfn-type="callback" data-export="" id="dom-loaddocumentcallback" data-idl="callback" data-title="LoadDocumentCallback" data-dfn-for=""><code>LoadDocumentCallback</code></dfn> defines a callback that custom document loaders
        have to implement to be used to retrieve remote documents and contexts.
        The callback returns a <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> resolving to a <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>.
        On failure, the <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> with a a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> having an appropriate error <a data-link-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code>code</code></a>.</p>

      <pre class="idl def" id="webidl-x1066931968"><span class="idlHeader"><a class="self-link" href="#webidl-x1066931968">WebIDL</a></span><span data-idl="" class="idlCallback" id="idl-def-loaddocumentcallback" data-title="LoadDocumentCallback">callback <a class="internalDFN idlID" data-link-for="" data-link-type="callback" href="#dom-loaddocumentcallback"><code>LoadDocumentCallback</code></a> =<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>&gt;</span> (<span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span>,
  optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-loaddocumentoptions" class="internalDFN" data-link-type="idl"><code>LoadDocumentOptions</code></a>?</span> <span class="idlParamName">options</span>
);</span></pre>

      <dl>
        <dt><dfn data-dfn-for="LoadDocumentCallback" data-dfn-type="dfn" id="dfn-url">url</dfn></dt>
        <dd>The URL of the remote document or context to load.</dd>
        <dt class="changed"><dfn data-lt="LoadDocumentCallback-options" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-loaddocumentcallback-options">options</dfn></dt>
        <dd class="changed">A set of options to determine
          the behavior of the callback. See <a href="#loaddocumentoptions" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">9.4.2 </bdi>LoadDocumentOptions</a>.</dd>
      </dl>

      <p class="changed">The following algorithm describes the default callback and places
        requirements on implementations of the callback.</p>

      <ol class="changed">
        <li>Create a new <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>promise</var> and return it.
          The following steps are then deferred.</li>
        <li id="LoadDocumentCallback-step-2">Set <var>document</var> to the body retrieved from
          the resource identified by <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>,
          or by otherwise locating a resource associated with <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>.
          When requesting remote documents the request <em class="rfc2119" title="MUST">MUST</em> prefer <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> <code>application/ld+json</code>
          followed by <code>application/json</code>.

          <p>If <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-requestprofile" class="internalDFN" data-link-type="idl"><code>requestProfile</code></a> is set,
            it <em class="rfc2119" title="MUST">MUST</em> be added as a profile on <code>application/ld+json</code>.</p>

          <p>Processors <em class="rfc2119" title="MAY">MAY</em> include other media types using a <code>+json</code> suffix as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6839" title="Additional Media Type Structured Syntax Suffixes">RFC6839</a></cite>].</p>
        </li>
        <li>Set <var>documentUrl</var> to the location of the retrieved resource
          considering redirections (exclusive of HTTP status <code>303</code> "See Other" redirects
          as discussed in [<cite><a class="bibref" data-link-type="biblio" href="#bib-cooluris" title="Cool URIs for the Semantic Web">cooluris</a></cite>]).</li>
        <li>If the retrieved resource's <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> is not <code>application/json</code>
          nor any media type with a <code>+json</code> suffix as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6839" title="Additional Media Type Structured Syntax Suffixes">RFC6839</a></cite>],
          and the response has an HTTP Link Header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>] using the <code>alternate</code> link relation
          with type <code>application/ld+json</code>,
          set <var>url</var> to the associated <code>href</code> relative to the previous <var>url</var>
          and restart the algorithm from <a href="#LoadDocumentCallback-step-2">step 2</a>.</li>
        <li id="LoadDocumentCallback-step-5">If the retrieved resource's <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> is <code>application/json</code>
          or any media type with a <code>+json</code> suffix as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6839" title="Additional Media Type Structured Syntax Suffixes">RFC6839</a></cite>]
          except <code>application/ld+json</code>,
          and the response has an HTTP Link Header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>] using the <code>http://www.w3.org/ns/json-ld#context</code> link relation,
          set <var>contextUrl</var> to the associated <code>href</code>.
          <p>If multiple HTTP Link Headers using the <code>http://www.w3.org/ns/json-ld#context</code> link relation are found,
            the <var>promise</var> is rejected with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a> is set to <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-multiple-context-link-headers" class="internalDFN" data-link-type="idl"><code>multiple context link headers</code></a>
            and processing is terminated.</p>
          <p>Processors <em class="rfc2119" title="MAY">MAY</em> transform <var>document</var> to the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>.</p>
          <div class="note" role="note" id="issue-container-generatedID-43"><div role="heading" class="note-title marker" id="h-note-40" aria-level="5"><span>Note</span></div><p class="">The HTTP Link Header is ignored for documents served as <code>application/ld+json</code>,
            <code>text/html</code>, or <code>application/xhtml+xml</code>.</p></div>
        </li>
        <li>Otherwise, the retrieved document's <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> is neither
          <code>application/json</code>,
          <code>application/ld+json</code>,
          nor any other media type using a
          <code>+json</code> suffix as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6839" title="Additional Media Type Structured Syntax Suffixes">RFC6839</a></cite>].
          Reject the <var>promise</var> passing a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a> error.</li>
        <li>Create a new <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a> <var>remote document</var> using
          <var>url</var> as <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-documenturl" class="internalDFN" data-link-type="idl"><code><code>documentUrl</code></code></a>,
          <var>document</var> as <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-document" class="internalDFN" data-link-type="idl"><code><code>document</code></code></a>,
          the returned <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> (without parameters) as <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contenttype" class="internalDFN" data-link-type="idl"><code><code>contentType</code></code></a>,
          any returned <code>profile</code> parameter, or <code>null</code> as <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-profile" class="internalDFN" data-link-type="idl"><code><code>profile</code></code></a>,
          and <var>contextUrl</var>, or <code>null</code> as <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contexturl" class="internalDFN" data-link-type="idl"><code><code>contextUrl</code></code></a>.</li>
        <li>Resolve the <var>promise</var> with <var>remote document</var>.</li>
      </ol>

      <div class="note" role="note" id="issue-container-generatedID-44"><div role="heading" class="note-title marker" id="h-note-41" aria-level="5"><span>Note</span></div><p class="">A custom <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a> set via the
        <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-documentloader" class="internalDFN" data-link-type="idl"><code>documentLoader</code></a> option might be used
        to maintain a local cache of well-known context documents or to implement
        application-specific URL protocols.</p></div>
    </section>

    <section class="changed" id="loaddocumentoptions">
      <h4 id="x9-4-2-loaddocumentoptions"><bdi class="secno">9.4.2 </bdi>LoadDocumentOptions<a class="self-link" aria-label="§" href="#loaddocumentoptions"></a></h4>

      <p>The <dfn data-dfn-type="dictionary" data-export="" id="dom-loaddocumentoptions" data-idl="dictionary" data-title="LoadDocumentOptions" data-dfn-for=""><code>LoadDocumentOptions</code></dfn> type is used to pass various options
        to the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>.</p>

      <pre class="idl def" id="webidl-x1751281130"><span class="idlHeader"><a class="self-link" href="#webidl-x1751281130">WebIDL</a></span><span data-idl="" class="idlDictionary" id="idl-def-loaddocumentoptions" data-title="LoadDocumentOptions">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-loaddocumentoptions"><code>LoadDocumentOptions</code></a> {<span data-idl="" class="idlMember" id="idl-def-loaddocumentoptions-extractallscripts" data-title="extractAllScripts" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>  <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-extractallscripts"><code>extractAllScripts</code></a> = false;</span><span data-idl="" class="idlMember" id="idl-def-loaddocumentoptions-profile" data-title="profile" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-profile"><code>profile</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-loaddocumentoptions-requestprofile" data-title="requestProfile" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  (<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>&gt;)</span> <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-requestprofile"><code>requestProfile</code></a> = null;</span>
};</span></pre>

      <dl>
        <dt><dfn data-dfn-for="LoadDocumentOptions" data-dfn-type="dict-member" data-export="" id="dom-loaddocumentoptions-extractallscripts" data-idl="field" data-title="extractAllScripts" data-type="boolean"><code>extractAllScripts</code></dfn></dt>
        <dd>If set to <code>true</code>,
          when extracting <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a> from HTML,
          unless a specific <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a> is targeted,
          extracts all encountered <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a> using an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> form, if necessary.</dd>
        <dt><dfn data-dfn-for="LoadDocumentOptions" data-dfn-type="dict-member" data-export="" id="dom-loaddocumentoptions-profile" data-idl="field" data-title="profile" data-type="USVString"><code>profile</code></dfn></dt>
        <dd>When the resulting <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contenttype" class="internalDFN" data-link-type="idl"><code><code>contentType</code></code></a> is <code>text/html</code>
          or <code>application/xhtml+xml</code>,
           this option determines the profile to use for selecting <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a>.</dd>
        <dt><dfn data-dfn-for="LoadDocumentOptions" data-dfn-type="dict-member" data-export="" id="dom-loaddocumentoptions-requestprofile" data-idl="field" data-title="requestProfile" data-type="USVString|sequence"><code>requestProfile</code></dfn></dt>
        <dd>One or more IRIs to use in the request as a <code>profile</code> parameter.
          (See <a href="https://www.w3.org/TR/json-ld11/#iana-considerations">IANA Considerations</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>]).</dd>
      </dl>
    </section>

    <section id="remotedocument">
      <h4 id="x9-4-3-remotedocument"><bdi class="secno">9.4.3 </bdi>RemoteDocument<a class="self-link" aria-label="§" href="#remotedocument"></a></h4>

      <p>The <dfn data-dfn-type="interface" data-export="" id="dom-remotedocument" data-idl="interface" data-title="RemoteDocument" data-dfn-for=""><code>RemoteDocument</code></dfn> type is used by a <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>
        to return information about a remote document or context.</p>

      <pre class="idl def" id="webidl-x2050459717"><span class="idlHeader"><a class="self-link" href="#webidl-x2050459717">WebIDL</a></span><span data-idl="" class="idlInterface" id="idl-def-remotedocument" data-title="RemoteDocument">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-remotedocument"><code>RemoteDocument</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-remotedocument-constructor" data-title="constructor" data-dfn-for="RemoteDocument">
  <dfn data-export="" data-dfn-type="constructor" id="dom-remotedocument-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RemoteDocument" data-lt="constructor()" data-local-lt="RemoteDocument.constructor|RemoteDocument.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" id="idl-def-remotedocument-contenttype" data-title="contentType" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-contenttype"><code>contentType</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-remotedocument-contexturl" data-title="contextUrl" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-contexturl"><code>contextUrl</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-remotedocument-documenturl" data-title="documentUrl" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-documenturl"><code>documentUrl</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-remotedocument-document" data-title="document" data-dfn-for="RemoteDocument">
  attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-document"><code>document</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-remotedocument-profile" data-title="profile" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-profile"><code>profile</code></a>;</span>
};</span></pre>

      <dl>
        <dt><dfn data-dfn-for="RemoteDocument" data-dfn-type="attribute" data-export="" id="dom-remotedocument-contexturl" data-idl="attribute" data-title="contextUrl" data-type="USVString" data-lt="contextUrl" data-local-lt="RemoteDocument.contextUrl"><code>contextUrl</code></dfn></dt>
        <dd>If available, the value of the HTTP Link Header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>]
          using the <code>http://www.w3.org/ns/json-ld#context</code> link relation
          in the response.
          If the response's <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> is <code>application/ld+json</code>,
          the HTTP Link Header is ignored.
          If multiple HTTP Link Headers using the <code>http://www.w3.org/ns/json-ld#context</code> link relation are found,
          the <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> of the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a> is rejected
          with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a> is set to <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-multiple-context-link-headers" class="internalDFN" data-link-type="idl"><code>multiple context link headers</code></a>.</dd>
        <dt><dfn data-dfn-for="RemoteDocument" data-dfn-type="attribute" data-export="" id="dom-remotedocument-documenturl" data-idl="attribute" data-title="documentUrl" data-type="USVString" data-lt="documentUrl" data-local-lt="RemoteDocument.documentUrl"><code>documentUrl</code></dfn></dt>
        <dd>The final URL of the loaded document.
          This is important to handle HTTP redirects properly.</dd>
        <dt><dfn data-dfn-for="RemoteDocument" data-dfn-type="attribute" data-export="" id="dom-remotedocument-document" data-idl="attribute" data-title="document" data-type="any" data-lt="document" data-local-lt="RemoteDocument.document"><code>document</code></dfn></dt>
        <dd>The retrieved document.
          This can either be the raw payload or the already parsed document.</dd>
        <dt class="changed"><dfn data-dfn-for="RemoteDocument" data-dfn-type="attribute" data-export="" id="dom-remotedocument-contenttype" data-idl="attribute" data-title="contentType" data-type="USVString" data-lt="contentType" data-local-lt="RemoteDocument.contentType"><code>contentType</code></dfn></dt>
        <dd class="changed">The <dfn data-dfn-type="dfn" id="dfn-content-type" data-no-export=""><a href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a></dfn>
          of the loaded document, exclusive of any optional parameters.</dd>
        <dt class="changed"><dfn data-dfn-for="RemoteDocument" data-dfn-type="attribute" data-export="" id="dom-remotedocument-profile" data-idl="attribute" data-title="profile" data-type="USVString" data-lt="profile" data-local-lt="RemoteDocument.profile"><code>profile</code></dfn></dt>
        <dd class="changed">The value of any <code>profile</code> parameter
          retrieved as part of the original <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contenttype" class="internalDFN" data-link-type="idl"><code><code>contentType</code></code></a>.</dd>
      </dl>
    </section>
  </section> 

  <section class="changed" id="html-content-algorithms"><h3 id="x9-5-html-content-algorithms"><bdi class="secno">9.5 </bdi>HTML Content Algorithms<a class="self-link" aria-label="§" href="#html-content-algorithms"></a></h3>
    <div class="note" role="note" id="issue-container-generatedID-45"><div role="heading" class="note-title marker" id="h-note-42" aria-level="4"><span>Note</span></div><p class="">This section describes optional features available
      with a <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-documentloader" class="internalDFN" data-link-type="idl"><code>documentLoader</code></a> supporting HTML script extraction.</p></div>
    <p>Implementations of a <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-documentloader" class="internalDFN" data-link-type="idl"><code>documentLoader</code></a> <em class="rfc2119" title="MAY">MAY</em> support extracting JSON-LD from
      <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script elements</a> contained within an HTML [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>] document.
      This section describes the normative behavior of such processors.
      Such a processor supports <dfn data-dfn-type="dfn" id="dfn-html-script-extraction">HTML script extraction</dfn>.</p>

    <section id="process-html"><h4 id="x9-5-1-process-html"><bdi class="secno">9.5.1 </bdi>Process HTML<a class="self-link" aria-label="§" href="#process-html"></a></h4>
      <p>This sections describe an extension to the algorithm specified
        in <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a> to support extracting JSON-LD from HTML.</p>

      <p><a href="#LoadDocumentCallback-step-2">Step 2</a> is updated to add the following: A processor supporting <a href="#dfn-html-script-extraction" class="internalDFN" data-link-type="dfn">HTML script extraction</a> <em class="rfc2119" title="MUST">MUST</em> include <code>text/html</code> at any preference level
        and <em class="rfc2119" title="MAY">MAY</em> include <code>application/xhtml+xml</code> at any preference level,
        unless <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-requestprofile" class="internalDFN" data-link-type="idl"><code>requestProfile</code></a> is <code>http://www.w3.org/ns/json-ld#context</code>.</p>

      <p>After <a href="#LoadDocumentCallback-step-5">step 5</a>, add the following processing step:
        Otherwise, if the retrieved resource's <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc2045#section-5">Content-Type</a> is either <code>text/html</code>
        or <code>application/xhtml+xml</code>:</p>
      <ol>
        <li>Set <var>documentUrl</var> to the <a href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#document-base-url">Document Base URL</a>
          of <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a>, as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>],
          using the existing <var>documentUrl</var> as the document's URL.
        </li>
        <li>If the <a data-link-for="LoadDocumentCallback" href="#dfn-url" class="internalDFN" data-link-type="dfn">url</a> parameter
          contains a <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a>,
          set <var>source</var> to the <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">textContent</a>
          of the <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a> in <var>document</var>
          having an <a href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute">id attribute</a>
          that matches the fragment identifier, after decoding <a href="https://tools.ietf.org/html/rfc3986#section-2.1">percent encoded sequences</a>.
          <p>If no such element is found,
            or the located element is not a <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a>,
            the <var>promise</var> is rejected with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a> is set to <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a>
            and processing is terminated.</p>
        </li>
        <li>Otherwise, if the <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-profile" class="internalDFN" data-link-type="idl"><code>profile</code></a>
          option is specified,
          set <var>source</var> to the result of transforming the
          <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">textContent</a>
          of the first <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a> in <var>document</var>
          having an <a href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-type">type attribute</a>
          of <code>application/ld+json</code> along with the value of the
          <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-profile" class="internalDFN" data-link-type="idl"><code>profile</code></a> option, if found.</li>
        <li>If <var>source</var> is still undefined and the <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a> option is not present, or <code>false</code>,
          set <var>source</var> to the <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">textContent</a>
          of the first <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a> in <var>document</var>.
          <p>If no such element is found,
            or the located element is not a <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a>,
            the <var>promise</var> is rejected with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a> is set to <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a>
            and processing is terminated.</p></li>
        <li>If <var>source</var> is defined,
          set <var>document</var> to the result of the
          <a href="#extract-script-content">Extract Script Content algorithm</a>,
          using <var>source</var>, rejecting <var>promise</var>
          with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose code set from the result, if an error is detected
          and processing is terminated.
        </li>
        <li>Otherwise, <var>source</var> is undefined.
          <ol>
            <li>If the <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a> option is not present, or <code>false</code>,
              the <var>promise</var> is rejected with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose <a data-xref-type="attribute|dict-member" data-link-for="JsonLdError" data-xref-for="JsonLdError" href="#dom-jsonlderror-code" class="internalDFN" data-link-type="idl"><code><code>code</code></code></a> is set to <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-loading-document-failed" class="internalDFN" data-link-type="idl"><code>loading document failed</code></a>
              and processing is terminated.</li>              
            <li>Otherwise, the <a data-link-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-extractallscripts" class="internalDFN" data-link-type="idl"><code>extractAllScripts</code></a> option is <code>true</code>.
              Set <var>document</var> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>.
              For each <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a> in <var>input</var>:
              <ol>
                <li>Set <var>source</var> to its <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">textContent</a>.</li>
                <li>Set <var>script content</var> to the result of the <a href="#extract-script-content">Extract Script Content algorithm</a>,
                  using <var>source</var>, rejecting <var>promise</var>
                  with a <a href="#dom-jsonlderror" class="internalDFN" data-link-type="idl"><code>JsonLdError</code></a> whose code set from the result, if an error is detected
                  and processing is terminated.</li>
                <li>If <var>script content</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a>, merge it to the end of <var>document</var>.</li>
                <li>Otherwise, append <var>script content</var> to <var>document</var>.</li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </section>

    <section id="extract-script-content" class="algorithm">
      <h4 id="x9-5-2-extract-script-content-algorithm"><bdi class="secno">9.5.2 </bdi>Extract Script Content Algorithm<a class="self-link" aria-label="§" href="#extract-script-content"></a></h4>

      <p>The algorithm extracts the text content a
        <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a> into a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
        A <dfn data-dfn-type="dfn" data-plurals="json-ld script elements" id="dfn-json-ld-script-element">JSON-LD script element</dfn> is a <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a>
        within an HTML [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>] document with the <a href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-type">type attribute</a> set to
        <code>application/ld+json</code>.</p>

      <p>The algorithm takes a single required input variable: <var>source</var>,
        the <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">textContent</a> of an HTML <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a>.</p>

      <ol>
      <li>If <var>source</var> is not a valid JSON document,
        an <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-invalid-script-element" class="internalDFN" data-link-type="idl"><code>invalid script element</code></a> has been detected, and processing is aborted.</li>
      <li>Return the result of transforming <var>source</var> into the <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>.</li>
      </ol>
    </section>
  </section>

  <section id="error-handling"><h3 id="x9-6-error-handling"><bdi class="secno">9.6 </bdi>Error Handling<a class="self-link" aria-label="§" href="#error-handling"></a></h3>

    <p>This section describes the datatype definitions
      used within the JSON-LD API for error handling.</p>

    <section id="jsonlderror">
      <h4 id="x9-6-1-jsonlderror"><bdi class="secno">9.6.1 </bdi>JsonLdError<a class="self-link" aria-label="§" href="#jsonlderror"></a></h4>

      <p>The <dfn data-dfn-type="dictionary" data-export="" id="dom-jsonlderror" data-idl="dictionary" data-title="JsonLdError" data-dfn-for=""><code>JsonLdError</code></dfn> type is used to report processing errors.</p>

      <pre class="idl def" id="webidl-x1417274188"><span class="idlHeader"><a class="self-link" href="#webidl-x1417274188">WebIDL</a></span><span data-idl="" class="idlDictionary" id="idl-def-jsonlderror" data-title="JsonLdError">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-jsonlderror"><code>JsonLdError</code></a> {<span data-idl="" class="idlMember" id="idl-def-jsonlderror-code" data-title="code" data-dfn-for="JsonLdError"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-jsonlderrorcode" class="internalDFN" data-link-type="idl"><code>JsonLdErrorCode</code></a></span> <a class="internalDFN idlName" data-link-for="JsonLdError" data-link-type="dict-member" href="#dom-jsonlderror-code"><code>code</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-jsonlderror-message" data-title="message" data-dfn-for="JsonLdError"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>      <a class="internalDFN idlName" data-link-for="JsonLdError" data-link-type="dict-member" href="#dom-jsonlderror-message"><code>message</code></a> = null;</span>
};</span></pre>

      <dl>
        <dt><dfn data-dfn-for="JsonLdError" data-dfn-type="dict-member" data-export="" id="dom-jsonlderror-code" data-idl="field" data-title="code" data-type="JsonLdErrorCode"><code>code</code></dfn></dt>
        <dd>A string representing the particular error type,
          as described in the various algorithms in this document.</dd>
        <dt><dfn data-dfn-for="JsonLdError" data-dfn-type="dict-member" data-export="" id="dom-jsonlderror-message" data-idl="field" data-title="message" data-type="USVString"><code>message</code></dfn></dt>
        <dd>An optional error message containing additional debugging information.
          The specific contents of error messages are outside the scope of this specification.</dd>
      </dl>
    </section>

    <section id="jsonlderrorcode">
      <h4 id="x9-6-2-jsonlderrorcode"><bdi class="secno">9.6.2 </bdi>JsonLdErrorCode<a class="self-link" aria-label="§" href="#jsonlderrorcode"></a></h4>
      <p>The <dfn data-dfn-type="enum" data-export="" id="dom-jsonlderrorcode" data-idl="enum" data-title="JsonLdErrorCode" data-dfn-for=""><code>JsonLdErrorCode</code></dfn> represents the collection of valid JSON-LD error codes.</p>

      <pre class="idl def" id="webidl-x812865817"><span class="idlHeader"><a class="self-link" href="#webidl-x812865817">WebIDL</a></span><span data-idl="" class="idlEnum" id="idl-def-jsonlderrorcode" data-title="JsonLdErrorCode">enum <a class="internalDFN idlID" data-link-for="" data-link-type="enum" href="#dom-jsonlderrorcode"><code>JsonLdErrorCode</code></a> {
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-iri-confused-with-prefix"><code>IRI confused with prefix</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-colliding-keywords"><code>colliding keywords</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-conflicting-indexes"><code>conflicting indexes</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-context-overflow"><code>context overflow</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-cyclic-iri-mapping"><code>cyclic IRI mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@id-value"><code>invalid @id value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@import-value"><code>invalid @import value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@included-value"><code>invalid @included value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@index-value"><code>invalid @index value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@nest-value"><code>invalid @nest value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@prefix-value"><code>invalid @prefix value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@propagate-value"><code>invalid @propagate value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@protected-value"><code>invalid @protected value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@reverse-value"><code>invalid @reverse value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@version-value"><code>invalid @version value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-iri-mapping"><code>invalid IRI mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-json-literal"><code>invalid JSON literal</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-base-iri"><code>invalid base IRI</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-base-direction"><code>invalid base direction</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-container-mapping"><code>invalid container mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-context-entry"><code>invalid context entry</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-context-nullification"><code>invalid context nullification</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-default-language"><code>invalid default language</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-keyword-alias"><code>invalid keyword alias</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-map-value"><code>invalid language map value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-mapping"><code>invalid language mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-tagged-string"><code>invalid language-tagged string</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-tagged-value"><code>invalid language-tagged value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-local-context"><code>invalid local context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-remote-context"><code>invalid remote context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property-map"><code>invalid reverse property map</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property-value"><code>invalid reverse property value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property"><code>invalid reverse property</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-scoped-context"><code>invalid scoped context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-script-element"><code>invalid script element</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-set-or-list-object"><code>invalid set or list object</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-term-definition"><code>invalid term definition</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-type-mapping"><code>invalid type mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-type-value"><code>invalid type value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-typed-value"><code>invalid typed value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-value-object-value"><code>invalid value object value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-value-object"><code>invalid value object</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-vocab-mapping"><code>invalid vocab mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-keyword-redefinition"><code>keyword redefinition</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-loading-document-failed"><code>loading document failed</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-loading-remote-context-failed"><code>loading remote context failed</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-multiple-context-link-headers"><code>multiple context link headers</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-processing-mode-conflict"><code>processing mode conflict</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-protected-term-redefinition"><code>protected term redefinition</code></a>"</span>
};</span></pre>

      <dl data-dfn-for="JsonLdErrorCode" data-sort=""><dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-colliding-keywords" data-idl="enum-value" data-title="colliding keywords" data-dfn-for="JsonLdErrorCode"><code>colliding keywords</code></dfn></dt>
        <dd>Two <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> which expand to the same keyword have been detected.
          This might occur if a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a>
          and an alias thereof
          are used at the same time.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-conflicting-indexes" data-idl="enum-value" data-title="conflicting indexes" data-dfn-for="JsonLdErrorCode"><code>conflicting indexes</code></dfn></dt>
        <dd>Multiple conflicting indexes have been found for the same node.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-context-overflow" data-idl="enum-value" data-title="context overflow" data-dfn-for="JsonLdErrorCode"><code>context overflow</code></dfn></dt>
        <dd>maximum number of <code>@context</code> URLs exceeded.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-cyclic-iri-mapping" data-idl="enum-value" data-title="cyclic IRI mapping" data-dfn-for="JsonLdErrorCode"><code>cyclic <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></dfn></dt>
        <dd>A cycle in <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mappings</a> has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@id-value" data-idl="enum-value" data-title="invalid @id value" data-dfn-for="JsonLdErrorCode"><code>invalid @id value</code></dfn></dt>
        <dd>An <code>@id</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> was encountered whose value was not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@import-value" data-idl="enum-value" data-title="invalid @import value" data-dfn-for="JsonLdErrorCode"><code>invalid @import value</code></dfn></dt>
        <dd class="changed">An invalid value for <code>@import</code> has been found.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@included-value" data-idl="enum-value" data-title="invalid @included value" data-dfn-for="JsonLdErrorCode"><code>invalid @included value</code></dfn></dt>
        <dd class="changed">An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-included-block">included block</a> contains an invalid value.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@index-value" data-idl="enum-value" data-title="invalid @index value" data-dfn-for="JsonLdErrorCode"><code>invalid @index value</code></dfn></dt>
        <dd>An <code>@index</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> was encountered whose value was not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@nest-value" data-idl="enum-value" data-title="invalid @nest value" data-dfn-for="JsonLdErrorCode"><code>invalid @nest value</code></dfn></dt>
        <dd class="changed">An invalid value for <code>@nest</code> has been found.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@prefix-value" data-idl="enum-value" data-title="invalid @prefix value" data-dfn-for="JsonLdErrorCode"><code>invalid @prefix value</code></dfn></dt>
        <dd class="changed">An invalid value for <code>@prefix</code> has been found.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@propagate-value" data-idl="enum-value" data-title="invalid @propagate value" data-dfn-for="JsonLdErrorCode"><code>invalid @propagate value</code></dfn></dt>
        <dd class="changed">An invalid value for <code>@propagate</code> has been found.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@protected-value" data-idl="enum-value" data-title="invalid @protected value" data-dfn-for="JsonLdErrorCode"><code>invalid @protected value</code></dfn></dt>
        <dd class="changed">An invalid value for <code>@protected</code> has been found.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@reverse-value" data-idl="enum-value" data-title="invalid @reverse value" data-dfn-for="JsonLdErrorCode"><code>invalid @reverse value</code></dfn></dt>
        <dd>An invalid value for an <code>@reverse</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> has been detected,
          i.e., the value was not a <a class="changed" data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-@version-value" data-idl="enum-value" data-title="invalid @version value" data-dfn-for="JsonLdErrorCode"><code>invalid @version value</code></dfn></dt>
        <dd>The <code>@version</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> was used in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a>
          with an out of range value.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-base-direction" data-idl="enum-value" data-title="invalid base direction" data-dfn-for="JsonLdErrorCode"><code>invalid base direction</code></dfn></dt>
        <dd class="changed">The value of <code>@direction</code> is not <code>"ltr"</code>, <code>"rtl"</code>,
          or <code>null</code> and thus invalid.</dd><dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-base-iri" data-idl="enum-value" data-title="invalid base IRI" data-dfn-for="JsonLdErrorCode"><code>invalid base <abbr title="Internationalized Resource Identifier">IRI</abbr></code></dfn></dt>
        <dd>An invalid <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> has been detected, i.e.,
          it is neither an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> nor <code>null</code>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-container-mapping" data-idl="enum-value" data-title="invalid container mapping" data-dfn-for="JsonLdErrorCode"><code>invalid container mapping</code></dfn></dt>
        <dd>An <code>@container</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> was encountered
          whose value was not one of the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>:
          <code>@list</code>,
          <code>@set</code>,
          or <code>@index</code>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-context-entry" data-idl="enum-value" data-title="invalid context entry" data-dfn-for="JsonLdErrorCode"><code>invalid context entry</code></dfn></dt>
        <dd class="changed">An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a context is invalid due to processing mode incompatibility.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-context-nullification" data-idl="enum-value" data-title="invalid context nullification" data-dfn-for="JsonLdErrorCode"><code>invalid context nullification</code></dfn></dt>
        <dd class="changed">An attempt was made to nullify a context
          containing <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a> <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-default-language" data-idl="enum-value" data-title="invalid default language" data-dfn-for="JsonLdErrorCode"><code>invalid default language</code></dfn></dt>
        <dd>The value of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-default-language">default language</a> is not a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>
          or <code>null</code> and thus invalid.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-iri-mapping" data-idl="enum-value" data-title="invalid IRI mapping" data-dfn-for="JsonLdErrorCode"><code>invalid <abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> contains a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>
          that has an invalid or missing <a href="#dfn-iri-mapping" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> mapping</a>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-json-literal" data-idl="enum-value" data-title="invalid JSON literal" data-dfn-for="JsonLdErrorCode"><code>invalid JSON literal</code></dfn></dt>
        <dd class="changed">An invalid JSON literal was detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-keyword-alias" data-idl="enum-value" data-title="invalid keyword alias" data-dfn-for="JsonLdErrorCode"><code>invalid keyword alias</code></dfn></dt>
        <dd>An invalid <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> alias definition has been encountered.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-language-map-value" data-idl="enum-value" data-title="invalid language map value" data-dfn-for="JsonLdErrorCode"><code>invalid language map value</code></dfn></dt>
        <dd>An invalid value in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-language-map">language map</a> has been detected.
          It <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> or an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-language-mapping" data-idl="enum-value" data-title="invalid language mapping" data-dfn-for="JsonLdErrorCode"><code>invalid language mapping</code></dfn></dt>
        <dd>An <code>@language</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
          was encountered whose value was neither a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a>
          nor <code>null</code> and thus invalid.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-language-tagged-string" data-idl="enum-value" data-title="invalid language-tagged string" data-dfn-for="JsonLdErrorCode"><code>invalid language-tagged string</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a> with an invalid language value was detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-language-tagged-value" data-idl="enum-value" data-title="invalid language-tagged value" data-dfn-for="JsonLdErrorCode"><code>invalid language-tagged value</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-terms-and-definitions-number-value">number</a>, <code>true</code>, or <code>false</code>
          with an associated <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> was detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-local-context" data-idl="enum-value" data-title="invalid local context" data-dfn-for="JsonLdErrorCode"><code>invalid local context</code></dfn></dt>
        <dd>In invalid <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a> was detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-remote-context" data-idl="enum-value" data-title="invalid remote context" data-dfn-for="JsonLdErrorCode"><code>invalid remote context</code></dfn></dt>
        <dd>No valid context document has been found for a referenced remote context.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-reverse-property" data-idl="enum-value" data-title="invalid reverse property" data-dfn-for="JsonLdErrorCode"><code>invalid reverse property</code></dfn></dt>
        <dd>An invalid reverse property definition has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-reverse-property-map" data-idl="enum-value" data-title="invalid reverse property map" data-dfn-for="JsonLdErrorCode"><code>invalid reverse property map</code></dfn></dt>
        <dd>An invalid reverse property map has been detected.
          No <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keywords</a> apart from <code>@context</code>
          are allowed in reverse property maps.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-reverse-property-value" data-idl="enum-value" data-title="invalid reverse property value" data-dfn-for="JsonLdErrorCode"><code>invalid reverse property value</code></dfn></dt>
        <dd>An invalid value for a reverse property has been detected.
          The value of an inverse property must be a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-scoped-context" data-idl="enum-value" data-title="invalid scoped context" data-dfn-for="JsonLdErrorCode"><code>invalid scoped context</code></dfn></dt>
        <dd class="changed">The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>
          defined within a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
          is invalid.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-script-element" data-idl="enum-value" data-title="invalid script element" data-dfn-for="JsonLdErrorCode"><code>invalid script element</code></dfn></dt>
        <dd class="changed">A <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a> in HTML input
          which is the target of a <a href="https://tools.ietf.org/html/rfc3986#section-3.5">fragment identifier</a>
          does not have an appropriate <a href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-type">type attribute</a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-set-or-list-object" data-idl="enum-value" data-title="invalid set or list object" data-dfn-for="JsonLdErrorCode"><code>invalid set or list object</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-set-object">set object</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-list-object">list object</a>
          with disallowed <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a>
          has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-term-definition" data-idl="enum-value" data-title="invalid term definition" data-dfn-for="JsonLdErrorCode"><code>invalid term definition</code></dfn></dt>
        <dd>An invalid <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-type-mapping" data-idl="enum-value" data-title="invalid type mapping" data-dfn-for="JsonLdErrorCode"><code>invalid type mapping</code></dfn></dt>
        <dd>An <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a>
          was encountered whose value could not be expanded to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-type-value" data-idl="enum-value" data-title="invalid type value" data-dfn-for="JsonLdErrorCode"><code>invalid type value</code></dfn></dt>
        <dd>An invalid value for an <code>@type</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> has been detected,
          i.e., the value was neither a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> nor an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">strings</a>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-typed-value" data-idl="enum-value" data-title="invalid typed value" data-dfn-for="JsonLdErrorCode"><code>invalid typed value</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-typed-value">typed value</a> with an invalid type was detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-value-object" data-idl="enum-value" data-title="invalid value object" data-dfn-for="JsonLdErrorCode"><code>invalid value object</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a> with disallowed <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-value-object-value" data-idl="enum-value" data-title="invalid value object value" data-dfn-for="JsonLdErrorCode"><code>invalid value object value</code></dfn></dt>
        <dd>An invalid value for the <code>@value</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">value object</a>
          has been detected,
          i.e., it is neither a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#primitive-data-types">scalar</a> nor <code>null</code>.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-invalid-vocab-mapping" data-idl="enum-value" data-title="invalid vocab mapping" data-dfn-for="JsonLdErrorCode"><code>invalid vocab mapping</code></dfn></dt>
        <dd>An invalid <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a> has been detected,
          i.e., it is neither an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> nor <code>null</code>.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-iri-confused-with-prefix" data-idl="enum-value" data-title="IRI confused with prefix" data-dfn-for="JsonLdErrorCode"><code><abbr title="Internationalized Resource Identifier">IRI</abbr> confused with prefix</code></dfn></dt>
        <dd>When compacting an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> would result in an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>
          which could be confused with a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a>
          (because its <a href="https://tools.ietf.org/html/rfc3986#section-3.1"><abbr title="Internationalized Resource Identifier">IRI</abbr> scheme</a> matches a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> and it has no <a href="https://tools.ietf.org/html/rfc3986#section-3.1"><abbr title="Internationalized Resource Identifier">IRI</abbr> authority</a>).</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-keyword-redefinition" data-idl="enum-value" data-title="keyword redefinition" data-dfn-for="JsonLdErrorCode"><code>keyword redefinition</code></dfn></dt>
        <dd>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-keyword">keyword</a> redefinition has been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-loading-document-failed" data-idl="enum-value" data-title="loading document failed" data-dfn-for="JsonLdErrorCode"><code>loading document failed</code></dfn></dt>
        <dd>The document could not be loaded or parsed as JSON.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-loading-remote-context-failed" data-idl="enum-value" data-title="loading remote context failed" data-dfn-for="JsonLdErrorCode"><code>loading remote context failed</code></dfn></dt>
        <dd>There was a problem encountered loading a remote context.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-multiple-context-link-headers" data-idl="enum-value" data-title="multiple context link headers" data-dfn-for="JsonLdErrorCode"><code>multiple context link headers</code></dfn></dt>
        <dd>Multiple HTTP Link Headers [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>]
          using the <code>http://www.w3.org/ns/json-ld#context</code> link relation
          have been detected.</dd>
        <dt><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-processing-mode-conflict" data-idl="enum-value" data-title="processing mode conflict" data-dfn-for="JsonLdErrorCode"><code>processing mode conflict</code></dfn></dt>
        <dd>An attempt was made to change the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a>
          which is incompatible with the previous specified version.</dd>
        <dt class="changed"><dfn data-dfn-type="enum-value" data-export="" id="dom-jsonlderrorcode-protected-term-redefinition" data-idl="enum-value" data-title="protected term redefinition" data-dfn-for="JsonLdErrorCode"><code>protected term redefinition</code></dfn></dt>
        <dd class="changed">An attempt was made to redefine a <a href="#dfn-protected" class="internalDFN" data-link-type="dfn">protected</a> term.</dd>
        </dl>
    </section>
  </section> 
</section> 

<section id="security"><h2 id="x10-security-considerations"><bdi class="secno">10. </bdi>Security Considerations<a class="self-link" aria-label="§" href="#security"></a></h2>
  <p>See, <a href="https://www.w3.org/TR/json-ld11/#security">Security Considerations</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].</p>
</section>

<section id="privacy"><h2 id="x11-privacy-considerations"><bdi class="secno">11. </bdi>Privacy Considerations<a class="self-link" aria-label="§" href="#privacy"></a></h2>
  <p>See, <a href="https://www.w3.org/TR/json-ld11/#privacy">Privacy Considerations</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].</p>
</section>

<section id="internationalization"><h2 id="x12-internationalization-considerations"><bdi class="secno">12. </bdi>Internationalization Considerations<a class="self-link" aria-label="§" href="#internationalization"></a></h2>
  <p>See, <a href="https://www.w3.org/TR/json-ld11/#internationalization">Internationalization Considerations</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].</p>
</section>

<section id="idl-index" class="appendix informative"><h2 id="a-idl-index"><bdi class="secno">A. </bdi>IDL Index<a class="self-link" aria-label="§" href="#idl-index"></a></h2><p><em>This section is non-normative.</em></p>
<pre class="idl def" id="actual-idl-index"><span class="idlHeader"><a class="self-link" href="#actual-idl-index">WebIDL</a></span><span data-idl="" class="idlInterface" data-title="JsonLdProcessor">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-jsonldprocessor"><code>JsonLdProcessor</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="JsonLdProcessor">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="JsonLdProcessor" data-lt="constructor()" data-local-lt="JsonLdProcessor.constructor|JsonLdProcessor.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlMethod" data-title="compact" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-compact"><code>compact</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldcontext" class="internalDFN" data-link-type="idl"><code>JsonLdContext</code></a></span> <span class="idlParamName">context</span> = null,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" data-title="expand" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-expand"><code>expand</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" data-title="flatten" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-flatten"><code>flatten</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldcontext" class="internalDFN" data-link-type="idl"><code>JsonLdContext</code></a></span> <span class="idlParamName">context</span> = null,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" data-title="fromRdf" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt;&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-fromrdf"><code>fromRdf</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span><span data-idl="" class="idlMethod" data-title="toRdf" data-dfn-for="JsonLdProcessor">
  static<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-rdfdataset" class="internalDFN" data-link-type="idl"><code>RdfDataset</code></a>&gt;</span> <a class="internalDFN idlName" data-link-for="JsonLdProcessor" data-link-type="method" href="#dom-jsonldprocessor-tordf"><code>toRdf</code></a>(<span class="idlType">
    <a data-xref-type="_IDL_" href="#dom-jsonldinput" class="internalDFN" data-link-type="idl"><code>JsonLdInput</code></a></span> <span class="idlParamName">input</span>,
    optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code>JsonLdOptions</code></a></span> <span class="idlParamName">options</span> = {});</span>
};</span>

<span data-idl="" class="idlTypedef" data-title="JsonLdRecord">typedef<span class="idlType"> <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-record">record</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>, <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldrecord"><code>JsonLdRecord</code></a>;</span>

<span data-idl="" class="idlTypedef" data-title="JsonLdInput">typedef<span class="idlType"> (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>&gt; or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="_IDL_" href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>)</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldinput"><code>JsonLdInput</code></a>;</span>

<span data-idl="" class="idlTypedef" data-title="JsonLdContext">typedef<span class="idlType"> (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;(<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a> or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)&gt; or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)</span> <a class="internalDFN idlID" data-link-for="" data-link-type="typedef" href="#dom-jsonldcontext"><code>JsonLdContext</code></a>;</span>

<span data-idl="" class="idlInterface" data-title="RdfDataset">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfdataset"><code>RdfDataset</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="RdfDataset">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfDataset" data-lt="constructor()" data-local-lt="RdfDataset.constructor|RdfDataset.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" data-title="defaultGraph" data-dfn-for="RdfDataset">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a></span> <a class="internalDFN idlName" data-link-for="RdfDataset" data-link-type="attribute" href="#dom-rdfdataset-defaultgraph"><code>defaultGraph</code></a>;</span><span data-idl="" class="idlMethod" data-title="add" data-dfn-for="RdfDataset"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName" data-link-for="RdfDataset" data-link-type="method" href="#dom-rdfdataset-add"><code>add</code></a>(<span class="idlType"><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">graphName</span>,<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a></span> <span class="idlParamName">graph</span>);</span><span data-idl="" class="idlIterable" data-title="iterable" data-dfn-for="RdfDataset">
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-iterable">iterable</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?, <a data-xref-type="_IDL_" href="#dom-rdfgraph" class="internalDFN" data-link-type="idl"><code>RdfGraph</code></a>&gt;;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="RdfGraph">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfgraph"><code>RdfGraph</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="RdfGraph">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfGraph" data-lt="constructor()" data-local-lt="RdfGraph.constructor|RdfGraph.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlMethod" data-title="add" data-dfn-for="RdfGraph"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName" data-link-for="RdfGraph" data-link-type="method" href="#dom-rdfgraph-add"><code>add</code></a>(<span class="idlType"><a data-xref-type="_IDL_" href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a></span> <span class="idlParamName">triple</span>);</span><span data-idl="" class="idlIterable" data-title="iterable" data-dfn-for="RdfGraph">
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-iterable">iterable</a>&lt;<a data-xref-type="_IDL_" href="#dom-rdftriple" class="internalDFN" data-link-type="idl"><code>RdfTriple</code></a>&gt;;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="RdfTriple">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdftriple"><code>RdfTriple</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="RdfTriple">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfTriple" data-lt="constructor()" data-local-lt="RdfTriple.constructor|RdfTriple.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" data-title="subject" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-subject"><code>subject</code></a>;</span><span data-idl="" class="idlAttribute" data-title="predicate" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-predicate"><code>predicate</code></a>;</span><span data-idl="" class="idlAttribute" data-title="object" data-dfn-for="RdfTriple">
  readonly attribute<span class="idlType"> (<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="_IDL_" href="#dom-rdfliteral" class="internalDFN" data-link-type="idl"><code>RdfLiteral</code></a>)</span> <a class="internalDFN idlName" data-link-for="RdfTriple" data-link-type="attribute" href="#dom-rdftriple-object"><code>_object</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="RdfLiteral">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-rdfliteral"><code>RdfLiteral</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="RdfLiteral">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RdfLiteral" data-lt="constructor()" data-local-lt="RdfLiteral.constructor|RdfLiteral.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" data-title="value" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-value"><code>value</code></a>;</span><span data-idl="" class="idlAttribute" data-title="datatype" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-datatype"><code>datatype</code></a>;</span><span data-idl="" class="idlAttribute" data-title="language" data-dfn-for="RdfLiteral">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName" data-link-for="RdfLiteral" data-link-type="attribute" href="#dom-rdfliteral-language"><code>language</code></a>;</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="JsonLdOptions">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-jsonldoptions"><code>JsonLdOptions</code></a> {<span data-idl="" class="idlMember" data-title="base" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>             <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-base"><code>base</code></a> = null;</span><span data-idl="" class="idlMember" data-title="compactArrays" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-compactarrays"><code>compactArrays</code></a> = true;</span><span data-idl="" class="idlMember" data-title="compactToRelative" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-compacttorelative"><code>compactToRelative</code></a> = true;</span><span data-idl="" class="idlMember" data-title="documentLoader" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>?</span>  <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-documentloader"><code>documentLoader</code></a> = null;</span><span data-idl="" class="idlMember" data-title="expandContext" data-dfn-for="JsonLdOptions"><span class="idlType">
  (<a data-xref-type="_IDL_" href="#dom-jsonldrecord" class="internalDFN" data-link-type="idl"><code>JsonLdRecord</code></a>? or <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>)</span> <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-expandcontext"><code>expandContext</code></a> = null;</span><span data-idl="" class="idlMember" data-title="extractAllScripts" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-extractallscripts"><code>extractAllScripts</code></a> = false;</span><span data-idl="" class="idlMember" data-title="frameExpansion" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-frameexpansion"><code>frameExpansion</code></a> = false;</span><span data-idl="" class="idlMember" data-title="ordered" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-ordered"><code>ordered</code></a> = false;</span><span data-idl="" class="idlMember" data-title="processingMode" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span>              <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-processingmode"><code>processingMode</code></a> = "json-ld-1.1";</span><span data-idl="" class="idlMember" data-title="produceGeneralizedRdf" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-producegeneralizedrdf"><code>produceGeneralizedRdf</code></a> = true;</span><span data-idl="" class="idlMember" data-title="rdfDirection" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>             <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-rdfdirection"><code>rdfDirection</code></a> = null;</span><span data-idl="" class="idlMember" data-title="useNativeTypes" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-usenativetypes"><code>useNativeTypes</code></a> = false;</span><span data-idl="" class="idlMember" data-title="useRdfType" data-dfn-for="JsonLdOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>                <a class="internalDFN idlName" data-link-for="JsonLdOptions" data-link-type="dict-member" href="#dom-jsonldoptions-userdftype"><code>useRdfType</code></a> = false;</span>
};</span>

<span data-idl="" class="idlCallback" data-title="LoadDocumentCallback">callback <a class="internalDFN idlID" data-link-for="" data-link-type="callback" href="#dom-loaddocumentcallback"><code>LoadDocumentCallback</code></a> =<span class="idlType"> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>&gt;</span> (<span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span>,
  optional<span class="idlType"> <a data-xref-type="_IDL_" href="#dom-loaddocumentoptions" class="internalDFN" data-link-type="idl"><code>LoadDocumentOptions</code></a>?</span> <span class="idlParamName">options</span>
);</span>

<span data-idl="" class="idlDictionary" data-title="LoadDocumentOptions">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-loaddocumentoptions"><code>LoadDocumentOptions</code></a> {<span data-idl="" class="idlMember" data-title="extractAllScripts" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean">boolean</a></span>  <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-extractallscripts"><code>extractAllScripts</code></a> = false;</span><span data-idl="" class="idlMember" data-title="profile" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-profile"><code>profile</code></a> = null;</span><span data-idl="" class="idlMember" data-title="requestProfile" data-dfn-for="LoadDocumentOptions"><span class="idlType">
  (<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a> or <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>&gt;)</span> <a class="internalDFN idlName" data-link-for="LoadDocumentOptions" data-link-type="dict-member" href="#dom-loaddocumentoptions-requestprofile"><code>requestProfile</code></a> = null;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="RemoteDocument">[<span class="extAttr"><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface" data-lt="WorkerGlobalScope" data-cite-path="workers.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for="" data-link-type="interface" href="#dom-remotedocument"><code>RemoteDocument</code></a> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="RemoteDocument">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="RemoteDocument" data-lt="constructor()" data-local-lt="RemoteDocument.constructor|RemoteDocument.constructor()|constructor"><code>constructor</code></dfn>();</span><span data-idl="" class="idlAttribute" data-title="contentType" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-contenttype"><code>contentType</code></a>;</span><span data-idl="" class="idlAttribute" data-title="contextUrl" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-contexturl"><code>contextUrl</code></a>;</span><span data-idl="" class="idlAttribute" data-title="documentUrl" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-documenturl"><code>documentUrl</code></a>;</span><span data-idl="" class="idlAttribute" data-title="document" data-dfn-for="RemoteDocument">
  attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-document"><code>document</code></a>;</span><span data-idl="" class="idlAttribute" data-title="profile" data-dfn-for="RemoteDocument">
  readonly attribute<span class="idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-for="RemoteDocument" data-link-type="attribute" href="#dom-remotedocument-profile"><code>profile</code></a>;</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="JsonLdError">dictionary <a class="internalDFN idlID" data-link-for="" data-link-type="dictionary" href="#dom-jsonlderror"><code>JsonLdError</code></a> {<span data-idl="" class="idlMember" data-title="code" data-dfn-for="JsonLdError"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-jsonlderrorcode" class="internalDFN" data-link-type="idl"><code>JsonLdErrorCode</code></a></span> <a class="internalDFN idlName" data-link-for="JsonLdError" data-link-type="dict-member" href="#dom-jsonlderror-code"><code>code</code></a>;</span><span data-idl="" class="idlMember" data-title="message" data-dfn-for="JsonLdError"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span>      <a class="internalDFN idlName" data-link-for="JsonLdError" data-link-type="dict-member" href="#dom-jsonlderror-message"><code>message</code></a> = null;</span>
};</span>

<span data-idl="" class="idlEnum" data-title="JsonLdErrorCode">enum <a class="internalDFN idlID" data-link-for="" data-link-type="enum" href="#dom-jsonlderrorcode"><code>JsonLdErrorCode</code></a> {
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-iri-confused-with-prefix"><code>IRI confused with prefix</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-colliding-keywords"><code>colliding keywords</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-conflicting-indexes"><code>conflicting indexes</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-context-overflow"><code>context overflow</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-cyclic-iri-mapping"><code>cyclic IRI mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@id-value"><code>invalid @id value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@import-value"><code>invalid @import value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@included-value"><code>invalid @included value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@index-value"><code>invalid @index value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@nest-value"><code>invalid @nest value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@prefix-value"><code>invalid @prefix value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@propagate-value"><code>invalid @propagate value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@protected-value"><code>invalid @protected value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@reverse-value"><code>invalid @reverse value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-@version-value"><code>invalid @version value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-iri-mapping"><code>invalid IRI mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-json-literal"><code>invalid JSON literal</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-base-iri"><code>invalid base IRI</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-base-direction"><code>invalid base direction</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-container-mapping"><code>invalid container mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-context-entry"><code>invalid context entry</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-context-nullification"><code>invalid context nullification</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-default-language"><code>invalid default language</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-keyword-alias"><code>invalid keyword alias</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-map-value"><code>invalid language map value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-mapping"><code>invalid language mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-tagged-string"><code>invalid language-tagged string</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-language-tagged-value"><code>invalid language-tagged value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-local-context"><code>invalid local context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-remote-context"><code>invalid remote context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property-map"><code>invalid reverse property map</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property-value"><code>invalid reverse property value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-reverse-property"><code>invalid reverse property</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-scoped-context"><code>invalid scoped context</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-script-element"><code>invalid script element</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-set-or-list-object"><code>invalid set or list object</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-term-definition"><code>invalid term definition</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-type-mapping"><code>invalid type mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-type-value"><code>invalid type value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-typed-value"><code>invalid typed value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-value-object-value"><code>invalid value object value</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-value-object"><code>invalid value object</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-invalid-vocab-mapping"><code>invalid vocab mapping</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-keyword-redefinition"><code>keyword redefinition</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-loading-document-failed"><code>loading document failed</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-loading-remote-context-failed"><code>loading remote context failed</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-multiple-context-link-headers"><code>multiple context link headers</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-processing-mode-conflict"><code>processing mode conflict</code></a>"</span>,
    <span class="idlEnumItem">"<a class="internalDFN" data-link-for="JsonLdErrorCode" data-link-type="enum-value" href="#dom-jsonlderrorcode-protected-term-redefinition"><code>protected term redefinition</code></a>"</span>
};</span></pre></section>

<section class="appendix informative preserve" id="open-issues"><h2 id="b-open-issues"><bdi class="secno">B. </bdi>Open Issues<a class="self-link" aria-label="§" href="#open-issues"></a></h2><p><em>This section is non-normative.</em></p>
  <p>The following is a list of issues open at the time of publication.</p>
  <div class="issue" id="issue-container-number-76"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="3"><a href="https://github.com/w3c/json-ld-api/issues/76"><span class="issue-number">Issue 76</span></a><span class="issue-label" aria-label="This issue is labelled as defer-future-version.">: More compact @prefix <a class="respec-gh-label respec-label-dark" href="https://github.com/w3c/json-ld-api/issues/?q=is%3Aissue+is%3Aopen+label%3A%22defer-future-version%22" style="background-color: rgb(0, 0, 0);">defer-future-version</a></span></div><p class="">More compact @prefix.</p></div>
  <div class="issue" id="issue-container-number-94"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="3"><a href="https://github.com/w3c/json-ld-api/issues/94"><span class="issue-number">Issue 94</span></a><span class="issue-label" aria-label="This issue is labelled as defer-future-version.">: Expansion concept "key's term definition" is unclear with compact IRI keys <a class="respec-gh-label respec-label-dark" href="https://github.com/w3c/json-ld-api/issues/?q=is%3Aissue+is%3Aopen+label%3A%22defer-future-version%22" style="background-color: rgb(0, 0, 0);">defer-future-version</a></span></div><p class="">Expansion concept "key's term definition" is unclear with compact <abbr title="Internationalized Resource Identifier">IRI</abbr> keys.</p></div>
  <div class="issue" id="issue-container-number-166"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="3"><a href="https://github.com/w3c/json-ld-api/issues/166"><span class="issue-number">Issue 166</span></a><span class="issue-label" aria-label="This issue is labelled as defer-future-version.">: Relationship to the RDF/JS Dataset interface(s) <a class="respec-gh-label respec-label-dark" href="https://github.com/w3c/json-ld-api/issues/?q=is%3Aissue+is%3Aopen+label%3A%22defer-future-version%22" style="background-color: rgb(0, 0, 0);">defer-future-version</a></span></div><p class="">Relationship to the RDF/JS Dataset interface(s).</p></div>
</section>

<section class="appendix informative" id="changes-since-1-0-recommendation-of-16-january-2014"><h2 id="c-changes-since-1-0-recommendation-of-16-january-2014"><bdi class="secno">C. </bdi>Changes since 1.0 Recommendation of 16 January 2014<a class="self-link" aria-label="§" href="#changes-since-1-0-recommendation-of-16-january-2014"></a></h2><p><em>This section is non-normative.</em></p>
  <ul>
    <li>The <a href="#expansion-algorithm">Expansion Algorithm</a>
      has a special <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a>, based on
      the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-frameexpansion" class="internalDFN" data-link-type="idl"><code><code>frameExpansion</code></code></a> flag, to enable content associated with JSON-LD
      frames, which may not otherwise be valid <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document">JSON-LD documents</a>.</li>
    <li>An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a> can now have an
      <code>@context</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which defines a context used for values of
      a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">property</a> identified with such a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>. This context is used
      in both the <a href="#expansion-algorithm">Expansion Algorithm</a> and
      <a href="#compaction-algorithm">Compaction Algorithm</a>.</li>
    <li>A new <a href="#merge-node-maps" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">7.3 </bdi>Merge Node Maps</a> is required
      for framing, to create a single graph from the <a data-lt="default graph" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default</a>
      and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graphs</a>.</li>
    <li>An <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a> can now have an
      <code>@nest</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>, which identifies a term expanding to
      <code>@nest</code> which is used for containing <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> using the same
      <code>@nest</code> mapping. When expanding, the values of an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a>
      expanding to <code>@nest</code> are treated as if they were contained
      within the enclosing <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> directly.</li>
    <li><code>@container</code> values within an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a> may now
      include <code>@id</code> and <code>@type</code>, corresponding to <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id maps</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-map">type maps</a>.</li>
    <li>Both <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-language-map">language maps</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-index-map">index maps</a> may legitimately have an <code>@none</code> value, but
      JSON-LD 1.0 only allowed <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string">string</a> values. This has been updated
      to allow (and ignore) <code>@none</code> values.</li>
    <li>The JSON syntax has been abstracted into an <a href="#dfn-internal-representation" class="internalDFN" data-link-type="dfn">internal representation</a>
      to allow for other serialization formats that are functionally equivalent
      to JSON.</li>
    <li>Preserved values are compacted using the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-property">properties</a> of the referencing term.</li>
    <li>The value for <code>@container</code> in an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a>
      can also be an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> containing any appropriate container
      keyword along with <code>@set</code> (other than <code>@list</code>).
      This allows a way to ensure that such <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> values will always
      be expressed in <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> form.</li>
    <li>Added support for the <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-compacttorelative" class="internalDFN" data-link-type="idl"><code>compactToRelative</code></a> option to allow <abbr title="Internationalized Resource Identifier">IRI</abbr> compaction (<a href="#iri-compaction" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">6.2 </bdi><abbr title="Internationalized Resource Identifier">IRI</abbr> Compaction</a>)
      to document-relative IRIs to be disabled.</li>
    <li>In JSON-LD 1.1, terms will be used as <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a> prefixes
      when compacting only if
      a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-simple-term-definition">simple term definition</a> is used where the value ends with a URI <a href="https://tools.ietf.org/html/rfc3986#section-2.2">gen-delim</a> character,
      or if their <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-expanded-term-definition">expanded term definition</a> contains
      an <code>@prefix</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> with the value <code>true</code>. The 1.0 algorithm has
      been updated to only consider terms that map to a value that ends with a URI
      <a href="https://tools.ietf.org/html/rfc3986#section-2.2">gen-delim</a> character.</li>
    <li>Term definitions now allow <code>@container</code> to include <code>@graph</code>,
      along with <code>@id</code>, <code>@index</code> and <code>@set</code>.
      In the <a href="#expansion-algorithm">Expansion Algorithm</a>, this is
      used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-named-graph">named graph</a> from either a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>, or
      objects which are values of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> in an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-id-map">id map</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-index-map">index map</a>.
      The <a href="#compaction-algorithm">Compaction Algorithm</a> allows
      specific forms of graph objects to be compacted back to a set of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>,
      or maps of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.</li>
    <li><a href="#value-expansion">Value Expansion</a> will not turn native values
      into <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>.</li>
    <li>The <a href="#term-selection">Term Selection algorithm</a> has been
      updated to allow uses of containers for values which would otherwise not
      match. This is used in the <a href="#expansion-algorithm">Compaction
      Algorithm</a> to use the <code>@none</code> keyword, or an alias, for
      values of maps for which there is no natural index. The <a href="#expansion-algorithm">Expansion Algorithm</a> removes this indexing
      transparently.</li>
  </ul>
  <p>Additionally, see <a href="#changes-from-cg" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">D. </bdi>Changes since JSON-LD Community Group Final Report</a>.</p>
</section>

<section class="appendix informative" id="changes-from-cg"><h2 id="d-changes-since-json-ld-community-group-final-report"><bdi class="secno">D. </bdi>Changes since JSON-LD Community Group Final Report<a class="self-link" aria-label="§" href="#changes-from-cg"></a></h2><p><em>This section is non-normative.</em></p>
  <ul>
    <li><a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">Lists</a> may now have items which are themselves <a data-link-type="dfn" href="https://www.w3.org/TR/rdf-schema/#ch_collectionvocab">lists</a>.</li>
    <li>The <a href="#deserialize-json-ld-to-rdf-algorithm">Deserialize JSON-LD to RDF Algorithm</a>
      has been updated to ensure that only <a href="#dfn-well-formed" class="internalDFN" data-link-type="dfn">well-formed</a> <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a>
      are emitted; previously, it only ensured that <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> containing
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> references</a> were excluded.</li>
    <li>The API now adds an <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-ordered" class="internalDFN" data-link-type="idl"><code><code>ordered</code></code></a>
       option, defaulting to <code>false</code> This is used in algorithms to
       control iteration of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">map entry</a> keys. Previously, the
       algorithms always required such an order. The instructions for
       evaluating test results have been updated accordingly.</li>
    <li>The <a href="#generate-blank-node-identifier">Generate Blank Node Identifier algorithm</a>
      has been updated to remove the specifics of how new blank node
      identifiers are created.</li>
    <li>Values of <code>@type</code>, or an alias of <code>@type</code>, may now have their <code>@container</code> set to <code>@set</code>
      to ensure that <code>@type</code> entries are always represented as an array. This
      also allows a term to be defined for <code>@type</code>, where the value <em class="rfc2119" title="MUST">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>
      with <code>@container</code> set to <code>@set</code>.</li>
    <li>Updated the <a href="#iri-expansion"><abbr title="Internationalized Resource Identifier">IRI</abbr> Expansion algorithm</a> so that
      if <var>value</var> contains a colon (<code>:</code>), but
      <var>prefix</var> is not a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term">term</a>, to only return <var>value</var>
      if it has the <a href="https://tools.ietf.org/html/rfc3987#section-2.2">form</a> of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, otherwise fall through to
      the rest of the algorithm.</li>
    <li>The use of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> to label properties is obsolete,
      and may be removed in a future version of JSON-LD,
      as is the support for <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-generalized-rdf-dataset">generalized RDF Datasets</a>
      and thus the <a data-xref-type="attribute|dict-member" data-link-for="JsonLdOptions" data-xref-for="JsonLdOptions" href="#dom-jsonldoptions-producegeneralizedrdf" class="internalDFN" data-link-type="idl"><code><code>produceGeneralizedRdf</code></code></a> option may be also be removed.</li>
    <li>Added API steps to accept <code>text/html</code> as input,
      extracting either a specifically targeted <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">script element</a>,
      the first found <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script element</a>,
      or all <a href="#dfn-json-ld-script-element" class="internalDFN" data-link-type="dfn">JSON-LD script elements</a>.</li>
    <li>Added <a data-xref-type="attribute|dict-member" data-link-for="RemoteDocument" data-xref-for="RemoteDocument" href="#dom-remotedocument-contenttype" class="internalDFN" data-link-type="idl"><code><code>contentType</code></code></a> field to <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a>.</li>
    <li>Added support for protected <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">contexts</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a>.</li>
    <li>Because scoped contexts can lead to contexts being reloaded, replace the
      <strong>recursive context inclusion</strong> error with a <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-context-overflow" class="internalDFN" data-link-type="idl"><code>context overflow</code></a> error.</li>
    <li>Added support for <code>"@type": "@none"</code> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definition</a> to prevent value compaction.</li>
    <li>Added support for <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON literals</a>.</li>
    <li><a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">Term definitions</a> with keys which are of the <a href="https://tools.ietf.org/html/rfc3987#section-2.2">form</a> of an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> or a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a> <em class="rfc2119" title="MUST NOT">MUST NOT</em>
      expand to an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> other than the expansion of the key itself.</li>
    <li>Consolidate <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a> processing into the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>
      including variations on HTML processing.</li>
    <li>The <a href="#iri-compaction"><abbr title="Internationalized Resource Identifier">IRI</abbr> compaction algorithm</a> may generate an error if the result is an
      <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> which could be confused with a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-compact-iri">compact <abbr title="Internationalized Resource Identifier">IRI</abbr></a> in the
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-active-context">active context</a>.</li>
    <li>By default, all contexts are propagated when traversing <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>, other than
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-type-scoped-context">type-scoped contexts</a>. This can be controlled using the <code>@propagate</code>
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-local-context">local context</a>.</li>
    <li>A context may contain a <code>@import</code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entry</a> used to reference a remote context
      within a context, allowing <code>JSON-LD 1.1</code> features to be added to contexts originally
      authored for <code>JSON-LD 1.0</code>.</li>
    <li>The <a data-link-for="JsonLdErrorCode" href="#dom-jsonlderrorcode-colliding-keywords" class="internalDFN" data-link-type="idl"><code>colliding keywords</code></a> error is not issued for <code>@type</code>;
      instead, previous values of <code>@type</code> are prepended to any new values, when expanding.</li>
    <li>A <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> may include an <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-included-block">included block</a>,
      which is used to contain a set of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a> which are treated
      exactly as if they were <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a> defined in an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list">array</a> including the containing
      <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.
      This allows the use of the object form of a JSON-LD document when there is more
      than one <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a> being defined, and where those <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>
      are not embedded as values of the containing <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node object</a>.</li>
    <li>A <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a> has been added as a possible value for <code>@vocab</code> in
      a context. When this is set, vocabulary-relative <abbr title="Internationalized Resource Identifier">IRI</abbr> references, such as the
      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry">entries</a> of <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-node-object">node objects</a>, are expanded or compacted relative
      to the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-base-iri">base <abbr title="Internationalized Resource Identifier">IRI</abbr></a> and the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-vocabulary-mapping">vocabulary mapping</a> using string concatenation.</li>
    <li>In the <a href="#dom-loaddocumentcallback" class="internalDFN" data-link-type="idl"><code>LoadDocumentCallback</code></a>, if the retrieved content is not any JSON media type
      and there is a link header with <code>rel=alternate</code> and <code>type=application/ld+json</code>, redirect
      to that content.</li>
    <li><a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-value-object">Value objects</a>, and associated <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-context">context</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-term-definition">term definitions</a> have been updated to 
      support <code>@direction</code> for setting the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-base-direction">base direction</a> of strings.</li>
    <li>It is no longer required that language tags be normalized to lower case,
      other than for testing considerations.
      Language tags that are not valid according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] are rejected.</li>
    <li>The <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-processing-mode">processing mode</a> is now implicitly <code>json-ld-1.1</code>, unless set
      explicitly to <code>json-ld-1.0</code>.</li>
    <li>Improve notation using <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-1.3"><abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a>, and <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3987#section-6.5">relative <abbr title="Internationalized Resource Identifier">IRI</abbr> reference</a>.</li>
    <li>Ignore terms and IRIs that have the form of a keyword (<code>"@"1*ALPHA</code>).</li>
  </ul>
</section>
<section class="appendix informative" id="changes-from-cr">
  <h2 id="e-changes-since-candidate-release-of-12-december-2019"><bdi class="secno">E. </bdi>Changes since Candidate Release of 12 December 2019<a class="self-link" aria-label="§" href="#changes-from-cr"></a></h2><p><em>This section is non-normative.</em></p>
  <div class="note" role="note" id="issue-container-generatedID-46"><div role="heading" class="note-title marker" id="h-note-43" aria-level="3"><span>Note</span></div><p class="">All changes are editorial and do not affect the observable
    behavior of the API nor the expected test results.</p></div>
  <ul>
    <li>Add <code>application/xhtml+xml</code> as an allowed media type in <a href="#process-html" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">9.5.1 </bdi>Process HTML</a>,
      in the note in <a href="#loaddocumentcallback" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">9.4.1 </bdi>LoadDocumentCallback</a>,
      and as a use of the <a data-xref-type="attribute|dict-member" data-link-for="LoadDocumentOptions" data-xref-for="LoadDocumentOptions" href="#dom-loaddocumentoptions-profile" class="internalDFN" data-link-type="idl"><code><code>profile</code></code></a> API option.</li>
    <li>Added <a href="#dfn-add-value" class="internalDFN" data-link-type="dfn">add value</a>, <a href="#dfn-iri-expanding" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> expanding</a>, and <a href="#dfn-iri-compacting" class="internalDFN" data-link-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr> compacting</a>
      macros to reduce boilerplate in algorithmic language.</li>
    <li>Improved algorithms in
      <a href="#context-processing-algorithm" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">4.1 </bdi>Context Processing Algorithm</a>,
      <a href="#create-term-definition" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">4.2 </bdi>Create Term Definition</a>,
      <a href="#expansion" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">2.1 </bdi>Expansion</a>,
      <a href="#compaction" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">2.2 </bdi>Compaction</a>,
      <a href="#value-compaction" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">6.3 </bdi>Value Compaction</a>,
      <a href="#node-map-generation" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">7.2 </bdi>Node Map Generation</a>,
      and <a href="#deserialize-json-ld-to-rdf-algorithm" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">8.1 </bdi>Deserialize JSON-LD to RDF Algorithm</a>.
    </li>
    <li>When creating an <code>i18n</code> datatype or <code>rdf:CompoundLiteral</code>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tags</a> are
      normalized to lower case to improve interoperability between implementations.</li>
    <li>Moved non-recursive portions algorithms
      into the <a data-xref-type="_IDL_" href="#dom-jsonldprocessor" class="internalDFN" data-link-type="idl"><code><code>JsonLdProcessor</code></code></a> processing steps.</li>
    <li>Fix some <a data-xref-type="_IDL_" href="#dom-jsonldoptions" class="internalDFN" data-link-type="idl"><code><code>JsonLdOption</code></code></a> initializers where defaults are <code>null</code>.
      Set default value for <a data-link-for="JsonLdOptions" href="#dom-jsonldoptions-processingmode" class="internalDFN" data-link-type="idl"><code>processingMode</code></a> to <code>json-ld-1.1</code>.</li>
    <li>Remove normative text for canonicalizing <code>rdf:JSON</code> literals and
      reference the <code>rdf:JSON</code> datatype of the syntax document
      for the conversion of the <a data-link-type="dfn" href="https://www.w3.org/TR/json-ld11/#dfn-json-literal">JSON Literals</a> in <a href="#data-round-tripping" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">8.6 </bdi>Data Round Tripping</a>.</li>
    <li>Updated interfaces in <a href="#the-application-programming-interface" class="sectionRef sec-ref">§&nbsp;<bdi class="secno">9. </bdi>The Application Programming Interface</a>
      to use <a href="https://heycam.github.io/webidl/#idl-record">record</a>,
      instead of <a href="https://heycam.github.io/webidl/#dfn-dictionary">dictionary</a>,
      and to allow <a href="#dom-remotedocument" class="internalDFN" data-link-type="idl"><code>RemoteDocument</code></a> to be used
      as a direct input, which resolves a <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> boundary issue.</li>
  </ul>
</section>

<section id="ack" class="appendix informative">
    <h2 id="f-acknowledgements"><bdi class="secno">F. </bdi>Acknowledgements<a class="self-link" aria-label="§" href="#ack"></a></h2><p><em>This section is non-normative.</em></p>
    <p>
        The editors would like to specially thank the following individuals for making significant
        contributions to the authoring and editing of this specification:
    </p>

    <ul class="ack">
        <li>Timothy Cole (University of Illinois at Urbana-Champaign)</li>
        <li>Gregory Todd Williams (J. Paul Getty Trust)</li>
        <li>Ivan Herman (<abbr title="World Wide Web Consortium">W3C</abbr> Staff)</li>
        <li>Jeff Mixter (OCLC (Online Computer Library Center, Inc.))</li>
        <li>David Lehn (Digital Bazaar)</li>
        <li>David Newbury (J. Paul Getty Trust)</li>
        <li>Robert Sanderson (J. Paul Getty Trust, chair)</li>
        <li>Harold Solbrig (Johns Hopkins Institute for Clinical and Translational Research)</li>
        <li>Simon Steyskal (WU (Wirschaftsuniversität Wien) - Vienna University of Economics and Business)</li>
        <li>A Soroka (Apache Software Foundation)</li>
        <li>Ruben Taelman (Imec vzw)</li>
        <li>Benjamin Young (Wiley, chair)</li>
    </ul>

    <p>Additionally, the following people were members of the Working Group at the time of publication:</p>

    <ul class="ack">
        <li>Steve Blackmon (Apache Software Foundation)</li>
        <li>Dan Brickley (Google, Inc.)</li>
        <li>Newton Calegari (NIC.br - Brazilian Network Information Center)</li>
        <li>Victor Charpenay (Siemens AG)</li>
        <li>Sebastian Käbisch (Siemens AG)</li>
        <li>Axel Polleres (WU (Wirschaftsuniversität Wien) - Vienna University of Economics and Business)</li>
        <li>Leonard Rosenthol (Adobe)</li>
        <li>Jean-Yves ROSSI (CANTON CONSULTING)</li>
        <li>Antoine Roulin (CANTON CONSULTING)</li>
        <li>Manu Sporny (Digital Bazaar)</li>
        <li>Clément Warnier de Wailly (CANTON CONSULTING)</li>
    </ul>

    <p>
        A large amount of thanks goes out to the <a href="https://www.w3.org/community/json-ld/">JSON-LD Community Group</a> participants who worked through many of the technical issues on the mailing list and the weekly telecons: Chris Webber, David Wood, Drummond Reed, Eleanor Joslin, Fabien Gandon, Herm Fisher, Jamie Pitts, Kim Hamilton Duffy, Niklas Lindström, Paolo Ciccarese, Paul Frazze, Paul Warren, Reto Gmür, Rob Trainer, Ted Thibodeau Jr., and Victor Charpenay.
    </p>

</section>




<section id="references" class="appendix"><h2 id="g-references"><bdi class="secno">G. </bdi>References<a class="self-link" aria-label="§" href="#references"></a></h2><section id="normative-references">
        <h3 id="g-1-normative-references"><bdi class="secno">G.1 </bdi>Normative references<a class="self-link" aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-bcp47">[BCP47]</dt><dd><a href="https://tools.ietf.org/html/bcp47"><cite>Tags for Identifying Languages</cite></a>. A. Phillips; M. Davis.  IETF. September 2009. IETF Best Current Practice. URL: <a href="https://tools.ietf.org/html/bcp47">https://tools.ietf.org/html/bcp47</a></dd><dt id="bib-dom">[DOM]</dt><dd><a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a></dd><dt id="bib-ecmascript">[ECMASCRIPT]</dt><dd><a href="https://tc39.github.io/ecma262/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a></dd><dt id="bib-html">[HTML]</dt><dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd><dt id="bib-ieee-754-2008">[IEEE-754-2008]</dt><dd><a href="http://standards.ieee.org/findstds/standard/754-2008.html"><cite>IEEE 754-2008 Standard for Floating-Point Arithmetic</cite></a>.  Institute of Electrical and Electronics Engineers. 2008. URL: <a href="http://standards.ieee.org/findstds/standard/754-2008.html">http://standards.ieee.org/findstds/standard/754-2008.html</a></dd><dt id="bib-infra">[INFRA]</dt><dd><a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a></dd><dt id="bib-json-ld10">[JSON-LD10]</dt><dd><a href="https://www.w3.org/TR/2014/REC-json-ld-20140116/"><cite>JSON-LD 1.0</cite></a>. Manu Sporny; Gregg Kellogg; Marcus Langhaler.  W3C. 16 January 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/2014/REC-json-ld-20140116/">https://www.w3.org/TR/2014/REC-json-ld-20140116/</a></dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd><a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin.  W3C. 9 September 2019. W3C Working Draft. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a></dd><dt id="bib-json-ld11-framing">[JSON-LD11-FRAMING]</dt><dd><a href="https://www.w3.org/TR/json-ld11-framing/"><cite>JSON-LD 1.1 Framing</cite></a>. Gregg Kellogg.  W3C. 9 September 2019. W3C Working Draft. URL: <a href="https://www.w3.org/TR/json-ld11-framing/">https://www.w3.org/TR/json-ld11-framing/</a></dd><dt id="bib-linked-data">[LINKED-DATA]</dt><dd><a href="https://www.w3.org/DesignIssues/LinkedData.html"><cite>Linked Data Design Issues</cite></a>. Tim Berners-Lee.  W3C. 27 July 2006. W3C-Internal Document. URL: <a href="https://www.w3.org/DesignIssues/LinkedData.html">https://www.w3.org/DesignIssues/LinkedData.html</a></dd><dt id="bib-promises-guide">[promises-guide]</dt><dd><a href="https://www.w3.org/2001/tag/doc/promises-guide"><cite>Writing Promise-Using Specifications</cite></a>. Domenic Denicola.  W3C. 16 February 2016. Finding of the W3C TAG. URL: <a href="https://www.w3.org/2001/tag/doc/promises-guide">https://www.w3.org/2001/tag/doc/promises-guide</a></dd><dt id="bib-rdf-schema">[RDF-SCHEMA]</dt><dd><a href="https://www.w3.org/TR/rdf-schema/"><cite>RDF Schema 1.1</cite></a>. Dan Brickley; Ramanathan Guha.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf-schema/">https://www.w3.org/TR/rdf-schema/</a></dd><dt id="bib-rdf11-concepts">[RDF11-CONCEPTS]</dt><dd><a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>. Richard Cyganiak; David Wood; Markus Lanthaler.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a></dd><dt id="bib-rdf11-mt">[RDF11-MT]</dt><dd><a href="https://www.w3.org/TR/rdf11-mt/"><cite>RDF 1.1 Semantics</cite></a>. Patrick Hayes; Peter Patel-Schneider.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-mt/">https://www.w3.org/TR/rdf11-mt/</a></dd><dt id="bib-rfc2045">[RFC2045]</dt><dd><a href="https://tools.ietf.org/html/rfc2045"><cite>Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</cite></a>. N. Freed; N. Borenstein.  IETF. November 1996. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc2045">https://tools.ietf.org/html/rfc2045</a></dd><dt id="bib-rfc2119">[RFC2119]</dt><dd><a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></dd><dt id="bib-rfc3986">[RFC3986]</dt><dd><a href="https://tools.ietf.org/html/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a></dd><dt id="bib-rfc3987">[RFC3987]</dt><dd><a href="https://tools.ietf.org/html/rfc3987"><cite>Internationalized Resource Identifiers (IRIs)</cite></a>. M. Duerst; M. Suignard.  IETF. January 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc3987">https://tools.ietf.org/html/rfc3987</a></dd><dt id="bib-rfc5234">[RFC5234]</dt><dd><a href="https://tools.ietf.org/html/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. D. Crocker, Ed.; P. Overell.  IETF. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a></dd><dt id="bib-rfc6839">[RFC6839]</dt><dd><a href="https://tools.ietf.org/html/rfc6839"><cite>Additional Media Type Structured Syntax Suffixes</cite></a>. T. Hansen; A. Melnikov.  IETF. January 2013. Informational. URL: <a href="https://tools.ietf.org/html/rfc6839">https://tools.ietf.org/html/rfc6839</a></dd><dt id="bib-rfc8174">[RFC8174]</dt><dd><a href="https://tools.ietf.org/html/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a></dd><dt id="bib-rfc8259">[RFC8259]</dt><dd><a href="https://tools.ietf.org/html/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed..  IETF. December 2017. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc8259">https://tools.ietf.org/html/rfc8259</a></dd><dt id="bib-rfc8288">[RFC8288]</dt><dd><a href="https://tools.ietf.org/html/rfc8288"><cite>Web Linking</cite></a>. M. Nottingham. October 2017. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc8288">https://tools.ietf.org/html/rfc8288</a></dd><dt id="bib-turtle">[Turtle]</dt><dd><a href="https://www.w3.org/TR/turtle/"><cite>RDF 1.1 Turtle</cite></a>. Eric Prud'hommeaux; Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/">https://www.w3.org/TR/turtle/</a></dd><dt id="bib-webidl">[WEBIDL]</dt><dd><a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. Boris Zbarsky.  W3C. 15 December 2016. W3C Editor's Draft. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a></dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd><a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a></dd>
      </dl></section><section id="informative-references">
        <h3 id="g-2-informative-references"><bdi class="secno">G.2 </bdi>Informative references<a class="self-link" aria-label="§" href="#informative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-cooluris">[cooluris]</dt><dd><a href="https://www.w3.org/TR/cooluris/"><cite>Cool URIs for the Semantic Web</cite></a>. Leo Sauermann; Richard Cyganiak.  W3C. 3 December 2008. W3C Note. URL: <a href="https://www.w3.org/TR/cooluris/">https://www.w3.org/TR/cooluris/</a></dd><dt id="bib-jcs">[JCS]</dt><dd><a href="https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17"><cite>JSON Canonicalization Scheme (JCS)</cite></a>. A. Rundgren; B. Jordan; S. Erdtman.  Network Working Group. 20 January 2020. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17">https://tools.ietf.org/html/draft-rundgren-json-canonicalization-scheme-17</a></dd><dt id="bib-json-ld10-api">[JSON-LD10-API]</dt><dd><a href="https://www.w3.org/TR/2014/REC-json-ld-api-20140116/"><cite>JSON-LD 1.0 Processing Algorithms And API</cite></a>. Marcus Langhaler; Gregg Kellogg; Manu Sporny.  W3C. 16 January 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/2014/REC-json-ld-api-20140116/">https://www.w3.org/TR/2014/REC-json-ld-api-20140116/</a></dd>
      </dl></section></section><p role="navigation" id="back-to-top"><a href="#title"><abbr title="Back to Top">↑</abbr></a></p><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>